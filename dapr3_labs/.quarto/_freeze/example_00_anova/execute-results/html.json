{
  "hash": "7281035da380216855a1e7d40c9e4007",
  "result": {
    "markdown": "---\ntitle: 'Analysis Example: Rpt & Mixed ANOVA'\nlink-citations: yes\ncode-fold: true\nparams: \n    SHOW_SOLS: TRUE\n    TOGGLE: TRUE\n---\n\n\n\n\n:::imp\nThis is optional for the DAPR3 course, but may be useful for your dissertations should your field/supervisor prefer the ANOVA framework to that of the linear model. \n\nThis walks briefly through these models with the __ez__ package. There are many other packages available, and many good tutorials online should you desire extra resources in the future:\n\n- https://www.datanovia.com/en/lessons/repeated-measures-anova-in-r\n- https://www.r-bloggers.com/2021/04/repeated-measures-of-anova-in-r-complete-tutorial/\n- https://stats.idre.ucla.edu/r/seminars/repeated-measures-analysis-with-r/ \n- https://www.datanovia.com/en/lessons/mixed-anova-in-r/  \n\n:::\n\n\n:::frame\n__Data__  \n\nThe data is from a simulated experiment in which heart rate variability (HRV) was measured for amateur basketball players when tasked with scoring a goal with varying levels and type of potential loss/reward. \n\nThe data was split over two files. The code below will read in both datasets and join them for you:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\ndownload.file(url = \"https://uoepsy.github.io/data/basketballhrv.xlsx\", \n              destfile = \"baskeballhrvdata.xlsx\")\n\nbball <- \n  left_join(\n    read_csv(\"https://uoepsy.github.io/data/basketballconditions.csv\"),\n    read_xlsx(\"baskeballhrvdata.xlsx\") %>%\n      pivot_longer(trial_1:trial_20, names_to = \"trial_no\", values_to = \"hrv\")\n  ) %>%\n  mutate(sub = factor(sub))\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n:::\n\n\n# One-Way Repeated Measures ANOVA\n\nFor a repeated measures ANOVA, our independent variables are _within_ groups.  \n\nFollowing from the example study above, we might consider using it to answer the question below.  \n \n> __Question:__ What is the effect of the size of reward on stress levels (as measured by HRV)?\n\nThe easiest way to conduct a repeated measures ANOVA in R is to use the __ez__ package.  \nIt comes with some handy functions to visualise the experimental design.  \nWe can see from below that every participant completed a trial for each value of reward-size (1-20 points):\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(ez)\nezDesign(data = bball, x = sub, y = stakes)\n```\n\n::: {.cell-output-display}\n![](example_00_anova_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nThe `ezANOVA()` function takes a few arguments. \n\nThe ones you will need for this are:\n\n- *data* the name of the dataframe\n- *dv* the column name for the dependent variable\n- *wid* the column name for the participant id variable\n- *within* the column name(s) for the predictor variable(s) that vary within participants \n- *between* the column name(s) for any predictor variable(s) that vary between participants\n\nFit a repeated measures ANOVA to examine the effect of the size of reward on HRV. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nezANOVA(data=bball, dv=hrv, wid = sub, within = stakes)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$ANOVA\n  Effect DFn DFd        F         p p<.05        ges\n1 stakes   1  29 1.254585 0.2718695       0.04146761\n```\n:::\n:::\n\n\n\n# Mixed ANOVA \n\nMixed ANOVA can be used to investigate effects of independent variables that are at two different levels,  i.e. some are *within* clusters and some are *between*.  \n\n> __Question:__ Does the influence of the size of reward/loss on stress levels differ depending upon whether it is money vs reputation at stake? \n\nLook at the two lines below. Can you work out what the plots will look like _before_ you run them? \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nezDesign(data = bball, x = condition, y = sub)\nezDesign(data = bball, x = condition, y = stakes)\n```\n:::\n\n\n\nParticipants 1-15 are in one condition, and 16-30 are in another.  \nThis should look like a two big blocks on the diagonal. \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nezDesign(data = bball, x = condition, y = sub)\n```\n\n::: {.cell-output-display}\n![](example_00_anova_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=672}\n:::\n:::\n\nIn each condition, the full set of stakes (1-20 points) were observed in the same number of trials.\nThis should be a full grid:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nezDesign(data = bball, x = condition, y = stakes)\n```\n\n::: {.cell-output-display}\n![](example_00_anova_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\nFit a mixed ANOVA to examine the interaction between size and type of reward on HRV. \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nezANOVA(data=bball, dv=hrv, wid = sub, within = stakes, between = condition)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$ANOVA\n            Effect DFn DFd        F          p p<.05        ges\n1        condition   1  28 3.021712 0.09314393       0.06041768\n2           stakes   1  28 1.260498 0.27109204       0.01786900\n3 condition:stakes   1  28 1.136668 0.29546463       0.01614191\n```\n:::\n:::\n\n\nThe __ez__ package also contains some easy plotting functions for factorial experiments, such as `ezPlot()`. It takes similar arguments to the `ezANOVA()` function. \n\n- look up the help documentation for `ezPlot()`. \n- let's use `ezPlot()` to make a nice plot (__Note:__ we may need to make sure that the `stakes` variable is a factor).\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nbball <- bball %>% mutate(stakes = factor(stakes))\nezPlot(data=bball, dv=hrv, wid = sub, within = stakes, between = condition, x = stakes, split = condition)\n```\n\n::: {.cell-output-display}\n![](example_00_anova_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n<div class=\"tocify-extend-page\" data-unique=\"tocify-extend-page\" style=\"height: 0;\"></div>\n\n",
    "supporting": [
      "example_00_anova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}