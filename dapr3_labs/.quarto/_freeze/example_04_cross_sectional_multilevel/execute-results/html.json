{
  "hash": "7b6546aec63346be9bfaf14026428369",
  "result": {
    "markdown": "---\ntitle: \"Analysis Example: Cross-sectional multi-level\"\nlink-citations: yes\ncode-fold: true\nparams: \n    SHOW_SOLS: TRUE\n    TOGGLE: TRUE\n---\n\n\n\n\n:::frame\n\nEach of these pages provides an analysis run through for a different type of design. Each document is structured in the same way:  \n\n  - First the data and research context is introduced. For the purpose of these tutorials, we will only use examples where the data can be shared - either because it is from an open access publication, or because it is unpublished or simulated. \n  - Second, we go through any tidying of the data that is required, before creating some brief descriptives and visualizations of the raw data.\n  - Then, we conduct an analysis. Where possible, we translate the research questions into formal equations prior to fitting the models in **lme4**. Model comparisons are conducted, along with checks of distributional assumptions on our model residuals. \n  - Finally, we visualize and interpret our analysis.\n  \nPlease note that there will be only minimal explanation of the steps undertaken here, as these pages are intended as example analyses rather than additional labs readings. Please also be aware that there are many decisions to be made throughout conducting analyses, and it may be the case that you disagree with some of the choices we make here. As always with these things, it is how we justify our choices that is important. We warmly welcome any feedback and suggestions to improve these examples: please email [ug.ppls.stats@ed.ac.uk](mailto:ug.ppls.stats@ed.ac.uk). \n\n:::\n\n# Overview\nOK, in this example we are keeping with Tom's home territory of organisational psychology. This data set was provided by Dr. David Hughes, from Manchester Business School. It is a subset of a larger data set that has been published on. \n\n- OrgID: organisation ID\n- Sex: 0= female, 1=male\n- Mot: self-rated motivation\n- Perf: boss rated performance\n- PubPri: 0= public, 1=private \n- Region: geographical location, 1=Wales, 2=England, 3=Scotland\n- Size: number of employees 1= <20, 2=21-50, 3=50-100, 4=100-250, 5=251-500, 6=500-1,000, 7=1,000+\n\nHere we are going to be looking at predicting employee performance from self-motivation, and investigating whether this effect is consistent across organisation. We will also look at whether the fact an organisation is public or private accounts for variation in model intercepts and slopes.\n\n# Data Wrangling\n\nThis data set is available at [https://uoepsy.github.io/data/MLM_Org.csv](https://uoepsy.github.io/data/MLM_Org.csv).  \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nperform <- read_csv(\"https://uoepsy.github.io/data/MLM_Org.csv\")\nperform %>%\n  filter(OrgID == \"Org1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 12 Ã— 7\n   OrgID Sex      Mot Perform PubPri Region   Size\n   <chr> <chr>  <dbl>   <dbl> <chr>  <chr>   <dbl>\n 1 Org1  female     3      58 public England     3\n 2 Org1  female     7      59 public England     3\n 3 Org1  male       4      60 public England     3\n 4 Org1  male       1      48 public England     3\n 5 Org1  female     4      59 public England     3\n 6 Org1  male       4      50 public England     3\n 7 Org1  female     1      43 public England     3\n 8 Org1  female     2      48 public England     3\n 9 Org1  male       5      65 public England     3\n10 Org1  male       2      41 public England     3\n11 Org1  female     2      50 public England     3\n12 Org1  female     2      64 public England     3\n```\n:::\n:::\n\nHere we can see the first 10 employees in `Org1`. Look here at the values that are constant across the organisation, and those that vary by person.\n\n# Descriptives\n\nGiven our data structure, it likely makes most sense for us to look at the averages across organisations.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsummarytab <- \n  perform %>%\n  group_by(OrgID) %>%\n  summarise(\n    N = n_distinct(Perform),\n    Mean.Perf = round(mean(Perform, na.rm=T),2),\n    SD.Perf = round(sd(Perform, na.rm=T),2),\n    Mean.Motiv = round(mean(Mot, na.rm=T),2),\n    SD.Motiv = round(sd(Mot, na.rm=T),2)\n    )\n```\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(kableExtra)\nkable(summarytab) %>%\n  kable_styling(\"striped\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> OrgID </th>\n   <th style=\"text-align:right;\"> N </th>\n   <th style=\"text-align:right;\"> Mean.Perf </th>\n   <th style=\"text-align:right;\"> SD.Perf </th>\n   <th style=\"text-align:right;\"> Mean.Motiv </th>\n   <th style=\"text-align:right;\"> SD.Motiv </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Org1 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 53.75 </td>\n   <td style=\"text-align:right;\"> 8.07 </td>\n   <td style=\"text-align:right;\"> 3.08 </td>\n   <td style=\"text-align:right;\"> 1.78 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org10 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 48.35 </td>\n   <td style=\"text-align:right;\"> 10.96 </td>\n   <td style=\"text-align:right;\"> 2.00 </td>\n   <td style=\"text-align:right;\"> 1.38 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org11 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 43.55 </td>\n   <td style=\"text-align:right;\"> 10.01 </td>\n   <td style=\"text-align:right;\"> 1.64 </td>\n   <td style=\"text-align:right;\"> 1.50 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org12 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 49.86 </td>\n   <td style=\"text-align:right;\"> 8.44 </td>\n   <td style=\"text-align:right;\"> 0.86 </td>\n   <td style=\"text-align:right;\"> 0.77 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org13 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 46.40 </td>\n   <td style=\"text-align:right;\"> 4.32 </td>\n   <td style=\"text-align:right;\"> 1.15 </td>\n   <td style=\"text-align:right;\"> 0.81 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org14 </td>\n   <td style=\"text-align:right;\"> 13 </td>\n   <td style=\"text-align:right;\"> 56.38 </td>\n   <td style=\"text-align:right;\"> 9.35 </td>\n   <td style=\"text-align:right;\"> 2.62 </td>\n   <td style=\"text-align:right;\"> 1.75 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org15 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 55.70 </td>\n   <td style=\"text-align:right;\"> 9.53 </td>\n   <td style=\"text-align:right;\"> 1.83 </td>\n   <td style=\"text-align:right;\"> 1.23 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org16 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 51.05 </td>\n   <td style=\"text-align:right;\"> 10.27 </td>\n   <td style=\"text-align:right;\"> 2.75 </td>\n   <td style=\"text-align:right;\"> 1.71 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org17 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 40.95 </td>\n   <td style=\"text-align:right;\"> 6.36 </td>\n   <td style=\"text-align:right;\"> 1.63 </td>\n   <td style=\"text-align:right;\"> 1.07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org18 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 62.82 </td>\n   <td style=\"text-align:right;\"> 5.68 </td>\n   <td style=\"text-align:right;\"> 3.30 </td>\n   <td style=\"text-align:right;\"> 1.72 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org19 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 49.67 </td>\n   <td style=\"text-align:right;\"> 10.34 </td>\n   <td style=\"text-align:right;\"> 2.10 </td>\n   <td style=\"text-align:right;\"> 1.14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org2 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 57.38 </td>\n   <td style=\"text-align:right;\"> 9.98 </td>\n   <td style=\"text-align:right;\"> 0.75 </td>\n   <td style=\"text-align:right;\"> 1.04 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org20 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 46.33 </td>\n   <td style=\"text-align:right;\"> 9.55 </td>\n   <td style=\"text-align:right;\"> 1.33 </td>\n   <td style=\"text-align:right;\"> 0.91 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org21 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 51.33 </td>\n   <td style=\"text-align:right;\"> 9.99 </td>\n   <td style=\"text-align:right;\"> 1.63 </td>\n   <td style=\"text-align:right;\"> 1.08 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org22 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 47.85 </td>\n   <td style=\"text-align:right;\"> 11.30 </td>\n   <td style=\"text-align:right;\"> 1.60 </td>\n   <td style=\"text-align:right;\"> 1.43 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org23 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 54.93 </td>\n   <td style=\"text-align:right;\"> 12.47 </td>\n   <td style=\"text-align:right;\"> 2.00 </td>\n   <td style=\"text-align:right;\"> 1.75 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org3 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 56.60 </td>\n   <td style=\"text-align:right;\"> 11.84 </td>\n   <td style=\"text-align:right;\"> 2.20 </td>\n   <td style=\"text-align:right;\"> 1.64 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org4 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 48.46 </td>\n   <td style=\"text-align:right;\"> 8.62 </td>\n   <td style=\"text-align:right;\"> 1.50 </td>\n   <td style=\"text-align:right;\"> 0.98 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org5 </td>\n   <td style=\"text-align:right;\"> 17 </td>\n   <td style=\"text-align:right;\"> 45.74 </td>\n   <td style=\"text-align:right;\"> 7.53 </td>\n   <td style=\"text-align:right;\"> 1.39 </td>\n   <td style=\"text-align:right;\"> 1.12 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org6 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 53.94 </td>\n   <td style=\"text-align:right;\"> 7.30 </td>\n   <td style=\"text-align:right;\"> 1.76 </td>\n   <td style=\"text-align:right;\"> 1.20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org7 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 50.09 </td>\n   <td style=\"text-align:right;\"> 9.14 </td>\n   <td style=\"text-align:right;\"> 1.50 </td>\n   <td style=\"text-align:right;\"> 1.01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org8 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 42.15 </td>\n   <td style=\"text-align:right;\"> 8.32 </td>\n   <td style=\"text-align:right;\"> 2.35 </td>\n   <td style=\"text-align:right;\"> 1.31 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Org9 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 53.25 </td>\n   <td style=\"text-align:right;\"> 11.52 </td>\n   <td style=\"text-align:right;\"> 1.83 </td>\n   <td style=\"text-align:right;\"> 1.13 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nNote the different numbers of employees we have across organisation. Clearly this will mean the information provided by each organisation will vary.\n\n# Visualisations\n\nNext, we can visualize the relationship between motivation and performance within each organisation. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nperform %>%\n  ggplot(aes(x=Mot, y=Perform, group = OrgID)) +\n  geom_point(size = 2, alpha= .75) +\n  geom_smooth(method = \"lm\") +\n  labs(x=\"Motivation\", y=\"Performance\") +\n  facet_wrap(~OrgID)\n```\n\n::: {.cell-output-display}\n![](example_04_cross_sectional_multilevel_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nWhat we see here is A LOT of variability. Not only do the intercepts change, so does the steepness and direction of the slopes.\n\n# Analysis\n\n## Equations\n\nOur model will take the structure specified below. However, we may also want to discuss whether public/private moderates the _within_ effect of motivation, or the _between_ effect of motivation, in which case we would need to separate out the group mean motivation and the group-mean centered motivation. \n\n$$\n\\begin{align}\n\\operatorname{Perform}_{ij} &= \\beta_{0i} + \\beta_{1i}(\\operatorname{Motivation}_j) + \\varepsilon_{ij}\\\\\n\\beta_{0i} &= \\gamma_{00} + \\zeta_{0i} \\\\\n\\beta_{1i} &= \\gamma_{10} + \\gamma_{11}(\\operatorname{isPrivate}_i) + \\zeta_{0i} \\\\\n& \\text{for OrgID i = 1,} \\dots \\text{,I}\n\\end{align}\n$$\n\n\n## Fitting the models\nAs we have in many of our examples, let's run an empty model, and look at the ICC for the grouping variable organisation. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(lme4)\n# Empty model\nm0 <- lmer(Perform ~ 1 + \n             (1 | OrgID),\n           data = perform)\nsummary(m0)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: Perform ~ 1 + (1 | OrgID)\n   Data: perform\n\nREML criterion at convergence: 3560\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-2.69138 -0.71156 -0.03565  0.73487  2.68864 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n OrgID    (Intercept) 25.05    5.005   \n Residual             80.34    8.964   \nNumber of obs: 487, groups:  OrgID, 23\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)   50.613      1.134   44.64\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# ICC\nvarM0 <- as.data.frame(VarCorr(m0))\nvarM0\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       grp        var1 var2     vcov    sdcor\n1    OrgID (Intercept) <NA> 25.05319 5.005316\n2 Residual        <NA> <NA> 80.34482 8.963527\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nround((varM0[1,4]/sum(varM0[,4]))*100,2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 23.77\n```\n:::\n:::\n\n\nSo, around 24% of the variance in our data is at the grouping level, meaning around 76% is at the person level. So clearly we have scope here for explanatory variables of both types.\n\nTo begin, we add motivation as a fixed effect:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Fixed effect for motivation\nm1 <- lmer(Perform ~ 1 + Mot +\n             (1 | OrgID),\n           data = perform)\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: Perform ~ 1 + Mot + (1 | OrgID)\n   Data: perform\n\nREML criterion at convergence: 3493\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-2.6341 -0.6969 -0.0137  0.6438  3.2444 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n OrgID    (Intercept) 20.30    4.506   \n Residual             70.25    8.381   \nNumber of obs: 487, groups:  OrgID, 23\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)   46.035      1.159  39.731\nMot            2.453      0.288   8.517\n\nCorrelation of Fixed Effects:\n    (Intr)\nMot -0.464\n```\n:::\n:::\n\n\nFrom this, we can calculate the reduction in the residual variance, or the PRV:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# PRV - how much residual variance does motivation account for\nm1_sum <- summary(m1)\nvarM1 <- as.data.frame(m1_sum$varcor)\nvarM1\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       grp        var1 var2     vcov    sdcor\n1    OrgID (Intercept) <NA> 20.30283 4.505866\n2 Residual        <NA> <NA> 70.24540 8.381253\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nround(((varM0[2,4]-varM1[2,4])/varM0[2,4])*100,2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 12.57\n```\n:::\n:::\n\n\nNot bad, so there is a 12.5% reduction in level 1 residual variance from the inclusion of motivation. The coefficient is positive, which is what we would hope to see, motivated employees have better performance.\n\nWe will do all of our model comparisons in one go at the end of our model building, so let's continue. Next, is a random slope (as evidenced by our plots above) for motivation.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# Random slope\nm2 <- lmer(Perform ~ 1 + Mot +\n             (1 + Mot | OrgID),\n           data = perform)\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: Perform ~ 1 + Mot + (1 + Mot | OrgID)\n   Data: perform\n\nREML criterion at convergence: 3393.7\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-2.27286 -0.69631 -0.00381  0.66058  2.82123 \n\nRandom effects:\n Groups   Name        Variance Std.Dev. Corr \n OrgID    (Intercept) 62.10    7.881         \n          Mot         18.06    4.250    -0.84\n Residual             50.88    7.133         \nNumber of obs: 487, groups:  OrgID, 23\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  46.0257     1.7571  26.195\nMot           2.0031     0.9351   2.142\n\nCorrelation of Fixed Effects:\n    (Intr)\nMot -0.834\n```\n:::\n:::\n\n\nAnd now we can look to compare the set of models before adding the predictors:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nanova(m0, m1, m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nData: perform\nModels:\nm0: Perform ~ 1 + (1 | OrgID)\nm1: Perform ~ 1 + Mot + (1 | OrgID)\nm2: Perform ~ 1 + Mot + (1 + Mot | OrgID)\n   npar    AIC    BIC  logLik deviance  Chisq Df Pr(>Chisq)    \nm0    3 3568.1 3580.7 -1781.0   3562.1                         \nm1    4 3502.2 3518.9 -1747.1   3494.2 67.894  1  < 2.2e-16 ***\nm2    6 3409.1 3434.2 -1698.5   3397.1 97.087  2  < 2.2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nIn each case, adding the additional parameters has improved our model, so we will keep them all.\n\nOur big interest here is in whether organisations being public or private changes the relationship of motivation to performance. For this, we will want to include the cross level interaction between `Mot` and `PubPri`. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm3 <- lmer(Perform ~ 1 + Mot + PubPri + Mot*PubPri +\n             (1 + Mot | OrgID),\n           data = perform)\nsummary(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: Perform ~ 1 + Mot + PubPri + Mot * PubPri + (1 + Mot | OrgID)\n   Data: perform\n\nREML criterion at convergence: 3384.4\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-2.29012 -0.69613 -0.02848  0.65620  2.76816 \n\nRandom effects:\n Groups   Name        Variance Std.Dev. Corr \n OrgID    (Intercept) 63.44    7.965         \n          Mot         18.62    4.315    -0.86\n Residual             50.91    7.135         \nNumber of obs: 487, groups:  OrgID, 23\n\nFixed effects:\n                 Estimate Std. Error t value\n(Intercept)       45.2718     2.1765  20.800\nMot                1.7909     1.1737   1.526\nPubPripublic       2.4448     3.7569   0.651\nMot:PubPripublic   0.5623     1.9904   0.283\n\nCorrelation of Fixed Effects:\n            (Intr) Mot    PbPrpb\nMot         -0.853              \nPubPripublc -0.579  0.494       \nMt:PbPrpblc  0.503 -0.590 -0.848\n```\n:::\n:::\n\n\nThe *t*-values here are pretty small. This doesn't look like the added effects have contributed much to our model. \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# model comparison\nanova(m2,m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nData: perform\nModels:\nm2: Perform ~ 1 + Mot + (1 + Mot | OrgID)\nm3: Perform ~ 1 + Mot + PubPri + Mot * PubPri + (1 + Mot | OrgID)\n   npar    AIC    BIC  logLik deviance  Chisq Df Pr(>Chisq)\nm2    6 3409.1 3434.2 -1698.5   3397.1                     \nm3    8 3410.1 3443.6 -1697.1   3394.1 2.9908  2     0.2242\n```\n:::\n:::\n\n\nAnd indeed our model comparison suggests not. But wait a minute, we forgot about something....\n\n...we need to center our predictors.\n\nLet's create variables which are the group mean motivation, and the group-mean centered motivation. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nperform <- \n  perform %>%\n  group_by(OrgID) %>%\n  mutate(\n    Mot_m = mean(Mot, na.rm=T),\n    Mot_c = Mot - mean(Mot, na.rm=T)\n  ) %>% ungroup\n```\n:::\n\n\nAnd re-run the models:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm4 <- lmer(Perform ~ 1 + Mot_m + Mot_c +\n             (1 + Mot_c | OrgID),\n           data = perform)\nm5 <- lmer(Perform ~ 1 + Mot_m + Mot_c + PubPri + Mot_c*PubPri +\n             (1 + Mot_c | OrgID),\n           data = perform)\nanova(m4,m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nData: perform\nModels:\nm4: Perform ~ 1 + Mot_m + Mot_c + (1 + Mot_c | OrgID)\nm5: Perform ~ 1 + Mot_m + Mot_c + PubPri + Mot_c * PubPri + (1 + Mot_c | OrgID)\n   npar    AIC    BIC  logLik deviance  Chisq Df Pr(>Chisq)\nm4    7 3413.8 3443.2 -1699.9   3399.8                     \nm5    9 3414.6 3452.3 -1698.3   3396.6 3.1947  2     0.2024\n```\n:::\n\n```{.r .cell-code}\nsummary(m5)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: Perform ~ 1 + Mot_m + Mot_c + PubPri + Mot_c * PubPri + (1 +  \n    Mot_c | OrgID)\n   Data: perform\n\nREML criterion at convergence: 3383.8\n\nScaled residuals: \n     Min       1Q   Median       3Q      Max \n-2.38702 -0.70580 -0.02145  0.64741  2.79873 \n\nRandom effects:\n Groups   Name        Variance Std.Dev. Corr \n OrgID    (Intercept) 19.96    4.467         \n          Mot_c       18.62    4.315    -0.09\n Residual             51.01    7.142         \nNumber of obs: 487, groups:  OrgID, 23\n\nFixed effects:\n                   Estimate Std. Error t value\n(Intercept)         45.2647     3.2271  14.027\nMot_m                2.1373     1.8199   1.174\nMot_c                1.7695     1.1752   1.506\nPubPripublic         4.1109     2.4320   1.690\nMot_c:PubPripublic   0.6012     1.9967   0.301\n\nCorrelation of Fixed Effects:\n            (Intr) Mot_m  Mot_c  PbPrpb\nMot_m       -0.925                     \nMot_c       -0.028 -0.001              \nPubPripublc  0.269 -0.497  0.039       \nMt_c:PbPrpb  0.020 -0.003 -0.589 -0.064\n```\n:::\n:::\n\nWhat do you notice about the results? Spend a little bit of time comparing the effects (fixed and random) and see the changes that result from centering a variable. Remember that our interpretation of the conditional main effects is the effect of a predictor on the outcome when the interacting variable = 0. Zero for Mot_c is average motivation, and zero for PubPri is public sector. So for every unit increase in motivation within a public centre organisation, performance increases by 1.77 units.\n\n\n\n# Check model\n\nI might be a little concerned about homoscedasticity here. The variance is a bit narrower at the tail ends:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(lattice)\nplot(m5, sqrt(abs(resid(.)))~fitted(.), type = c(\"p\",\"smooth\"))\n```\n\n::: {.cell-output-display}\n![](example_04_cross_sectional_multilevel_files/figure-html/unnamed-chunk-17-1.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\nqqmath(m5)\n```\n\n::: {.cell-output-display}\n![](example_04_cross_sectional_multilevel_files/figure-html/unnamed-chunk-17-2.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\ndotplot.ranef.mer(ranef(m5))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$OrgID\n```\n:::\n\n::: {.cell-output-display}\n![](example_04_cross_sectional_multilevel_files/figure-html/unnamed-chunk-17-3.png){fig-align='center' width=672}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(robustlmm)\nm5r <- rlmer(Perform ~ 1 + Mot_m + Mot_c + PubPri + Mot_c*PubPri +\n             (1 + Mot_c | OrgID),\n           data = perform)\n```\n:::\n\n\n\n# Visualise model\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(sjPlot)\nplot_model(m5, type=\"pred\",terms=c(\"Mot_m\"))\n```\n\n::: {.cell-output-display}\n![](example_04_cross_sectional_multilevel_files/figure-html/unnamed-chunk-19-1.png){fig-align='center' width=672}\n:::\n\n```{.r .cell-code}\nplot_model(m5, type=\"pred\", terms=c(\"Mot_c\",\"PubPri\"))\n```\n\n::: {.cell-output-display}\n![](example_04_cross_sectional_multilevel_files/figure-html/unnamed-chunk-19-2.png){fig-align='center' width=672}\n:::\n:::\n\n\n# Interpret model\n\n\n\n",
    "supporting": [
      "example_04_cross_sectional_multilevel_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}