{
  "hash": "5a24dfd5d46551c52ce88628ef296e62",
  "result": {
    "markdown": "---\ntitle: \"3. Assumptions and Diagnostics | Centering\"\nparams: \n    SHOW_SOLS: TRUE\n    TOGGLE: TRUE\n---\n\n\n\n\n\n# Exercises: Assumptions & Diagnostics\n\n:::frame\n__Data: Wellbeing Across Scotland__  \n\nFor these next set of exercises we continue with our recurring study in which researchers want to look at the relationship between time spent outdoors and mental wellbeing, across all of Scotland. Data is collected from 20 of the Local Authority Areas and is accessible at [https://uoepsy.github.io/data/LAAwellbeing.csv](https://uoepsy.github.io/data/LAAwellbeing.csv).  \n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div id=\"kyishlnwka\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#kyishlnwka table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#kyishlnwka thead, #kyishlnwka tbody, #kyishlnwka tfoot, #kyishlnwka tr, #kyishlnwka td, #kyishlnwka th {\n  border-style: none;\n}\n\n#kyishlnwka p {\n  margin: 0;\n  padding: 0;\n}\n\n#kyishlnwka .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#kyishlnwka .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#kyishlnwka .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#kyishlnwka .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#kyishlnwka .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kyishlnwka .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kyishlnwka .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#kyishlnwka .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#kyishlnwka .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#kyishlnwka .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#kyishlnwka .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#kyishlnwka .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#kyishlnwka .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#kyishlnwka .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#kyishlnwka .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#kyishlnwka .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#kyishlnwka .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#kyishlnwka .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#kyishlnwka .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kyishlnwka .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#kyishlnwka .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#kyishlnwka .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#kyishlnwka .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kyishlnwka .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#kyishlnwka .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#kyishlnwka .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kyishlnwka .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kyishlnwka .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#kyishlnwka .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kyishlnwka .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#kyishlnwka .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#kyishlnwka .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kyishlnwka .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kyishlnwka .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#kyishlnwka .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#kyishlnwka .gt_left {\n  text-align: left;\n}\n\n#kyishlnwka .gt_center {\n  text-align: center;\n}\n\n#kyishlnwka .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#kyishlnwka .gt_font_normal {\n  font-weight: normal;\n}\n\n#kyishlnwka .gt_font_bold {\n  font-weight: bold;\n}\n\n#kyishlnwka .gt_font_italic {\n  font-style: italic;\n}\n\n#kyishlnwka .gt_super {\n  font-size: 65%;\n}\n\n#kyishlnwka .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#kyishlnwka .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#kyishlnwka .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#kyishlnwka .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#kyishlnwka .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#kyishlnwka .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#kyishlnwka .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"variable\">variable</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"description\">description</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">ppt</td>\n<td headers=\"description\" class=\"gt_row gt_left\">Participant ID</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">name</td>\n<td headers=\"description\" class=\"gt_row gt_left\">Participant Name</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">laa</td>\n<td headers=\"description\" class=\"gt_row gt_left\">Local Authority Area</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">outdoor_time</td>\n<td headers=\"description\" class=\"gt_row gt_left\">Self report estimated number of hours per week spent outdoors</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">wellbeing</td>\n<td headers=\"description\" class=\"gt_row gt_left\">Warwick-Edinburgh Mental Wellbeing Scale (WEMWBS), a self-report measure of mental health and well-being. The scale is scored by summing responses to each item, with items answered on a 1 to 5 Likert scale. The minimum scale score is 14 and the maximum is 70.</td></tr>\n    <tr><td headers=\"variable\" class=\"gt_row gt_left\">density</td>\n<td headers=\"description\" class=\"gt_row gt_left\">LAA Population Density (people per square km)</td></tr>\n  </tbody>\n  \n  \n</table>\n</div>\n```\n:::\n:::\n\n:::\n\n\n\n<div class='question-begin'>Question 1</div><div class='question-body'>\n\n\nThe code below will read in the data and fit the model with by-LAA random intercepts and slopes of outdoor time. \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(lme4)\nscotmw <- read_csv(\"https://uoepsy.github.io/data/LAAwellbeing.csv\")\nrs_model <- lmer(wellbeing ~ 1 + outdoor_time + (1 + outdoor_time | laa), data = scotmw)\n```\n:::\n\n\n1. Plot the residuals vs fitted values, and assess the extend to which the assumption holds that the residuals are zero mean.\n2. Construct a scale-location plot. This is where the square-root of the absolute value of the standardised residuals is plotted against the fitted values, and allows you to more easily assess the assumption of constant variance. \n  - Optional: can you create the same plot using ggplot, starting with the `augment()` function from the __broom.mixed__ package?  \n  \n::: {.callout-tip collapse=\"true\"}\n#### Hints\n`plot(model)` will give you this plot, but you might want to play with the `type = c(......)` argument to get the smoothing line\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-1' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-1', 'sol-start-1')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-1\" style=\"display: none;\">\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot(rs_model, type=c(\"p\",\"smooth\"))\n```\n\n::: {.cell-output-display}\n![](03_assumptcent_files/figure-html/unnamed-chunk-3-1.png){fig-align='center' width=80%}\n:::\n:::\n\nAs we can see, the mean value of the residuals is quite close to zero, right the way across the fitted values. This is good. \n\n::: {.callout-note}\nTo change labels for the x and y axes, add the following arguments to the plot() function:\n\n- `xlab = \"Fitted values\"`\n- `ylab = \"Residuals\"`\n:::\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot(rs_model,\n     form = sqrt(abs(resid(.))) ~ fitted(.),\n     type = c(\"p\",\"smooth\"))\n```\n\n::: {.cell-output-display}\n![](03_assumptcent_files/figure-html/unnamed-chunk-4-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\nIn this plot we can see that the variance of the residuals is fairly constant across the fitted values. There is a slight dip at the lower end. We can see this in the previous plot too - all the points at the LHS of the plot are slightly more tightly grouped around the line. This is not enough to worry me, personally.  \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(broom.mixed)\naugment(rs_model) %>%\n  mutate(\n    sqrtr = sqrt(abs(.resid))\n  ) %>%\n  ggplot(aes(x=.fitted, y=sqrtr)) + \n  geom_point() +\n  geom_smooth()\n```\n\n::: {.cell-output-display}\n![](03_assumptcent_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\n::: {.callout-note}\nTo remove the confidence bands (in grey) from the smoothed line, you can change the last command to:\n\n`geom_smooth(se = FALSE)`\n:::\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n\n<div class='question-begin'>Question 2</div><div class='question-body'>\n\n\nExamine the normality of both the level 1 and level 2 residuals.  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\n  - Use `hist()` if you like, or `qqnorm(residuals)` followed by `qqline(residuals)`\n  - Extracting the level 2 residuals (the random effects) can be difficult. `ranef(model)` will get you some of the way.\n  \n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-2' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-2', 'sol-start-2')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-2\" style=\"display: none;\">\n\n\n\n__Level 1__  \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhist(resid(rs_model))\n```\n\n::: {.cell-output-display}\n![](03_assumptcent_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=80%}\n:::\n\n```{.r .cell-code}\nqqnorm(resid(rs_model))\nqqline(resid(rs_model))\n```\n\n::: {.cell-output-display}\n![](03_assumptcent_files/figure-html/unnamed-chunk-6-2.png){fig-align='center' width=80%}\n:::\n:::\n\n\n\n::: {.callout-tip collapse=\"true\"}\n\n__Indexing random effects__  \n\nThe output of `ranef()` is a type of data container called \"list\". The list includes different named slots and you can find the names as follows: \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nnames(ranef(rs_model))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"laa\"\n```\n:::\n:::\n\n\nYou have a named slot for each group in your lmer specification. In this case, we only specified `laa` as grouping. To access the random effects for the specific group, type `ranef(model)` followed by `$groupname`\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nranef(rs_model)$laa\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                      (Intercept) outdoor_time\nAngus                  -4.8568066  0.095850303\nArgyll and Bute         1.6488121 -0.005181049\nCity of Edinburgh      10.8163125  0.199034174\nDumfries and Galloway  -2.6893688 -0.012005965\nEast Ayrshire          -5.6749200 -0.232750990\nEast Renfrewshire       0.5024800  0.084907037\nFalkirk                -7.4525578 -0.156694328\nGlasgow City          -10.9101439 -0.464232183\nHighland                6.7315989  0.280992008\nInverclyde             -1.2966048  0.197142062\nMidlothian             -1.7585791 -0.485961786\nMoray                  -2.2165380  0.133392034\nNa h-Eileanan Siar     14.0595006  0.399493656\nOrkney Islands          0.1789928  0.154590585\nPerth and Kinross       1.4894924  0.256689754\nScottish Borders       -0.2638474 -0.148174460\nShetland Islands        4.7262680  0.388873631\nStirling                6.5060959 -0.075781592\nWest Dunbartonshire    -6.4127140 -0.266515096\nWest Lothian           -3.1274727 -0.343667797\n```\n:::\n:::\n\n\nYou will have multiple columns, one for each random effect.\n\nYou can get the random intercepts by laa, by selecting the first column as follows:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nranef(rs_model)$laa[, 1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1]  -4.8568066   1.6488121  10.8163125  -2.6893688  -5.6749200   0.5024800\n [7]  -7.4525578 -10.9101439   6.7315989  -1.2966048  -1.7585791  -2.2165380\n[13]  14.0595006   0.1789928   1.4894924  -0.2638474   4.7262680   6.5060959\n[19]  -6.4127140  -3.1274727\n```\n:::\n:::\n\n\nRespectively, for the random slopes by laa, you select the second column as follows:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nranef(rs_model)$laa[, 2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1]  0.095850303 -0.005181049  0.199034174 -0.012005965 -0.232750990\n [6]  0.084907037 -0.156694328 -0.464232183  0.280992008  0.197142062\n[11] -0.485961786  0.133392034  0.399493656  0.154590585  0.256689754\n[16] -0.148174460  0.388873631 -0.075781592 -0.266515096 -0.343667797\n```\n:::\n:::\n\n\n:::\n\n\n__Level 2__  \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nqqnorm(ranef(rs_model)$laa[, 1], main = \"Random intercept\")\nqqline(ranef(rs_model)$laa[, 1])\n```\n\n::: {.cell-output-display}\n![](03_assumptcent_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=80%}\n:::\n\n```{.r .cell-code}\nqqnorm(ranef(rs_model)$laa[, 2], main = \"Random slope\")\nqqline(ranef(rs_model)$laa[, 2])\n```\n\n::: {.cell-output-display}\n![](03_assumptcent_files/figure-html/unnamed-chunk-11-2.png){fig-align='center' width=80%}\n:::\n:::\n\n\nThe normality of the residuals at both levels looks pretty decent here. This is especially good given that we only actually have 20 clusters (the LAAs). We have quite a small sample at this level.  \n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n\n\n<div class='question-begin'>Question 3</div><div class='question-body'>\n\n\n1. Which person in the dataset has the greatest influence on our model?  \n2. For which person is the model fit the worst (i.e., who has the highest residual?)\n3. Which _LAA_ has the greatest influence on our model?  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\n- as well as `hlm_influence()` in the __HLMdiag__ package there is another nice function, `hlm_augment()`\n- we can often end up in confusion because the $i^{th}$ observation inputted to our model (and therefore the $i^{th}$ observation of `hlm_influence()` output) **might not be** the $i^{th}$ observation in our original dataset - there may be missing data! (Luckily, we have no missing data in this dataset). \n\n:::\n\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-3' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-3', 'sol-start-3')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-3\" style=\"display: none;\">\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(HLMdiag)\nl1_inf <- hlm_influence(rs_model,level=1)\ndotplot_diag(l1_inf$cooksd, cutoff=\"internal\")+\n  ylim(0,.15)\n```\n\n::: {.cell-output-display}\n![](03_assumptcent_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=80%}\n:::\n:::\n\nGreatest influence:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhlm_augment(rs_model, level=1) %>% arrange(desc(cooksd))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 132 × 15\n      id wellbeing outdoor_time laa          .resid .fitted .ls.resid .ls.fitted\n   <dbl>     <dbl>        <dbl> <fct>         <dbl>   <dbl>     <dbl>      <dbl>\n 1    74        35           33 Scottish Bo…  -5.15    40.2    -3.73        38.7\n 2   129        60            5 City of Edi…   8.89    51.1     6.43        53.6\n 3   109        31            8 Inverclyde    -9.22    40.2    -3.03        34.0\n 4    59        32            7 Scottish Bo…  -6.43    38.4    -7.45        39.5\n 5    31        35            7 Moray         -3.44    38.4     0.198       34.8\n 6    90        70           34 Na h-Eilean…  -3.16    73.2    -1.19        71.2\n 7    87        54           29 Highland      -5.33    59.3    -5.66        59.7\n 8    62        26           21 Midlothian    -4.77    30.8     0.214       25.8\n 9    67        37            7 East Ayrshi…   4.58    32.4     4.62        32.4\n10    64        46           18 City of Edi… -10.5     56.5   -10.1         56.1\n# ℹ 122 more rows\n# ℹ 7 more variables: .mar.resid <dbl>, .mar.fitted <dbl>, cooksd <dbl>,\n#   mdffits <dbl>, covtrace <dbl>, covratio <dbl>, leverage.overall <dbl>\n```\n:::\n\n```{.r .cell-code}\nscotmw[74, ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 6\n  ppt   name                 laa              outdoor_time wellbeing density\n  <chr> <chr>                <chr>                   <dbl>     <dbl>   <dbl>\n1 ID46  Groundskeeper Willie Scottish Borders           33        35      29\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](images/intro/willie.jpg){fig-align='center' width=100px}\n:::\n:::\n\n\nHighest residual: \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhlm_augment(rs_model, level=1) %>% arrange(desc(abs(.resid)))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 132 × 15\n      id wellbeing outdoor_time laa          .resid .fitted .ls.resid .ls.fitted\n   <dbl>     <dbl>        <dbl> <fct>         <dbl>   <dbl>     <dbl>      <dbl>\n 1    64        46           18 City of Edi… -10.5     56.5    -10.1        56.1\n 2   107        22           12 East Ayrshi… -10.3     32.3    -10.1        32.1\n 3    72        22           24 West Lothian -10.0     32.0     -9.24       31.2\n 4   109        31            8 Inverclyde    -9.22    40.2     -3.03       34.0\n 5   130        22           16 West Dunbar…  -8.98    31.0     -8.61       30.6\n 6   129        60            5 City of Edi…   8.89    51.1      6.43       53.6\n 7    93        65           18 City of Edi…   8.51    56.5      8.90       56.1\n 8    85        47           15 City of Edi…  -8.25    55.2     -8.52       55.5\n 9     7        38           13 Perth and K…  -7.84    45.8     -5.28       43.3\n10   121        31           16 Dumfries an…  -7.78    38.8     -7.70       38.7\n# ℹ 122 more rows\n# ℹ 7 more variables: .mar.resid <dbl>, .mar.fitted <dbl>, cooksd <dbl>,\n#   mdffits <dbl>, covtrace <dbl>, covratio <dbl>, leverage.overall <dbl>\n```\n:::\n\n```{.r .cell-code}\nscotmw[64, ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 6\n  ppt   name            laa               outdoor_time wellbeing density\n  <chr> <chr>           <chr>                    <dbl>     <dbl>   <dbl>\n1 ID37  Nicola Sturgeon City of Edinburgh           18        46    1958\n```\n:::\n:::\n\n\nMost influential LAA: \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhlm_augment(rs_model, level=\"laa\") %>% arrange(desc(cooksd))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 20 × 10\n   laa       .ranef.intercept .ranef.outdoor_time .ls.intercept .ls.outdoor_time\n   <chr>                <dbl>               <dbl>         <dbl>            <dbl>\n 1 Midlothi…           -1.76             -0.486           8.75           -1.26  \n 2 Na h-Eil…           14.1               0.399          21.4             0.0553\n 3 Glasgow …          -10.9              -0.464          -9.45           -0.593 \n 4 City of …           10.8               0.199          16.2            -0.144 \n 5 Stirling             6.51             -0.0758         13.3            -0.500 \n 6 Shetland…            4.73              0.389           3.69            0.424 \n 7 Angus               -4.86              0.0959         -6.82            0.265 \n 8 West Lot…           -3.13             -0.344           4.13           -0.725 \n 9 Falkirk             -7.45             -0.157         -12.3            -0.0360\n10 Invercly…           -1.30              0.197         -14.5             1.17  \n11 Highland             6.73              0.281           8.95            0.155 \n12 West Dun…           -6.41             -0.267          -4.87           -0.395 \n13 Moray               -2.22              0.133          -5.81            0.267 \n14 Perth an…            1.49              0.257         -20.4             1.76  \n15 East Ayr…           -5.67             -0.233          -3.63           -0.391 \n16 Orkney I…            0.179             0.155          -0.816           0.212 \n17 Scottish…           -0.264            -0.148           3.28           -0.367 \n18 Dumfries…           -2.69             -0.0120         -7.27            0.261 \n19 Argyll a…            1.65             -0.00518         4.67           -0.187 \n20 East Ren…            0.502             0.0849          1.40            0.0247\n# ℹ 5 more variables: cooksd <dbl>, mdffits <dbl>, covtrace <dbl>,\n#   covratio <dbl>, leverage.overall <dbl>\n```\n:::\n:::\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n\n<div class='question-begin'>Question 4</div><div class='question-body'>\n\n\n\n1. Looking at the random effects, which LAA shows the least benefit to wellbeing as outdoor time increases, and which shows the greatest benefit?  \n2. What is the estimated wellbeing for people from City of Edinburgh with zero hours of outdoor time per week, and what is their associated increases in wellbeing for every hour per week increase in outdoor time?  \n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-4' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-4', 'sol-start-4')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-4\" style=\"display: none;\">\n\n\nIt looks like the residents of Midlothian have the least improvement, and the Western Isles (Na h-Eileanan Siar) show the most increases of wellbeing with outdoor time. We can see this from the LAA-random slopes of outdoor time:  \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nranef(rs_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$laa\n                      (Intercept) outdoor_time\nAngus                  -4.8568066  0.095850303\nArgyll and Bute         1.6488121 -0.005181049\nCity of Edinburgh      10.8163125  0.199034174\nDumfries and Galloway  -2.6893688 -0.012005965\nEast Ayrshire          -5.6749200 -0.232750990\nEast Renfrewshire       0.5024800  0.084907037\nFalkirk                -7.4525578 -0.156694328\nGlasgow City          -10.9101439 -0.464232183\nHighland                6.7315989  0.280992008\nInverclyde             -1.2966048  0.197142062\nMidlothian             -1.7585791 -0.485961786\nMoray                  -2.2165380  0.133392034\nNa h-Eileanan Siar     14.0595006  0.399493656\nOrkney Islands          0.1789928  0.154590585\nPerth and Kinross       1.4894924  0.256689754\nScottish Borders       -0.2638474 -0.148174460\nShetland Islands        4.7262680  0.388873631\nStirling                6.5060959 -0.075781592\nWest Dunbartonshire    -6.4127140 -0.266515096\nWest Lothian           -3.1274727 -0.343667797\n\nwith conditional variances for \"laa\" \n```\n:::\n:::\n\nWe can get the cluster-specific coefficients either by adding the `fixef()` and `ranef()` together, or using `coef()`:  \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncoef(rs_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$laa\n                      (Intercept) outdoor_time\nAngus                    33.36700   0.31050188\nArgyll and Bute          39.87261   0.20947052\nCity of Edinburgh        49.04011   0.41368575\nDumfries and Galloway    35.53443   0.20264561\nEast Ayrshire            32.54888  -0.01809942\nEast Renfrewshire        38.72628   0.29955861\nFalkirk                  30.77124   0.05795725\nGlasgow City             27.31366  -0.24958061\nHighland                 44.95540   0.49564358\nInverclyde               36.92720   0.41179364\nMidlothian               36.46522  -0.27131021\nMoray                    36.00726   0.34804361\nNa h-Eileanan Siar       52.28330   0.61414523\nOrkney Islands           38.40280   0.36924216\nPerth and Kinross        39.71329   0.47134133\nScottish Borders         37.95995   0.06647711\nShetland Islands         42.95007   0.60352520\nStirling                 44.72990   0.13886998\nWest Dunbartonshire      31.81109  -0.05186352\nWest Lothian             35.09633  -0.12901622\n\nattr(,\"class\")\n[1] \"coef.mer\"\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncoef(rs_model)$laa[\"City of Edinburgh\",]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                  (Intercept) outdoor_time\nCity of Edinburgh    49.04011    0.4136857\n```\n:::\n:::\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n<br>\n<div class=\"divider div-transparent div-dot\"></div>\n\n\n# Exercises: Centering in the MLM\n\n\n::: {.callout-note collapse=\"true\"}\n## Centering & Scaling in LM\n\nWe have some data from a study investigating how perceived persuasiveness of a speaker is influenced by the rate at which they speak.  \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndap2 <- read_csv(\"https://uoepsy.github.io/data/dapr2_2122_report1.csv\")\n```\n:::\n\n\nWe can fit a simple linear regression (one predictor) to evaluate how speech rate (variable `sp_rate` in the dataset) influences perceived persuasiveness (variable `persuasive` in the dataset). There are various ways in which we can transform the predictor variable `sp_rate`, which in turn can alter the interpretation of some of our estimates:  \n\n:::panelset\n:::panel\n#### Raw X\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nm1 <- lm(persuasive ~ sp_rate, data = dap2)\nsummary(m1)$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 55.532060  6.4016670  8.674625 6.848945e-15\nsp_rate     -0.190987  0.4497113 -0.424688 6.716809e-01\n```\n:::\n:::\n\n\nThe intercept and the coefficient for speech rate are interpreted as:  \n\n- `(Intercept)`: A audio clip of someone speaking at zero phones per second is estimated as having an average persuasive rating of 55.53.  \n- `sp_rate`: For every increase of one phone per second, perceived persuasiveness is estimated to decrease by -0.19.  \n\n:::\n:::panel\n#### Mean-Centered X\n\nWe can mean center our predictor and fit the model again: \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndap2 <- dap2 %>% mutate(sp_rate_mc = sp_rate - mean(sp_rate))\nm2 <- lm(persuasive ~ sp_rate_mc, data = dap2)\nsummary(m2)$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 52.874667  1.3519418 39.110165 6.429541e-80\nsp_rate_mc  -0.190987  0.4497113 -0.424688 6.716809e-01\n```\n:::\n:::\n\n- `(Intercept)`: A audio clip of someone speaking at the __mean__ phones per second is estimated as having an average persuasive rating of 52.87.  \n- `sp_rate_mc`: For every increase of one phone per second, perceived persuasiveness is estimated to decrease by -0.19.  \n\n:::\n:::panel\n#### Standardised X\n\nWe can _standardise_ our predictor and fit the model yet again: \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndap2 <- dap2 %>% mutate(sp_rate_z = scale(sp_rate))\nm3 <- lm(persuasive ~ sp_rate_z, data = dap2)\nsummary(m3)$coefficients\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Estimate Std. Error   t value     Pr(>|t|)\n(Intercept) 52.874667   1.351942 39.110165 6.429541e-80\nsp_rate_z   -0.576077   1.356471 -0.424688 6.716809e-01\n```\n:::\n:::\n\n- `(Intercept)`: A audio clip of someone speaking at the __mean__ phones per second is estimated as having an average persuasive rating of 52.87.  \n- `sp_rate_z`: For every increase of one __standard deviation__ in phones per second, perceived persuasiveness is estimated to decrease by -0.58. \n\nRemember that the `scale(sp_rate)` is subtracting the mean from each value, then dividing those by the standard deviation. \nThe standard deviation of `dap2$sp_rate` is:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsd(dap2$sp_rate)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 3.016315\n```\n:::\n:::\n\nso in our variable `dap2$sp_rate_z`, a change of 3.02 gets scaled to be a change of 1 (because we are dividing by `sd(dap2$sp_rate)`).  \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncoef(m1)[2] * sd(dap2$sp_rate)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  sp_rate \n-0.576077 \n```\n:::\n\n```{.r .cell-code}\ncoef(m3)[2]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nsp_rate_z \n-0.576077 \n```\n:::\n:::\n\n\n:::\n:::\n\nNote that these models are identical. When we conduct a model comparison between the 3 models, the residual sums of squares is identical for all models: \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nanova(m1,m2,m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: persuasive ~ sp_rate\nModel 2: persuasive ~ sp_rate_mc\nModel 3: persuasive ~ sp_rate_z\n  Res.Df   RSS Df Sum of Sq F Pr(>F)\n1    148 40576                      \n2    148 40576  0         0         \n3    148 40576  0         0         \n```\n:::\n:::\n\n\nWhat changes when you center or scale a predictor in a standard regression model (one fitted with `lm()`)?  \n\n- The variance explained by the predictor remains exactly the same\n- The intercept will change to be the estimated mean outcome where that predictor is \"0\". Scaling and centering changes what \"0\" represents, thereby changing this estimate (the significance test will therefore also change because the intercept now has a different meaning)\n- The slope of the predictor will change according to any scaling (e.g. if you divide your predictor by 10, the slope will multiply by 10). \n- The **test** of the slope of the predictor remains exactly the same.  \n\n:::\n\n:::frame\n__Data: Hangry__\n\nThe study is interested in evaluating whether hunger influences peoples' levels of irritability (i.e., \"the hangry hypothesis\"), and whether this is different for people following a diet that includes fasting. 81 participants were recruited into the study. Once a week for 5 consecutive weeks, participants were asked to complete two questionnaires, one assessing their level of hunger, and one assessing their level of irritability. The time and day at which participants were assessed was at a randomly chosen hour between 7am and 7pm each week. 46 of the participants were following a five-two diet (five days of normal eating, 2 days of fasting), and the remaining 35 were following no specific diet.  \n\nThe data are available at: [https://uoepsy.github.io/data/hangry.csv](https://uoepsy.github.io/data/hangry.csv).  \n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> variable </th>\n   <th style=\"text-align:left;\"> description </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> q_irritability </td>\n   <td style=\"text-align:left;\"> Score on irritability questionnaire (0:100) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> q_hunger </td>\n   <td style=\"text-align:left;\"> Score on hunger questionnaire (0:100) </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> ppt </td>\n   <td style=\"text-align:left;\"> Participant </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> fivetwo </td>\n   <td style=\"text-align:left;\"> Whether the participant follows the five-two diet </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n\n\n\n<div class='question-begin'>Question 1</div><div class='question-body'>\n\n\nRead carefully the description of the study above, and try to write out (in `lmer` syntax) an appropriate model to test the research aims.  \ne.g.:  \n```{}\noutcome ~ explanatory variables + (???? | grouping)\n```\nTry to think about the maximal random effect structure (i.e. everything that can vary by-grouping is estimated as doing so). \n\nTo help you think through the steps to get from a description of a research study to a model specification, think about your answers to the following questions. \n\nQ: What is our outcome variable?  \nQ: What are our explanatory variables?  \nQ: Is there any grouping (or \"clustering\") of our data that we consider to be a random sample? If so, what are the groups?  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\n- The research is looking at how hunger influences irritability, and whether this is different for people on the fivetwo diet.\n- We can split our data in to groups of each participant. We can also split it into groups of each diet. Which of these groups have we randomly sampled? Do we have a random sample of participants? Do we have a random sample of diets? Another way to think of this is \"if i repeated the experiment, what these groups be different?\"\n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-5' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-5', 'sol-start-5')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-5\" style=\"display: none;\">\n\n\n\nOur outcome is irritability here, because it is the thing that we are trying to explain through peoples' hunger levels and diets.  \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlmer(irritability ~  explanatory variables + (???? | grouping))\n```\n:::\n\n\nWe are interested in the effect of hunger on irritability, and whether this effect is different for the five-two diet. \nSo we are interested in the interaction: \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlmer(irritability ~  hunger + diet + hunger:diet + (???? | grouping))\n```\n:::\n\n(remember that `hunger + diet + hunger:diet` is just a more explicit way of writing `hunger*diet`). \n\nIf we did this experiment again, would we have different participants?  \nYes. If we did this experiment again, would we have different diets? No, because we're interested in the specific differences between the five-two diet and no dieting. This means we will likely want to by-participant random deviations (e.g. the `( ... | participant)` bit in `lmer`). But we won't have by-diet random effects `(1 | diet)` because the diet differences are the specific differences that we wish to test.  \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlmer(irritability ~  hunger + diet + hunger:diet + (???? | participant))\n```\n:::\n\n\nThinking about what __can__ be modelled as randomly varying between participants, we have some options:\n\n1. participants vary in how irritable they are on average   \n(the intercept, `1 | participant`)\n2. participants vary in how much hunger influences their irritability   \n(the effect of hunger, `hunger | participant`)\n3. participants vary in how much diet influences irritability   \n(the effect of diet, `diet | participant`)\n4. participants vary in how much diet effects hunger's influence on irritability   \n(the interaction between diet and hunger, `diet:hunger | participant`)\n\nWe can vary 1 and 2, but not 3 and 4. This is because each participant is _either_ following the five-two diet _or_ they are not. So for a _single_ participant, we can't assess \"the effect diet has\" on anything, because we haven't seen that participant under different diets. if we try to plot a single participants' data, we can see that it is impossible for us to assess \"the effect of diet\":\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](03_assumptcent_files/figure-html/unnamed-chunk-31-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\nBy contrast, we __can__ vary the intercept and the effect of hunger, because each participant has multiple values of irritability, and multiple different observations of hunger. We can think about a single participant's \"effect of hunger on irritability\" and how we might fit a line to their data:\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](03_assumptcent_files/figure-html/unnamed-chunk-32-1.png){fig-align='center' width=80%}\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlmer(irritability ~  hunger + diet + hunger:diet + (1 + hunger | participant))\n```\n:::\n\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n::: {.callout-note collapse=\"true\"}\n## Total, Within, Between\n\nRecall our research aim: \n\n> **... whether hunger influences peoples' levels of irritability (i.e., \"the hangry hypothesis\")**, and whether this is different for people following a diet that includes fasting.  \n\nForgetting about any differences due to diet, let's just think about the relationship between irritability and hunger. How should we interpret this research aim?  \nWas it: \n\na. \"Are people more irritable if they are, __on average__, more hungry __than other people__?\"  \nb. \"Are people more irritable if they are, __for them__, more hungry __than they usually are__?\"  \nc. Some combination of both a. and b.   \n\nThis is just one demonstration of how the statistical methods we use can constitute an integral part of our development of a research project, and part of the reason that data analysis for scientific cannot be so easily outsourced after designing the study and collecting the data.  \n\nAs our data currently is currently stored, the relationship between `irritability` and the raw scores on the hunger questionnaire `q_hunger` represents some 'total effect' of hunger on irritability. This is a bit like interpretation __c.__ above - it's a composite of both the 'within' ( __b.__ ) and 'between' ( __a.__ ) effects. The problem with this is that the 'total effect' isn't necessarily all that meaningful. It may tell us that 'being higher on the hunger questionnaire is associated with being more irritable', but how can we apply this information? It is not specifically about the comparison between hungry people and less hungry people, and nor is it about how person i changes when they are more hungry than usual. It is both these things smushed together.  \n\nTo disaggregate the 'within' and 'between' effects of hunger on irritability, we can group-mean center. For 'between', we are interested in how irritability is related to the average hunger levels of a participant, and for 'within', we are asking how irritability is related to a participants' _relative levels_ of hunger (i.e., how far above/below their average hunger level they are.).  \n\n:::\n\n\n\n\n<div class='question-begin'>Question 2</div><div class='question-body'>\n\n\nAdd to the data these two columns: \n\n1. a column which contains the average hungriness score for each participant.\n2. a column which contains the deviation from each person's hunger score to that person's average hunger score. \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\nYou'll find `group_by() %>% mutate()` very useful here. \n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-6' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-6', 'sol-start-6')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-6\" style=\"display: none;\">\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhangry <- \n    hangry %>% group_by(ppt) %>%\n        mutate(\n            avg_hunger = mean(q_hunger),\n            hunger_gc = q_hunger - avg_hunger\n        )\nhead(hangry)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 6\n# Groups:   ppt [2]\n  q_irritability q_hunger ppt   fivetwo avg_hunger hunger_gc\n           <dbl>    <dbl> <chr> <fct>        <dbl>     <dbl>\n1             17       30 N1p1  1             26.6     3.4  \n2             19       27 N1p1  1             26.6     0.400\n3             19       29 N1p1  1             26.6     2.4  \n4             20       33 N1p1  1             26.6     6.4  \n5             24       14 N1p1  1             26.6   -12.6  \n6             30       28 N1p2  1             32.6    -4.6  \n```\n:::\n:::\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 3</div><div class='question-body'>\n\n\nFor each of the new variables you just added, plot the irritability scores against those variables.  \n\n- Does it look like hungry people are more irritable than less hungry people?  \n- Does it look like when people are more hungry than normal, they are more irritable? \n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-7' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-7', 'sol-start-7')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-7\" style=\"display: none;\">\n\n\nWe might find it easier to look at a plot where each participant is represented as their mean plus an indication of their range of irritability scores:  \n\n::: {.cell layout-align=\"center\" fig.asp='0.5'}\n\n```{.r .cell-code}\nggplot(hangry,aes(x=avg_hunger,y=q_irritability))+\n    stat_summary(geom=\"pointrange\")\n```\n\n::: {.cell-output-display}\n![](03_assumptcent_files/figure-html/unnamed-chunk-35-1.png){fig-align='center' width=80%}\n:::\n:::\n\nThere appears to be a slight positive relationship between a persons' average hunger and their irritability scores. \n\nIt is harder to tell what the relationship is between participant-centered hunger and irritability, because there are a lot of different lines (one for each participant). To make it easier to get an idea of what's happening, we'll make the plot fit a simple lm() (a straight line) for each participants' data:  \n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(hangry,aes(x=hunger_gc,y=q_irritability, color=ppt)) +\n  geom_point(alpha = .2) + \n  geom_smooth(method=lm, se=FALSE, lwd=.2) +\n  theme(legend.position = 'none')\n```\n\n::: {.cell-output-display}\n![](03_assumptcent_files/figure-html/unnamed-chunk-37-1.png){fig-align='center' width=80%}\n:::\n:::\n\n\nI think there might be a positive trend in here, in that participants tend to be higher irritability when they are higher (for them) on the hunger score. \n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 4</div><div class='question-body'>\n\n\nWe have taken the raw hunger scores and separated them into two parts (raw hunger scores = participants' average hunger score + observation level deviations from those averages), that represent two different aspects of the relationship between hunger and irritability.  \n\nAdjust your model specification to include these two separate variables as predictors, instead of the raw hunger scores.  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\n- `hunger * diet` could be replaced by `(hunger1 + hunger2) * diet`, thereby allowing each aspect of hunger to interact with diet. \n- We can only put one of these variables in the random effects `(1 + hunger | participant)`. Recall that above we discussed how we cannot have `(diet | participant)`, because \"an effect of diet\" makes no sense for a single participant (they are either on the diet or they are not, so there is no 'effect'). Similarly, each participant has only one value for their average hungriness.  \n\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-8' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-8', 'sol-start-8')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-8\" style=\"display: none;\">\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(lme4)\nhangrywb <- lmer(q_irritability ~ (avg_hunger + hunger_gc)* fivetwo + \n                (1 + hunger_gc | ppt), \n                data = hangry,\n                control = lmerControl(optimizer=\"bobyqa\"))\n```\n:::\n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 5</div><div class='question-body'>\n\n\nHopefully, you have fitted a model similar to the below:  \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhangrywb <- lmer(q_irritability ~ (avg_hunger + hunger_gc) * fivetwo + \n                (1 + hunger_gc | ppt), data = hangry,\n            control = lmerControl(optimizer=\"bobyqa\"))\n```\n:::\n\n\nBelow, we have obtained p-values using the Kenward Rogers Approximation of $df$ for the test of whether the fixed effects are zero, so we can see the significance of each estimate.  \n\nProvide an answer for each of these questions:\n\n1. For those following no diet, is there evidence to suggest that people who are _on average_ more hungry are more irritable?\n2. Is there evidence to suggest that this is different for those following the five-two diet? In what way?\n3. Do people following no diet tend to be more irritable when they are more hungry than they usually are? \n4. Is there evidence to suggest that this is different for those following the five-two diet? In what way?\n5. __(Trickier:)__ What does the `fivetwo` coefficient represent? \n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n```{=html}\n<div id=\"fwvqeotxbz\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#fwvqeotxbz table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#fwvqeotxbz thead, #fwvqeotxbz tbody, #fwvqeotxbz tfoot, #fwvqeotxbz tr, #fwvqeotxbz td, #fwvqeotxbz th {\n  border-style: none;\n}\n\n#fwvqeotxbz p {\n  margin: 0;\n  padding: 0;\n}\n\n#fwvqeotxbz .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 100%;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#fwvqeotxbz .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#fwvqeotxbz .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#fwvqeotxbz .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#fwvqeotxbz .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fwvqeotxbz .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fwvqeotxbz .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#fwvqeotxbz .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#fwvqeotxbz .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#fwvqeotxbz .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#fwvqeotxbz .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#fwvqeotxbz .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#fwvqeotxbz .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#fwvqeotxbz .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#fwvqeotxbz .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#fwvqeotxbz .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#fwvqeotxbz .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#fwvqeotxbz .gt_row {\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#fwvqeotxbz .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fwvqeotxbz .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#fwvqeotxbz .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#fwvqeotxbz .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#fwvqeotxbz .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fwvqeotxbz .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#fwvqeotxbz .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#fwvqeotxbz .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fwvqeotxbz .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fwvqeotxbz .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#fwvqeotxbz .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fwvqeotxbz .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#fwvqeotxbz .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#fwvqeotxbz .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fwvqeotxbz .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fwvqeotxbz .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#fwvqeotxbz .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#fwvqeotxbz .gt_left {\n  text-align: left;\n}\n\n#fwvqeotxbz .gt_center {\n  text-align: center;\n}\n\n#fwvqeotxbz .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#fwvqeotxbz .gt_font_normal {\n  font-weight: normal;\n}\n\n#fwvqeotxbz .gt_font_bold {\n  font-weight: bold;\n}\n\n#fwvqeotxbz .gt_font_italic {\n  font-style: italic;\n}\n\n#fwvqeotxbz .gt_super {\n  font-size: 65%;\n}\n\n#fwvqeotxbz .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#fwvqeotxbz .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#fwvqeotxbz .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#fwvqeotxbz .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#fwvqeotxbz .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#fwvqeotxbz .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#fwvqeotxbz .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_heading\">\n      <td colspan=\"7\" class=\"gt_heading gt_title gt_font_normal gt_bottom_border\" style>Model Summary</td>\n    </tr>\n    \n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Parameter\">Parameter</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"Coefficient\">Coefficient</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"SE\">SE</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"95% CI\">95% CI</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"t\">t</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"df\">df</th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"p\">p</th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"7\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Fixed Effects \">Fixed Effects </th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"Fixed Effects   Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">(Intercept)</td>\n<td headers=\"Fixed Effects   Coefficient\" class=\"gt_row gt_center\">17.13</td>\n<td headers=\"Fixed Effects   SE\" class=\"gt_row gt_center\">5.21</td>\n<td headers=\"Fixed Effects   95% CI\" class=\"gt_row gt_center\">(6.75, 27.51)</td>\n<td headers=\"Fixed Effects   t\" class=\"gt_row gt_center\">3.29</td>\n<td headers=\"Fixed Effects   df\" class=\"gt_row gt_center\">77.00</td>\n<td headers=\"Fixed Effects   p\" class=\"gt_row gt_center\">0.002 </td></tr>\n    <tr><td headers=\"Fixed Effects   Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">avg hunger</td>\n<td headers=\"Fixed Effects   Coefficient\" class=\"gt_row gt_center\">3.86e-03</td>\n<td headers=\"Fixed Effects   SE\" class=\"gt_row gt_center\">0.11</td>\n<td headers=\"Fixed Effects   95% CI\" class=\"gt_row gt_center\">(-0.21, 0.22)</td>\n<td headers=\"Fixed Effects   t\" class=\"gt_row gt_center\">0.04</td>\n<td headers=\"Fixed Effects   df\" class=\"gt_row gt_center\">77.00</td>\n<td headers=\"Fixed Effects   p\" class=\"gt_row gt_center\">0.971 </td></tr>\n    <tr><td headers=\"Fixed Effects   Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">hunger gc</td>\n<td headers=\"Fixed Effects   Coefficient\" class=\"gt_row gt_center\">0.19</td>\n<td headers=\"Fixed Effects   SE\" class=\"gt_row gt_center\">0.08</td>\n<td headers=\"Fixed Effects   95% CI\" class=\"gt_row gt_center\">(0.03, 0.34)</td>\n<td headers=\"Fixed Effects   t\" class=\"gt_row gt_center\">2.45</td>\n<td headers=\"Fixed Effects   df\" class=\"gt_row gt_center\">70.40</td>\n<td headers=\"Fixed Effects   p\" class=\"gt_row gt_center\">0.017 </td></tr>\n    <tr><td headers=\"Fixed Effects   Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">fivetwo (1)</td>\n<td headers=\"Fixed Effects   Coefficient\" class=\"gt_row gt_center\">-10.85</td>\n<td headers=\"Fixed Effects   SE\" class=\"gt_row gt_center\">6.62</td>\n<td headers=\"Fixed Effects   95% CI\" class=\"gt_row gt_center\">(-24.03, 2.32)</td>\n<td headers=\"Fixed Effects   t\" class=\"gt_row gt_center\">-1.64</td>\n<td headers=\"Fixed Effects   df\" class=\"gt_row gt_center\">77.00</td>\n<td headers=\"Fixed Effects   p\" class=\"gt_row gt_center\">0.105 </td></tr>\n    <tr><td headers=\"Fixed Effects   Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">avg hunger × fivetwo (1)</td>\n<td headers=\"Fixed Effects   Coefficient\" class=\"gt_row gt_center\">0.47</td>\n<td headers=\"Fixed Effects   SE\" class=\"gt_row gt_center\">0.14</td>\n<td headers=\"Fixed Effects   95% CI\" class=\"gt_row gt_center\">(0.20, 0.74)</td>\n<td headers=\"Fixed Effects   t\" class=\"gt_row gt_center\">3.44</td>\n<td headers=\"Fixed Effects   df\" class=\"gt_row gt_center\">77.00</td>\n<td headers=\"Fixed Effects   p\" class=\"gt_row gt_center\">&lt; .001</td></tr>\n    <tr><td headers=\"Fixed Effects   Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">hunger gc × fivetwo (1)</td>\n<td headers=\"Fixed Effects   Coefficient\" class=\"gt_row gt_center\">0.38</td>\n<td headers=\"Fixed Effects   SE\" class=\"gt_row gt_center\">0.10</td>\n<td headers=\"Fixed Effects   95% CI\" class=\"gt_row gt_center\">(0.18, 0.58)</td>\n<td headers=\"Fixed Effects   t\" class=\"gt_row gt_center\">3.75</td>\n<td headers=\"Fixed Effects   df\" class=\"gt_row gt_center\">73.64</td>\n<td headers=\"Fixed Effects   p\" class=\"gt_row gt_center\">&lt; .001</td></tr>\n    <tr class=\"gt_group_heading_row\">\n      <th colspan=\"7\" class=\"gt_group_heading\" scope=\"colgroup\" id=\"Random Effects \">Random Effects </th>\n    </tr>\n    <tr class=\"gt_row_group_first\"><td headers=\"Random Effects   Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">SD (Intercept: ppt)</td>\n<td headers=\"Random Effects   Coefficient\" class=\"gt_row gt_center\">6.93</td>\n<td headers=\"Random Effects   SE\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   95% CI\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   t\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   df\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   p\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"Random Effects   Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">SD (hunger_gc: ppt)</td>\n<td headers=\"Random Effects   Coefficient\" class=\"gt_row gt_center\">0.38</td>\n<td headers=\"Random Effects   SE\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   95% CI\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   t\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   df\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   p\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"Random Effects   Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">Cor (Intercept~hunger_gc: ppt)</td>\n<td headers=\"Random Effects   Coefficient\" class=\"gt_row gt_center\">-0.01</td>\n<td headers=\"Random Effects   SE\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   95% CI\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   t\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   df\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   p\" class=\"gt_row gt_center\"></td></tr>\n    <tr><td headers=\"Random Effects   Parameter\" class=\"gt_row gt_left\" style=\"border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;\">SD (Residual)</td>\n<td headers=\"Random Effects   Coefficient\" class=\"gt_row gt_center\">4.83</td>\n<td headers=\"Random Effects   SE\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   95% CI\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   t\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   df\" class=\"gt_row gt_center\"></td>\n<td headers=\"Random Effects   p\" class=\"gt_row gt_center\"></td></tr>\n  </tbody>\n  <tfoot class=\"gt_sourcenotes\">\n    <tr>\n      <td class=\"gt_sourcenote\" colspan=\"7\"></td>\n    </tr>\n  </tfoot>\n  \n</table>\n</div>\n```\n:::\n:::\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-9' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-9', 'sol-start-9')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-9\" style=\"display: none;\">\n\n\n\n\n**1: For those following no diet, is there evidence to suggest that people who are _on average_ more hungry are more irritable?**  \nA: 'No diet' is the reference level of the five-two variable, and because we have an interaction, that means the `avg_hunger` coefficient will provide the relevant estimate. There is no evidence ($p>.05$) to suggest that when not dieting, hungrier people are more irritable than less hungry people. \n\n\n**2: Is there evidence to suggest that this is different for those following the five-two diet? In what way?**  \nA: This is the interaction between `avg_hunger:fivetwo1`. We can see that, for every increase of 1 in average hunger, irritability is estimated to increase by 0.47 more for those in the five-two diet than it does for those following no diet.  \nThese units are still in terms of the original scale (i.e. 0 to 100). \n\n\n**3: Do people following no diet tend to be more irritable when they are more hungry than they usually are?** \nA: This is the estimate for the coefficient of `hunger_gc`. For people following no diet, there is an estimated 0.19 increase in irritability for every 1 unit more hungry they become. \n\n**4: Is there evidence to suggest that this is different for those following the five-two diet? In what way?**\nA: This effect of a 1 unit change on within-person hunger increasing irritability is increased for those who are following the five-two diet by an additional 0.38\n\n**5: What does the `fivetwo1` coefficient represent?** \nA: This represents the group difference of irritability between those on the five-two diet vs those not dieting, for someone who has an average hunger score of 0. \n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 6</div><div class='question-body'>\n\n\nConstruct two plots showing the two model estimated interactions. Think about your answers to the previous question, and check that they match with what you are seeing in the plots (do not underestimate the utility of this activity for helping understanding!).  \n\n::: {.callout-tip collapse=\"true\"}\n#### Hints\n\nThis isn't as difficult as it sounds. the sjPlot package can do it in one line of code!\n\n:::\n\n\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-10' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-10', 'sol-start-10')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-10\" style=\"display: none;\">\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(sjPlot)\nplot_model(hangrywb, type = \"int\")[[1]]\n```\n\n::: {.cell-output-display}\n![](03_assumptcent_files/figure-html/unnamed-chunk-41-1.png){fig-align='center' width=80%}\n:::\n:::\n\nWe saw in the model coefficients that for the reference level of `fivetwo`, the \"No Diet\" group, there was no association between how hungry a person is _on average_ and their irritability. This is the red line we see in the plot above. \nWe also saw the interaction `avg_hunger:fivetwo1` indicates that irritability is estimated to increase by 0.47 more for those in the five-two diet than it does for those following no diet. So the blue line is should be going up more steeply than the red line (which is flat). And it is! \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nplot_model(hangrywb, type = \"int\")[[2]]\n```\n\n::: {.cell-output-display}\n![](03_assumptcent_files/figure-html/unnamed-chunk-42-1.png){fig-align='center' width=80%}\n:::\n:::\n\nFrom the coefficient of `hunger_gc` we get the estimated amount by which irritability increases for every 1 more hungry that a person becomes (when they're on \"No Diet\"). This is the slope of the red line. \nThe interaction `hunger_gc:fivetwo1` gave us the adjustment to get from the red line to the blue line. It is positive and significant, which matches with the fact that the blue line is clearly steeper in this plot. \n\n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n\n<div class='question-begin'>Question 7</div><div class='question-body'>\n\n\nProvide tests or confidence intervals for the parameters of interest, and write-up the results.  \n\n::: {.callout-tip collapse=\"true\"}\n#### Remember: some options for inference\n\n\n|                  | df approximations                                                  | likelihood-based                                                    | \n| ---------------- | ------------------------------------------------------------------ | ------------------------------------------------------------------- | \n| tests or CIs for model parameters | `library(parameters)`<br>`model_parameters(model, ci_method=\"kr\")` | `confint(model, type=\"profile\")`                                    | \n| model comparison<br><small>(different fixed effects, same random effects)</small> | `library(pbkrtest)`<br>`KRmodcomp(model1,model0)`                  | `anova(model0,model)`                                               |\n|                  | fit models with `REML=TRUE`.<br>good option for small samples      | fit models with `REML=FALSE`.<br>needs large N at both levels (40+) | \n\n:::\n\n\n</div><p class=\"question-end\"></p>\n\n\n\n\n<div class=\"solution-begin\"><button id='sol-start-11' class=\"jk-circle-right solution-icon clickable\" onclick=\"toggle_visibility('sol-body-11', 'sol-start-11')\">  Solution </button></div><div class=\"solution-body\" id = \"sol-body-11\" style=\"display: none;\">\n\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(parameters)\nmodel_parameters(hangrywb, ci_method = \"kr\", ci_random = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# Fixed Effects\n\nParameter                | Coefficient |   SE |          95% CI |     t |    df |      p\n----------------------------------------------------------------------------------------\n(Intercept)              |       17.13 | 5.21 | [  6.75, 27.51] |  3.29 | 77.00 | 0.002 \navg hunger               |    3.86e-03 | 0.11 | [ -0.21,  0.22] |  0.04 | 77.00 | 0.971 \nhunger gc                |        0.19 | 0.08 | [  0.03,  0.34] |  2.45 | 70.40 | 0.017 \nfivetwo [1]              |      -10.85 | 6.62 | [-24.03,  2.32] | -1.64 | 77.00 | 0.105 \navg hunger × fivetwo [1] |        0.47 | 0.14 | [  0.20,  0.74] |  3.44 | 77.00 | < .001\nhunger gc × fivetwo [1]  |        0.38 | 0.10 | [  0.18,  0.58] |  3.75 | 73.64 | < .001\n\n# Random Effects\n\nParameter                      | Coefficient\n--------------------------------------------\nSD (Intercept: ppt)            |        6.93\nSD (hunger_gc: ppt)            |        0.38\nCor (Intercept~hunger_gc: ppt) |       -0.01\nSD (Residual)                  |        4.83\n```\n:::\n:::\n\n\n\n\nTo investigate the association between irritability and hunger, and whether this relationship is different depending on whether or not participants are on a restricted diet such as the five-two, a multilevel linear model was fitted.  \nTo disaggregate between the differences in irritability due to people being in general more/less hungry, and those due to people being more/less hungry than usual for them, irritability was regressed onto both participants' average hunger scores their relative hunger levels. Both of these were allowed to interact with whether or not participants were on the five-two diet. Random intercepts and slopes of relative-hunger level were included for participants. The model was fitting with restricted maximum likelihood estimation with the **lme4** package (Bates et al., 2015), using the _bobyqa_ optimiser from the **lme4**. $P$-values were obtained using Wald tests with Kenward-Roger approximation of denominator degrees of freedom.  \n\nResults indicate that for people on no diet, being more hungry than normal was associated with greater irritability ($\\beta = 0.19,\\ SE = 0.08,\\ t(2.45) = 70.4,\\ p=0.017$), and that this was increased for those following the five-two diet ($\\beta = 0.38,\\ SE = 0.1,\\ t(3.75) = 73.64,\\ p<0.001$). \nAlthough for those not on a specific diet there was no evidence for an association between irritability and being generally a more hungry person ($p=0.971$), there a significant interaction was found between average hunger and being on the five-two diet ($\\beta = 0.47,\\ SE = 0.14,\\ t(3.44) = 77,\\ p<0.001$), suggesting that when dieting, hungrier people tend to be more irritable than less hungry people.  \nResults suggest that the 'hangry hypothesis' may occur _within_ people (when a person is more hungry than they usually are, they tend to be more irritable), but not necessarily between hungry/less hungry people. Dieting was found to increase the association of both between-person hunger and within-person hunger with irritability.  \n\n\n</div><p class=\"solution-end\"></p>\n\n\n\n\n:::statbox\n__Other within-group transformations__  \n\nAs well as within-group mean centering a predictor (like we have done above), we can within-group _standardise_ a predictor. This would disagregate within and between effects, but interpretation would of the within effect would be the estimated change in $y$ associated with being 1 standard deviation higher in $x$ _for that group_.  \n\n:::\n<br>\n\n\n\n<div class=\"tocify-extend-page\" data-unique=\"tocify-extend-page\" style=\"height: 0;\"></div>\n",
    "supporting": [
      "03_assumptcent_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}