{
  "hash": "cef7f6ab09776c16d48b127d91526747",
  "result": {
    "markdown": "---\ntitle: 'Analysis Example: Rpt & Mixed ANOVA'\ncode-fold: true\nparams: \n    SHOW_SOLS: TRUE\n    TOGGLE: TRUE\n---\n\n\n\n\n:::imp\nThis is optional for the DAPR3 course, but may be useful for your dissertations should your field/supervisor prefer the ANOVA framework to that of the linear model. \n\nThis walks briefly through these models with the __ez__ package. There are many other packages available, and many good tutorials online should you desire extra resources in the future:\n\n- https://www.datanovia.com/en/lessons/repeated-measures-anova-in-r\n- https://www.r-bloggers.com/2021/04/repeated-measures-of-anova-in-r-complete-tutorial/\n- https://stats.idre.ucla.edu/r/seminars/repeated-measures-analysis-with-r/ \n- https://www.datanovia.com/en/lessons/mixed-anova-in-r/  \n\n:::\n\n\n:::frame\n__Data: Audio interference in executive functioning__  \n\n\n\n\n\n\nThis data is from a simulated study that aims to investigate the following research questions: \n\n> How do different types of audio interfere with executive functioning, and does this interference differ depending upon whether or not noise-cancelling headphones are used? \n\n24 healthy volunteers each completed the Symbol Digit Modalities Test (SDMT) - a commonly used test to assess processing speed and motor speed - a total of 15 times. During the tests, participants listened to either no audio (5 tests), white noise (5 tests) or classical music (5 tests). Half the participants listened via active-noise-cancelling headphones, and the other half listened via speakers in the room.  \n\nThe data is in stored in two separate files - the research administering the tests recorded the SDMT score in one spreadsheet, while details of the audio used in the experiment are held in a separate sheet\n\n1. Information about the audio condition for each trial of each participant is stored in __.csv__ format at [https://uoepsy.github.io/data/ef_music.csv](https://uoepsy.github.io/data/ef_music.csv). The data is in long format (1 row per participant-trial).  \n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n|variable   |description                                                                                  |\n|:----------|:--------------------------------------------------------------------------------------------|\n|PID        |Participant ID                                                                               |\n|trial_n    |Trial Number (1-15)                                                                          |\n|audio      |Audio heard during the test ('no_audio', 'white_noise','music')                              |\n|headphones |Whether the participant listened via speakers in the room or via noise cancelling headphones |\n:::\n:::\n\n\n2. Information on participants' Symbol Digit Modalities Test (SDMT) for each trial is stored in **.xlsx** format at [https://uoepsy.github.io/data/ef_sdmt.xlsx](https://uoepsy.github.io/data/ef_sdmt.xlsx). The data is in wide format (1 row per participant, 1 column per trial).   \n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n|variable |description             |\n|:--------|:-----------------------|\n|PID      |Participant ID          |\n|Trial_01 |SDMT score in trial 1   |\n|Trial_02 |SDMT score in trial 2   |\n|Trial_03 |SDMT score in trial 3   |\n|...      |SDMT score in trial ... |\n|...      |SDMT score in trial ... |\n|Trial_15 |SDMT score in trial 15  |\n:::\n:::\n\n\n\n:::\n\nThe code below will read in both datasets and join them for you:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\ndownload.file(url = \"https://uoepsy.github.io/data/ef_sdmt.xlsx\",\n              destfile = \"ef_sdmt.xlsx\",\n              mode = \"wb\")\nefdata <- \n  left_join(\n    read_csv(\"https://uoepsy.github.io/data/ef_music.csv\"),\n    read_xlsx(\"ef_sdmt.xlsx\") %>%\n      pivot_longer(Trial_01:Trial_15, names_to = \"trial_n\", values_to = \"SDMT\")\n  )\n```\n:::\n\n\n\n\n# One-Way Repeated Measures ANOVA\n\nFor a repeated measures ANOVA, we have one independent variable that is _within_ group.  \nThis would be appropriate if our research question were the following:    \n\n> How do different types of audio interfere with executive functioning?  \n\nMapping this to the variables in our dataset, our model is going to be `SDMT ~ audio`, and we want to account for `PID` differences. So for now we will ignore the `headphones` variable.  \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nhead(efdata)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 Ã— 5\n  PID    trial_n  audio       headphones  SDMT\n  <chr>  <chr>    <chr>       <chr>      <dbl>\n1 PPT_01 Trial_02 no_audio    speakers      31\n2 PPT_01 Trial_08 no_audio    speakers      23\n3 PPT_01 Trial_11 no_audio    speakers      23\n4 PPT_01 Trial_13 no_audio    speakers      24\n5 PPT_01 Trial_15 no_audio    speakers      34\n6 PPT_01 Trial_01 white_noise speakers      38\n```\n:::\n:::\n\n\n\nThe easiest way to conduct a repeated measures ANOVA in R is to use the __ez__ package, which comes with some handy functions to visualise the experimental design.  \nWe can see from below that every participant completed 5 trials for each type of audio interference:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(ez)\nezDesign(data = efdata, x = audio, y = PID)\n```\n\n::: {.cell-output-display}\n![](example_00_anova_files/figure-html/unnamed-chunk-6-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nThe `ezANOVA()` function takes a few arguments. \n\nThe ones you will need for this are:\n\n- *data* the name of the dataframe\n- *dv* the column name for the dependent variable\n- *wid* the column name for the participant id variable\n- *within* the column name(s) for the predictor variable(s) that vary within participants \n- *between* the column name(s) for any predictor variable(s) that vary between participants\n\nFit a repeated measures ANOVA to examine the effect of the audio type on SDMT:  \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nezANOVA(data = efdata, dv = SDMT, wid = PID, within = audio)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$ANOVA\n  Effect DFn DFd        F            p p<.05       ges\n2  audio   2  46 44.69618 1.647271e-11     * 0.2534633\n\n$`Mauchly's Test for Sphericity`\n  Effect         W          p p<.05\n2  audio 0.8105961 0.09927715      \n\n$`Sphericity Corrections`\n  Effect       GGe      p[GG] p[GG]<.05      HFe        p[HF] p[HF]<.05\n2  audio 0.8407573 5.0677e-10         * 0.899603 1.427119e-10         *\n```\n:::\n:::\n\n\n\n# Mixed ANOVA \n\nMixed ANOVA can be used to investigate effects of independent variables that are at two different levels,  i.e. some are *within* clusters and some are *between*.  \n\n> Does the effect of audio interference on executive functioning differ depending upon whether or not noise-cancelling headphones are used? \n\nLook at the two lines below. Can you work out what the plots will look like _before_ you run them? \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nezDesign(data = efdata, x = headphones, y = PID)\nezDesign(data = efdata, x = headphones, y = audio)\n```\n:::\n\n\nParticipants 1-20 are in one condition, and 21-40 are in another.  \nThis should look like a two big blocks on the diagonal. \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nezDesign(data = efdata, x = headphones, y = PID)\n```\n\n::: {.cell-output-display}\n![](example_00_anova_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=672}\n:::\n:::\n\nIn each condition, all different types of audio were observed in the same number of trials.\nThis should be a full grid:\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nezDesign(data = efdata, x = headphones, y = audio)\n```\n\n::: {.cell-output-display}\n![](example_00_anova_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=672}\n:::\n:::\n\n\nFit a mixed ANOVA to examine the interaction between audio and headphone use on SDMT:  \n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nezANOVA(data = efdata, dv = SDMT, wid = PID, within = audio, between = headphones)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$ANOVA\n            Effect DFn DFd         F            p p<.05        ges\n2       headphones   1  22  9.815545 4.836945e-03     * 0.26784992\n3            audio   2  44 59.615596 2.980503e-13     * 0.32788320\n4 headphones:audio   2  44  8.677316 6.657590e-04     * 0.06629911\n\n$`Mauchly's Test for Sphericity`\n            Effect         W         p p<.05\n3            audio 0.9422531 0.5355001      \n4 headphones:audio 0.9422531 0.5355001      \n\n$`Sphericity Corrections`\n            Effect       GGe        p[GG] p[GG]<.05      HFe        p[HF]\n3            audio 0.9454057 1.196469e-12         * 1.031585 2.980503e-13\n4 headphones:audio 0.9454057 8.648057e-04         * 1.031585 6.657590e-04\n  p[HF]<.05\n3         *\n4         *\n```\n:::\n:::\n\n\nThe __ez__ package also contains some easy plotting functions for factorial experiments, such as `ezPlot()`. It takes similar arguments to the `ezANOVA()` function. \n\n- look up the help documentation for `ezPlot()`. \n- let's use `ezPlot()` to make a nice plot\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nezPlot(data = efdata, dv = SDMT, \n       wid = PID, within = audio, between = headphones,\n       x = audio, split = headphones)\n```\n\n::: {.cell-output-display}\n![](example_00_anova_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n\n::: {.callout-note collapse=\"true\"}\n#### The same thing in lmer\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(lme4)\nlibrary(lmerTest)\nmod <- lmer(SDMT ~ 1 + headphones * audio + (1 + audio | PID), \n            data = efdata)\nanova(mod, type=\"III\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nType III Analysis of Variance Table with Satterthwaite's method\n                 Sum Sq Mean Sq NumDF DenDF F value    Pr(>F)    \nheadphones        325.0  325.04     1    22  9.8155  0.004837 ** \naudio            3212.0 1606.01     2    22 48.4976 8.626e-09 ***\nheadphones:audio  490.1  245.06     2    22  7.4001  0.003486 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(sjPlot)\nplot_model(mod, type=\"eff\", terms=c(\"audio\",\"headphones\"))\n```\n\n::: {.cell-output-display}\n![](example_00_anova_files/figure-html/unnamed-chunk-14-1.png){fig-align='center' width=672}\n:::\n:::\n\n\n:::\n\n\n\n<div class=\"tocify-extend-page\" data-unique=\"tocify-extend-page\" style=\"height: 0;\"></div>\n\n",
    "supporting": [
      "example_00_anova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}