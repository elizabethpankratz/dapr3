<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DAPR3 - Path Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-hand-o-right')) {
    f.classList.add('fa-hand-o-left')
    f.classList.remove('fa-hand-o-right')
} else {
    f.classList.add('fa-hand-o-right')
    f.classList.remove('fa-hand-o-left')
}
}
</script>

<script src="https://kit.fontawesome.com/120b08a6f5.js" crossorigin="anonymous"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">DAPR3</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-multi-level-models" role="button" data-bs-toggle="dropdown" aria-expanded="false">Multi Level Models</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-multi-level-models">    
        <li>
    <a class="dropdown-item" href="./01_regressionrefresh.html">
 <span class="dropdown-text">1: Linear Regression | Clustered Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02_intromlm.html">
 <span class="dropdown-text">2: Multilevel Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./03_assumptranef.html">
 <span class="dropdown-text">3: Assumptions, Diagnostics &amp; Random Effect Structures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./04_centerglmer.html">
 <span class="dropdown-text">4: Centering in MLM | Logistic</span></a>
  </li>  
        <li class="dropdown-header">5: Recap</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-dimension-reduction--sem" role="button" data-bs-toggle="dropdown" aria-expanded="false">Dimension reduction &amp; SEM</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-dimension-reduction--sem">    
        <li>
    <a class="dropdown-item" href="./07_path_analysis.html">
 <span class="dropdown-text">7: Path Analysis</span></a>
  </li>  
        <li class="dropdown-header">8: Path Mediation</li>
        <li class="dropdown-header">9: Dimension Reduction</li>
        <li class="dropdown-header">10: EFA: Part 1</li>
        <li class="dropdown-header">11: EFA: Part 2</li>
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-example-analyses" role="button" data-bs-toggle="dropdown" aria-expanded="false">Example Analyses</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-example-analyses">    
        <li>
    <a class="dropdown-item" href="./example_01_repeated_measures.html">
 <span class="dropdown-text">Example: Repeated Measures MLM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./example_02_intervention.html">
 <span class="dropdown-text">Example: Intervention Study</span></a>
  </li>  
        <li class="dropdown-header">Example: Many Trials</li>
        <li>
    <a class="dropdown-item" href="./example_00_anova.html">
 <span class="dropdown-text">Example: ANOVA (rpt measures &amp; mixed)</span></a>
  </li>  
        <li class="dropdown-header">Example: Exploratory Factor Analysis</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-explainer-docs" role="button" data-bs-toggle="dropdown" aria-expanded="false">Explainer Docs</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-explainer-docs">    
        <li class="dropdown-header">Likelihood vs Probability</li>
        <li class="dropdown-header">Writing 3-level MLM equations</li>
        <li class="dropdown-header">PCA and Unequal Variances</li>
    </ul>
  </li>
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#motivation" id="toc-motivation" class="nav-link active" data-scroll-target="#motivation">Motivation</a>
  <ul class="collapse">
  <li><a href="#a-model-reflects-a-theory" id="toc-a-model-reflects-a-theory" class="nav-link" data-scroll-target="#a-model-reflects-a-theory">A model reflects a theory</a></li>
  </ul></li>
  <li><a href="#introducing-path-analysis" id="toc-introducing-path-analysis" class="nav-link" data-scroll-target="#introducing-path-analysis">Introducing Path Analysis</a>
  <ul class="collapse">
  <li><a href="#how-does-it-work-in-brief" id="toc-how-does-it-work-in-brief" class="nav-link" data-scroll-target="#how-does-it-work-in-brief">How does it work (in brief)?</a></li>
  </ul></li>
  <li><a href="#doing-path-analysis" id="toc-doing-path-analysis" class="nav-link" data-scroll-target="#doing-path-analysis">Doing Path Analysis</a>
  <ul class="collapse">
  <li><a href="#specifying-the-model" id="toc-specifying-the-model" class="nav-link" data-scroll-target="#specifying-the-model">Specifying the model</a></li>
  <li><a href="#estimating-the-model" id="toc-estimating-the-model" class="nav-link" data-scroll-target="#estimating-the-model">Estimating the model</a></li>
  </ul></li>
  <li><a href="#model-fit" id="toc-model-fit" class="nav-link" data-scroll-target="#model-fit">Model Fit</a>
  <ul class="collapse">
  <li><a href="#degrees-of-freedom" id="toc-degrees-of-freedom" class="nav-link" data-scroll-target="#degrees-of-freedom">Degrees of freedom</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Path Analysis</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="lo">
<p><strong>Preliminaries</strong></p>
<ol type="1">
<li>Create a new RMarkdown document or R script (whichever you like) for this week.</li>
</ol>
</div>
<div class="lo">
<p><strong>Relevant packages</strong></p>
<ul>
<li>lavaan<br>
</li>
<li>semPlot or tidySEM</li>
</ul>
</div>
<section id="motivation" class="level1">
<h1>Motivation</h1>
<p>By now, we are getting more comfortable with the regression world, and we can see how it is extended to lots of different types of outcome and data structures. So far in DAPR3 it’s been all about the multiple levels. This has brought so many more potential study designs that we can now consider modelling - pretty much any study where we are interested in explaining some outcome variable, and where we have sampled clusters of observations (or clusters of clusters of clusters of … etc.).</p>
<p>But we are still restricted to thinking, similar to how we thought in DAPR2, about one single outcome variable. In fact, if we think about the structure of the fixed effects part of a model (i.e., the bit we’re <em>specifically interested in</em>), then we’re still limited to thinking of the world in terms of “this is my outcome variable, everything else predicts it”.</p>
<div class="statbox">
<p><strong>Regression as a path diagram</strong></p>
<ol type="1">
<li>Imagine writing the names of all your variables on a whiteboard</li>
<li>Specify which one is your dependent (or “outcome” or “response”) variable.</li>
<li>Sit back and relax, you’re done!</li>
</ol>
<p>In terms of a <em>theoretical</em> model of the world, there’s not really much to it. We have few choices in the model we construct beyond specifying which is our outcome variable.<br>
We can visualise our multiple regression model like this:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/path/mregpath.png" class="img-fluid figure-img" width="250"></p>
<p></p><figcaption class="figure-caption">In multiple regression, we decide which variable is our outcome variable, and then everything else is done for us</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Of course, there are a few other things that are included (an intercept term, the residual error, and the fact that our predictors can be correlated with one another), but the idea remains pretty much the same:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/path/mregpath2.png" class="img-fluid figure-img" width="250"></p>
<p></p><figcaption class="figure-caption">Multiple regression with intercept, error, predictor covariances</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p><br></p>
<section id="a-model-reflects-a-theory" class="level2">
<h2 class="anchored" data-anchor-id="a-model-reflects-a-theory">A model reflects a theory</h2>
<p>What if I my theoretical model of the world doesn’t fit this structure?</p>
<p>Let’s suppose I have 5 variables: Age, Parental Income, Income, Autonomy, and Job Satisfaction. I draw them up on my whiteboard:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-path1nopath" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/path/paths1nopaths.png" class="img-fluid figure-img" width="350"></p>
<p></p><figcaption class="figure-caption">Figure 1: My variables</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>My theoretical understanding of how these things fit together leads me to link my variables to end up with something like that in <a href="#fig-path1path">Figure&nbsp;2</a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-path1path" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/path/paths1paths.png" class="img-fluid figure-img" width="350"></p>
<p></p><figcaption class="figure-caption">Figure 2: My theory about my system of variables</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In this diagram, a persons income is influenced by their age, their parental income, and their level of autonomy, and in turn their income predicts their job satisfaction. Job satisfaction is also predicted by a persons age directly, and by their level of autonomy, which is also predicted by age. It’s complicated to look at, but in isolation each bit of this makes theoretical sense.</p>
<p>Take each arrow in turn and think about what it represents:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/path/paths1desc.png" class="img-fluid figure-img" width="550"></p>
</figure>
</div>
</div>
</div>
<p>If we think about trying to fit this “model” with the tools that we have, then we might end up wanting to fit three separate regression models, which between them specify all the different arrows in the diagram:</p>
<p><span class="math display">\[
\begin{align}
\textrm{Job Satisfaction} &amp; = \beta_0 + \beta_1(\textrm{Age}) + \beta_2(\textrm{Autonomy}) + \beta_3(\textrm{Income}) + \varepsilon \\
\textrm{Income} &amp; = \beta_0 + \beta_1(\textrm{Age}) + \beta_2(\textrm{Autonomy}) + \beta_2(\textrm{Parental Income}) + \varepsilon \\
\textrm{Autonomy} &amp; = \beta_0 + \beta_1(\textrm{Age}) + \varepsilon \\
\end{align}
\]</span></p>
<p>This is all well and good, but what if I want to talk about how well my entire model (<a href="#fig-path1path">Figure&nbsp;2</a>) fits the data we observed?</p>
</section>
</section>
<section id="introducing-path-analysis" class="level1">
<h1>Introducing Path Analysis</h1>
<div class="green">
<p><strong>Mountains cannot be surmounted except by winding paths</strong></p>
</div>
<p>The starting point for Path Analysis is to think about our theories in terms of the connections between variables drawn on a whiteboard. By representing a theory as paths to and from different variables, we open up a whole new way of ‘modelling’ the world around us.</p>
<p>There are a few conventions to help us understand this sort of diagrammatical way of thinking. By using combinations of rectangles, ovals, single- and double-headed arrows, we can draw all sorts of model structures. In Path Diagrams, we use specific shapes and arrows to represent different things in our model:</p>
<div class="statbox">
<p><strong>Shapes and Arrows in Path Diagrams</strong></p>
<ul>
<li><strong>Observed variables</strong> are represented by squares or rectangles. These are the named variables of interest which exist in our dataset - i.e.&nbsp;the ones which we have measured directly.</li>
<li><strong>Variances/Covariances</strong> are represented by double-headed arrows. In many diagrams these are curved.</li>
<li><strong>Regressions</strong> are shown by single headed arrows (e.g., an arrow from <span class="math inline">\(x\)</span> to <span class="math inline">\(y\)</span> for the path <span class="math inline">\(y~x\)</span>).<br>

</li><li style="opacity:.3">
<strong>Latent variables</strong> are represented by ovals, and we will return to these in a few weeks time!
</li>
</ul>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/path/semplots.png" class="img-fluid figure-img" width="650"></p>
</figure>
</div>
</div>
</div>
</div>
<div class="lo">
<p><strong>Terminology refresher</strong></p>
<ul>
<li><strong>Exogenous variables</strong> are a bit like what we have been describing with words like “independent variable” or “predictor”. In a path diagram, they have no paths coming from other variables in the system, but have paths <em>going to</em> other variables.<br>
</li>
<li><strong>Endogenous variables</strong> are more like the “outcome”/“dependent”/“response” variables we are used to. They have some path coming from another variable in the system (and may also - but not necessarily - have paths going out from them).</li>
</ul>
</div>
<section id="how-does-it-work-in-brief" class="level2">
<h2 class="anchored" data-anchor-id="how-does-it-work-in-brief">How does it work (in brief)?</h2>
<p>The logic behind path analysis is to estimate a system of equations that can repdroduce the covariance structure that we see in the data.</p>
<p>Suppose we think that</p>
<p>we collect data on these variables and observed the following correlation matrix:</p>
<p>we can evaluate how well our theoretical model (the system of equations) can reproduce the correlation matrix</p>
<p>this allows us to then compare this theoretical model with one which does NOT have a path from … to ..</p>
<div class="optional-begin">
<span id="opt-start-1" class="fa fa-hand-o-right optional-icon clickable" onclick="toggle_visibility('opt-body-1', 'opt-start-1')"> <span class="olab">Optional: How does it work (not as brief)?</span></span>
</div>
<div id="opt-body-1" class="optional-body" style="display: none;">
<p><strong>Path Diagram Tracing</strong></p>
<p>For Path Diagrams that meet a certain set of pre-requisites, we can use a cool technique called Path Tracing to estimate the different paths (i.e., the coefficients) from just the covariance matrix of the dataset. For us to be able to do this, a Path Diagram must meet these criteria:</p>
<ul>
<li>All our exogenous variables are correlated (unless we specifically assume that their correlation is zero)</li>
<li>All models are ‘recursive’ (no two-way causal relations, no feedback loops)</li>
<li>Residuals are uncorrelated with exogenous variables</li>
<li>Endogenous variables are not connected by correlations (we would use correlations between residuals here, because the residuals are not endogenous)</li>
<li>All ‘causal’ relations are linear and additive</li>
<li>‘causes’ are unitary (if A -&gt; B and A -&gt; C, then it is presumed that this is the same aspect of A resulting in a change in both B and C, and not two distinct aspects of A, which would be better represented by two correlated variables A1 and A2).</li>
</ul>
<div class="statbox">
<p><strong>Causal??</strong></p>
<p>It is a slippery slope to start using the word ‘cause’, and personally I am not that comfortable using it here. However, you will likely hear it a lot in resources about path analysis, so it is best to be warned.</p>
<p>Please keep in mind that we are using a very broad definition of ‘causal’, simply to reflect the one way nature of the relationship we are modeling. In Figure @ref(fig:causes), a change in the variable <strong>X1</strong> is associated with a change in <strong>Y</strong>, but not vice versa.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/path/causes.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Paths are still just regressions.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<p><strong>Tracing Rules</strong></p>
<p>Thanks to <a href="https://www.jstor.org/stable/pdf/2527551.pdf?casa_token=3QF0ad2ZoBcAAAAA:MbEkDNNdoLZr1SXE4LrnK--qrhhsTXLgsRtcWre1UvWxiQiGNUl5vWytGp34XIxhAYMZJe-MbIcBnEwXSfX6MAONevz04-sMXpEDI3IaYKk6mMX46QvX">Sewal Wright</a>, we can express the correlation between any two variables in the system as the sum of all <em>compound paths</em> between the two variables.</p>
<p><em>compound paths</em> are any paths you can trace between A and B for which there are:</p>
<ul>
<li>no loops</li>
<li>no going forward then backward</li>
<li>maximum of one curved arrow per path</li>
</ul>
<div class="frame">
<p><strong>An example</strong></p>
<p>Let’s consider the example below, for which the paths are all labelled with lower case letters <span class="math inline">\(a, b, c, \text{and } d\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/path/patheq1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">A multiple regression model as a path diagram</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>According to Wright’s tracing rules above, write out the equations corresponding to the 3 correlations between our observed variables (remember that <span class="math inline">\(r_{a,b} = r_{b,a}\)</span>, so it doesn’t matter at which variable we start the paths).</p>
<ul>
<li><span class="math inline">\(r_{x1,x2} = c\)</span><br>
</li>
<li><span class="math inline">\(r_{x1,y} = a + bc\)</span><br>
</li>
<li><span class="math inline">\(r_{x2,y} = b + ac\)</span></li>
</ul>
<p>Now let’s suppose we observed the following correlation matrix:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>egdat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/patheg.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>egdat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../../data/patheg.csv"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">cor</span>(egdat),<span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     x1   x2    y
x1 1.00 0.36 0.75
x2 0.36 1.00 0.60
y  0.75 0.60 1.00</code></pre>
</div>
</div>
<p>We can plug these into our system of equations:</p>
<ul>
<li><span class="math inline">\(r_{x1,x2} = c = 0.36\)</span><br>
</li>
<li><span class="math inline">\(r_{x1,y} = a + bc = 0.75\)</span><br>
</li>
<li><span class="math inline">\(r_{x2,y} = b + ac = 0.60\)</span></li>
</ul>
<p>And with some substituting and rearranging, we can work out the values of <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span> and <span class="math inline">\(c\)</span>.</p>
<div class="optional-begin">
<span id="opt-start-2" class="fa fa-hand-o-right optional-icon clickable" onclick="toggle_visibility('opt-body-2', 'opt-start-2')"> <span class="olab">Click for answers</span></span>
</div>
<div id="opt-body-2" class="optional-body" style="display: none;">
<p>This is what I get:</p>
<p>a = 0.61<br>
b = 0.38<br>
c = 0.36</p>
</div>
<p class="optional-end">
</p>
<p>We can even work out what the path labeled <span class="math inline">\(d\)</span> (the residual variance) is.<br>
First we sum up all the equations for the paths from Y to Y itself.<br>
These are:</p>
<ul>
<li><span class="math inline">\(a^2\)</span> (from Y to X1 and back)<br>
</li>
<li><span class="math inline">\(b^2\)</span> (from Y to X2 and back)<br>
</li>
<li><span class="math inline">\(acb\)</span> (from Y to X1 to X2 to Y)</li>
<li><span class="math inline">\(bca\)</span> (from Y to X2 to X1 to Y)</li>
</ul>
<p>Summing them all up and solving gives us:</p>
<p><span class="math display">\[
\begin{align}
r_{y \cdot x1, x2} &amp; = a^2 + b^2 + acb + bca\\
&amp; = 0.61^2 + 0.38^2 + 2 \times(0.61 \times 0.38 \times 0.36)\\
&amp; = 0.68 \\
\end{align}
\]</span></p>
<p>We can think of this as the portion of the correlation of Y with itself that occurs <em>via the predictors</em>. Put another way, this is the amount of variance in Y explained jointly by X1 and X2, which sounds an awful lot like an <span class="math inline">\(R^2\)</span>!<br>
The path labelled <span class="math inline">\(d\)</span> is simply all that is left in Y after taking out the variance explained by X1 and X2, meaning that the path <span class="math inline">\(d = \sqrt{1-R^2}\)</span> (i.e., the residual variance!).</p>
<p>Hooray! We’ve just worked out regression coefficients when all we had was the correlation matrix of the variables! It’s important to note that we have been using the correlation matrix, so, somewhat unsurprisingly, our estimates are <em>standardised</em> coefficients.</p>
<p>Because we have the data itself, let’s quickly find them with <code>lm()</code></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># quickly scale all the columns in the data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>egdat <span class="ot">&lt;-</span> egdat <span class="sc">%&gt;%</span> <span class="fu">mutate_all</span>(<span class="sc">~</span><span class="fu">scale</span>(.)[,<span class="dv">1</span>])</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the coefs</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x1<span class="sc">+</span>x2, egdat)) <span class="sc">%&gt;%</span> <span class="fu">round</span>(.,<span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1          x2 
       0.00        0.61        0.38 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># extract the r^2</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(y<span class="sc">~</span>x1<span class="sc">+</span>x2, egdat))<span class="sc">$</span>r.squared</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.688</code></pre>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
</section>
</section>
<section id="doing-path-analysis" class="level1">
<h1>Doing Path Analysis</h1>
<div class="rtip">
<p><strong>Introducing <code>lavaan</code></strong></p>
<p>For the remaining weeks of the course, we’re going to rely heavily on the <strong>lavaan</strong> (<strong>La</strong>tent <strong>Va</strong>riable <strong>An</strong>alysis) package. This is the main package in R for fitting path diagrams (as well as more cool models like factor analysis sructures and structural equation mdoels). There is a huge scope of what this package can do.<br>
The first thing to get to grips with is the various new operators which it allows us to use.</p>
<p>Our old multiple regression formula in R was specified as <code>y ~ x1 + x2 + x3 + ...</code>.<br>
In <strong>lavaan</strong>, we continue to fit regressions using the <code>~</code> symbol, but we can also specify the construction of latent variables using <code>=~</code> and residual variances &amp; covariances using <code>~~</code>.</p>
<table class="table">
<thead>
<tr class="header">
<th style="text-align: right;">formula type</th>
<th style="text-align: right;">operator</th>
<th style="text-align: right;">mnemonic</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">latent variable definition</td>
<td style="text-align: right;"><code>=~</code></td>
<td style="text-align: right;">“is measured by”</td>
</tr>
<tr class="even">
<td style="text-align: right;">regression</td>
<td style="text-align: right;"><code>~</code></td>
<td style="text-align: right;">“is regressed on”</td>
</tr>
<tr class="odd">
<td style="text-align: right;">(residual) (co)variance</td>
<td style="text-align: right;"><code>~~</code></td>
<td style="text-align: right;">“is correlated with”</td>
</tr>
<tr class="even">
<td style="text-align: right;">intercept</td>
<td style="text-align: right;"><code>~1</code></td>
<td style="text-align: right;">“intercept”</td>
</tr>
</tbody>
</table>
<p>(from https://lavaan.ugent.be/tutorial/syntax1.html)</p>
<p>In practice, fitting models in <strong>lavaan</strong> tends to be a little different from things like <code>lm()</code> and <code>(g)lmer()</code>.<br>
Instead of including the model formula <em>inside</em> the fit function (e.g., <code>lm(y ~ x1 + x2, data = df)</code>), we tend to do it in a step-by-step process. This is because as our models become more complex, our formulas can pretty long!</p>
<p>We write the model as a character string (e.g.&nbsp;<code>model &lt;- "y ~ x1 + x2"</code>) and then we pass that formula along with the data to the relevant <strong>lavaan</strong> function, which for our purposes will be the <code>sem()</code> function, <code>sem(model, data = mydata)</code>.</p>
</div>
<div class="optional-begin">
<span id="opt-start-3" class="fa fa-hand-o-right optional-icon clickable" onclick="toggle_visibility('opt-body-3', 'opt-start-3')"> <span class="olab">Fitting a multiple regression model with lavaan</span></span>
</div>
<div id="opt-body-3" class="optional-body" style="display: none;">
<p>You can see a multiple regression fitted with <strong>lavaan</strong> below.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>scsdat <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/scs_study.csv"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># the lm() way</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>mreg_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(dass <span class="sc">~</span> zo <span class="sc">+</span> zc <span class="sc">+</span> ze <span class="sc">+</span> za <span class="sc">+</span> zn <span class="sc">+</span> scs, scsdat)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># setting up the model</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>mreg_model <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="st">    #regression</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="st">    dass ~ zo + zc + ze + za + zn + scs</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>mreg_sem <span class="ot">&lt;-</span> <span class="fu">sem</span>(mreg_model, <span class="at">data=</span>scsdat)</span></code></pre></div>
</div>
<p>These are the coefficients from our <code>lm()</code> model:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coefficients</span>(mreg_lm)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          zo          zc          ze          za          zn 
    62.1243     -0.0307     -0.0378      0.7449      0.2029      1.5209 
        scs 
    -0.4865 </code></pre>
</div>
</div>
<p>And you can see the estimated parameters are the same for our <code>sem()</code> model!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mreg_sem)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 1 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         7

  Number of observations                           656

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  dass ~                                              
    zo               -0.031    0.242   -0.127    0.899
    zc               -0.038    0.248   -0.153    0.879
    ze                0.745    0.377    1.976    0.048
    za                0.203    0.378    0.537    0.591
    zn                1.521    0.249    6.097    0.000
    scs              -0.486    0.071   -6.893    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .dass             40.021    2.210   18.111    0.000</code></pre>
</div>
</div>
</div>
<p class="optional-end">
</p>
<section id="specifying-the-model" class="level2">
<h2 class="anchored" data-anchor-id="specifying-the-model">Specifying the model</h2>
<p>The first part of estimating a path model involves specifying the model. This means basically writing down the paths that are included in your theoretical model.</p>
<p>Let’s start by looking at the example about job satisfaction, income, autonomy and age.<br>
Recall we had this theoretical model:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/path/paths1paths.png" class="img-fluid figure-img" width="350"></p>
</figure>
</div>
</div>
</div>
<p>And now let’s suppose that we collected data on these variables:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>jobsatpath <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/jobsatpath.csv"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(jobsatpath)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<thead>
<tr class="header">
<th style="text-align: left;">jobsat</th>
<th style="text-align: left;">income</th>
<th style="text-align: left;">autonomy</th>
<th style="text-align: left;">age</th>
<th style="text-align: left;">parentincome</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">22</td>
<td style="text-align: left;">39</td>
<td style="text-align: left;">17</td>
<td style="text-align: left;">55</td>
<td style="text-align: left;">47</td>
</tr>
<tr class="even">
<td style="text-align: left;">29</td>
<td style="text-align: left;">35</td>
<td style="text-align: left;">58</td>
<td style="text-align: left;">51</td>
<td style="text-align: left;">43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">69</td>
<td style="text-align: left;">38</td>
<td style="text-align: left;">45</td>
<td style="text-align: left;">52</td>
<td style="text-align: left;">49</td>
</tr>
<tr class="even">
<td style="text-align: left;">67</td>
<td style="text-align: left;">27</td>
<td style="text-align: left;">52</td>
<td style="text-align: left;">43</td>
<td style="text-align: left;">44</td>
</tr>
<tr class="odd">
<td style="text-align: left;">54</td>
<td style="text-align: left;">14</td>
<td style="text-align: left;">36</td>
<td style="text-align: left;">35</td>
<td style="text-align: left;">40</td>
</tr>
<tr class="even">
<td style="text-align: left;">25</td>
<td style="text-align: left;">25</td>
<td style="text-align: left;">39</td>
<td style="text-align: left;">48</td>
<td style="text-align: left;">44</td>
</tr>
<tr class="odd">
<td style="text-align: left;">…</td>
<td style="text-align: left;">…</td>
<td style="text-align: left;">…</td>
<td style="text-align: left;">…</td>
<td style="text-align: left;">…</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>Remember we said that we could specify all these paths using three regression models? Well, to specify our path model, we simply write these out like we would do in <code>lm()</code>, but this time we do so all in one character string. We still have to make sure that we use the correct variable names, as when we make R estimate the model, it will look in the data for things like “jobsat”.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mymodel <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="st">jobsat ~ age + autonomy + income</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="st">income ~ autonomy + age + parentincome</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="st">autonomy ~ age</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code></pre></div>
</div>
<p>There are some other things which we will automatically be estimated here: all our exogenous variables (the ones with arrows only going <em>from</em> them) will be free to correlate with one another. We can write this explicitly in the model if we like, using the two tildes <code>~~</code> between our two exogenous variables <code>age</code> and <code>parentincome</code>. We will also get the variances of all our variables.</p>
<p>We can see all the paths here:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lavaanify</span>(mymodel)</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>            lhs op          rhs
1        jobsat  ~          age
2        jobsat  ~     autonomy
3        jobsat  ~       income
4        income  ~     autonomy
5        income  ~          age
6        income  ~ parentincome
7      autonomy  ~          age
8        jobsat ~~       jobsat
9        income ~~       income
10     autonomy ~~     autonomy
11          age ~~          age
12          age ~~ parentincome
13 parentincome ~~ parentincome</code></pre>
</div>
</div>
<p>and even make a nice diagram:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semPlot)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(<span class="fu">lavaanify</span>(mymodel))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_path_analysis_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="estimating-the-model" class="level2">
<h2 class="anchored" data-anchor-id="estimating-the-model">Estimating the model</h2>
<p>Estimating the model is relatively straightforward. We pass the formula we have written to the <code>sem()</code> function, along with the data set in which we want it to look for the variables:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mymodel.fit <span class="ot">&lt;-</span> <span class="fu">sem</span>(mymodel, <span class="at">data =</span> jobsatpath)</span></code></pre></div>
</div>
<p>We can then examine the parameter estimates:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mymodel.fit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 1 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        10

  Number of observations                            50

Model Test User Model:
                                                      
  Test statistic                                 5.050
  Degrees of freedom                                 2
  P-value (Chi-square)                           0.080

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  jobsat ~                                            
    age              -1.566    0.482   -3.250    0.001
    autonomy          0.347    0.131    2.653    0.008
    income            0.689    0.439    1.572    0.116
  income ~                                            
    autonomy          0.099    0.026    3.796    0.000
    age               0.631    0.081    7.834    0.000
    parentincome      1.036    0.128    8.099    0.000
  autonomy ~                                          
    age               0.851    0.418    2.038    0.042

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .jobsat          251.098   50.220    5.000    0.000
   .income           11.293    2.259    5.000    0.000
   .autonomy        330.771   66.154    5.000    0.000</code></pre>
</div>
</div>
<p>We can now, to “visualise” our model, add the estimates to the diagram:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/path/jobsatmod.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Model estimates</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="model-fit" class="level1">
<h1>Model Fit</h1>
<p>You’ll have heard the term “model fit” many times since the start of DAPR2, when we began model-based thinking. However, there is a crucial difference in what it means when it is used in for path analysis.</p>
<p>In things like multiple regression, we have been using “model fit” to be the measure of “how much variance can we explain in y with our set of predictors?”. For a path model, examining “model fit” is more like asking “how well does our model reproduce the characteristics of the data that we observed?”.</p>
<p>We can represent the “characteristics of our data” in a covariance matrix, so one way of thinking of “model fit” is as “how well can our model reproduce our observed covariance matrix?”.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(jobsatpath)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             jobsat income autonomy    age parentincome
jobsat       341.62   4.47    107.3 -28.81        -6.47
income         4.47  50.17     46.7  29.56        14.83
autonomy     107.30  46.68    365.6  32.94       -10.00
age          -28.81  29.56     32.9  38.69         1.81
parentincome  -6.47  14.83    -10.0   1.81        14.18</code></pre>
</div>
</div>
<section id="degrees-of-freedom" class="level2">
<h2 class="anchored" data-anchor-id="degrees-of-freedom">Degrees of freedom</h2>
<p>When we think of “degrees of freedom” for a multiple regression model, in DAPR2 we learned that <span class="math inline">\(df = n-k-1\)</span> (<span class="math inline">\(n\)</span> is the number of observations, <span class="math inline">\(k\)</span> is the number of predictors). These degrees of freedom related to the corresponding <span class="math inline">\(F\)</span> and <span class="math inline">\(t\)</span>-distributions with which we performed our hypothesis tests (e.g.&nbsp;<span class="math inline">\(t\)</span>-tests for a null hypothesis that a coefficient is zero, or <span class="math inline">\(F\)</span>-tests for a null that the reduction in residual sums of squares is zero).</p>
<p>But in relation to it’s ability to represent a <span class="math inline">\(k \times k\)</span> covariance matrix (i.e.&nbsp;the covariance matrix of our <span class="math inline">\(k\)</span> variables), the multiple regression model has <strong>zero</strong> degrees of freedom. This is because “degrees of freedom” in the this framework corresponds to the number of <em>knowns</em> (observed covariances/variances) minus the number of <em>unknowns</em> (parameters to be estimated by the model). A model is only able to be estimated if it has at least 0 degrees of freedom (if there are as many knowns as unknowns). A model with 0 degrees of freedom is termed <strong>just-identified</strong>. <strong>Under-</strong> and <strong>Over-</strong> identified models correspond to those with <span class="math inline">\(&lt;0\)</span> and <span class="math inline">\(&gt;0\)</span> degrees of freedom respectively.</p>
<p>So the multiple regression model is an example of a <em>just-identified</em> model! In multiple regression, everything is allowed to covary with everything else, which means that there is a unique solution for all of the model’s parameters because there are <em>as many paths as there are observed covariances</em>. This means that in this path analysis world, a multiple regression model is “just-identified”.</p>
<div class="optional-begin">
<span id="opt-start-4" class="fa fa-hand-o-right optional-icon clickable" onclick="toggle_visibility('opt-body-4', 'opt-start-4')"> <span class="olab">huh?</span></span>
</div>
<div id="opt-body-4" class="optional-body" style="display: none;">
<div class="cell" data-layout-align="center">

</div>
<p>If I have two predictors and one outcome variable, then there are 6 variances and covariances available. For instance:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(somedata)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         y     x1     x2
y  45.6481 0.0149 1.3525
x1  0.0149 1.0455 0.0196
x2  1.3525 0.0196 1.0000</code></pre>
</div>
</div>
<p>The multiple regression model will estimate the two variances of the exogenous variables (the predictors), their covariance, the two paths from each exogenous to the endogenous (each predictor to the outcome), and the error variance. This makes up 6 estimated parameters - which is exactly how many known covariances there are.<br>
Count the number of arrows (both single and double headed) in the diagram:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_path_analysis_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="350"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="optional-end">
</p>
<div class="statbox">
<p><strong>How many knowns are there?</strong></p>
<p>The number of known covariances in a set of <span class="math inline">\(k\)</span> observed variables is equal to <span class="math inline">\(\frac{k \cdot (k+1)}{2}\)</span>.</p>
</div>
<p>When learning about path models, the visualisations can play a key part. It often helps to draw all our variables (both observed and latent) on the whiteboard, and connect them up according to your theoretical model. You can then count the number of paths (arrows) and determine whether the <strong>number of knowns</strong> &gt; <strong>number of unknowns</strong>. We can reduce the number of unknowns by fixing parameters to be specific values.</p>
<div class="statbox">
<p>By constraining some estimated parameter to be some specific value, we free-up a degree of freedom! For instance “the correlation between x1 and x2 is equal to 0.7 (<span class="math inline">\(r_{x_1x_2} = .07\)</span>)”. This would turn a previously estimated parameter into a fixed parameter, and this gains us the prize of a lovely degree of freedom!</p>
<p><strong>By removing a path altogether, we are constraining it to be zero.</strong></p>
</div>
<p>There are too many different indices of model fit for these types of models, and there’s lots of controversy over the various merits and disadvantages and proposed cutoffs of each method. We will return to this more in coming weeks, and the lecture this week contains information on some of them. The important thing to remember: “model fit” and “degrees of freedom” have quite different meanings to those you are likely used to.</p>
</section>
</section>
<section id="exercises" class="level1">
<h1>Exercises</h1>
<div class="frame">
<p><strong>Data: Passion &amp; Burnout</strong></p>
<p>Researchers are interested in the role of obsessive and harmonious passion in psychological wellbeing. The researchers collect data from 100 participants. Participants respond on sliding scales (0-100) for five measures:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 6%">
<col style="width: 93%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">variable</th>
<th style="text-align: left;">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">worksat</td>
<td style="text-align: left;">Work Satisfaction: On a scale of 0-100, how satisfied are you with your work?</td>
</tr>
<tr class="even">
<td style="text-align: left;">hp</td>
<td style="text-align: left;">Harmonious Passion: On a scale of 0-100, how much do you feel that you freely choose to engage in work outside of working hours?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">op</td>
<td style="text-align: left;">Obsessive Passion: On a scale of 0-100, how much do you have uncontrollable urges to work outside of working hours?</td>
</tr>
<tr class="even">
<td style="text-align: left;">conflict</td>
<td style="text-align: left;">Work Conflict: On a scale of 0-100, how much conflict do you experience in your work?</td>
</tr>
<tr class="odd">
<td style="text-align: left;">burnout</td>
<td style="text-align: left;">Work Burnout: On a scale of 0-100, how close to burnout at work are you?</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The data is available at https://uoepsy.github.io/data/passionpath.csv</p>
</div>
<div class="question-begin">
Question 1
</div>
<div class="question-body">
<p>Load in the libraries we will use in these exercises:</p>
<ul>
<li>tidyverse<br>
</li>
<li>lavaan<br>
</li>
<li>semPlot</li>
</ul>
<p>Read in the data.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-5" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-5', 'sol-start-5')"> Solution </span>
</div>
<div id="sol-body-5" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lavaan)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(semPlot)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>burnout <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"../../data/passionpath.csv"</span>)</span></code></pre></div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 2
</div>
<div class="question-body">
<p>The researchers have this theoretical model:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/path/burnoutpath.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Burnout theory</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Specify this model and store the formula as an object in R</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-6" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-6', 'sol-start-6')"> Solution </span>
</div>
<div id="sol-body-6" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>burnoutmod <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="st">worksat ~ hp</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="st">burnout ~ worksat + conflict</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="st">conflict ~ op + hp</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="st">hp ~~ op</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code></pre></div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 3
</div>
<div class="question-body">
<p>Fit the model to the data using the <code>sem()</code> function.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-7" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-7', 'sol-start-7')"> Solution </span>
</div>
<div id="sol-body-7" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>burnoutfit <span class="ot">&lt;-</span> <span class="fu">sem</span>(burnoutmod, <span class="at">data=</span>burnout)</span></code></pre></div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 4
</div>
<div class="question-body">
<p>Examine the parameter estimates</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-8" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-8', 'sol-start-8')"> Solution </span>
</div>
<div id="sol-body-8" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(burnoutfit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 28 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        11

  Number of observations                           100

Model Test User Model:
                                                      
  Test statistic                                 5.458
  Degrees of freedom                                 4
  P-value (Chi-square)                           0.243

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  worksat ~                                           
    hp                0.420    0.088    4.769    0.000
  burnout ~                                           
    worksat          -0.207    0.063   -3.304    0.001
    conflict         -0.147    0.191   -0.772    0.440
  conflict ~                                          
    op                0.095    0.038    2.476    0.013
    hp               -0.010    0.033   -0.308    0.758

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  hp ~~                                               
    op               61.628   18.529    3.326    0.001

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .worksat         155.762   22.028    7.071    0.000
   .burnout          75.347   10.656    7.071    0.000
   .conflict         19.465    2.753    7.071    0.000
    hp              200.614   28.371    7.071    0.000
    op              152.210   21.526    7.071    0.000</code></pre>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 5
</div>
<div class="question-body">
<p>Produce a diagram with the estimates on the paths. Can you also produce one which has the <em>standardised</em> estimates?</p>
<p>Take a look at the help function for <code>semPaths()</code>. What do the arguments <code>what</code> and <code>whatLabels</code> do?</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-9" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-9', 'sol-start-9')"> Solution </span>
</div>
<div id="sol-body-9" class="solution-body" style="display: none;">
<p><code>what</code> will weight and colour the paths according something like the estimates. <code>whatLabels</code> will provide labels for the paths:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(burnoutfit, <span class="at">whatLabels =</span> <span class="st">"est"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_path_analysis_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>This will change them to the standardised estimates:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(burnoutfit, <span class="at">what =</span> <span class="st">"std"</span>, <span class="at">whatLabels =</span> <span class="st">"std"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="07_path_analysis_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 6
</div>
<div class="question-body">
<ul>
<li>How many variables do you have in your model?</li>
<li>How many <em>knowns</em> are there in the covariance matrix?<br>
</li>
<li>How many <em>unknowns</em> are there in your model?</li>
<li>How many degrees of freedom do you therefore have?</li>
</ul>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-10" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-10', 'sol-start-10')"> Solution </span>
</div>
<div id="sol-body-10" class="solution-body" style="display: none;">
<ul>
<li><p>How many variables do you have in your model?<br>
<strong>5</strong></p></li>
<li><p>How many <em>knowns</em> are there in the covariance matrix? <span class="math inline">\(\frac{5 \times (5 + 1)}{2} = 15\)</span></p></li>
<li><p>How many <em>unknowns</em> are there in your model?<br>
There are 6 paths in Figure @ref(fig:figburn), but we also need to consider the variances of the 5 variables, so we have 11 things being estimated</p></li>
<li><p>How many degrees of freedom do you therefore have? <strong>15 - 11 = 4</strong></p></li>
</ul>
</div>
<p class="solution-end">
</p>
<div class="statbox">
<p>For these kind of models, a chi-square value is obtained which reflects reflects the discrepancy between the <em>model-implied covariance matrix</em> and the <em>observed covariance matrix</em>. We can then calculate a p-value for this chi-square statistic by using the chi-square distribution with the degrees of freedom equivalent to that of the model.</p>
<p>If we denote the sample covariance matrix as <span class="math inline">\(S\)</span> and the model-implied covariance matrix as <span class="math inline">\(\Sigma(\theta)\)</span>, then we can think of the null hypothesis here as <span class="math inline">\(H_0: S - \Sigma(\hat\theta) = 0\)</span>. <strong>In this way our null hypothesis is sort of like saying that our theoretical model is correct</strong> (and can therefore perfectly reproduce the covariance matrix).</p>
</div>
<div class="question-begin">
Question 7
</div>
<div class="question-body">
<p>Take a look at the summary of the model you fitted. Specifically, examine the bit near the top where it mentions the <span class="math inline">\(\chi^2\)</span> statistic.<br>
Is it significant? What do we conclude?</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-11" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-11', 'sol-start-11')"> Solution </span>
</div>
<div id="sol-body-11" class="solution-body" style="display: none;">
<p>The <span class="math inline">\(\chi^2\)</span> statistic is not significant:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pchisq</span>(<span class="fl">5.458</span>, <span class="at">df=</span><span class="dv">4</span>, <span class="at">lower.tail=</span>F)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.243</code></pre>
</div>
</div>
<p>We therefore have no evidence to support rejecting our null hypothesis that our model provides a reasonable fit to the data.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 8
</div>
<div class="question-body">
<p>Try examing what the other fit measures (RMSEA, SRMR, CLI, TLI: How do they compare with <a href="https://uoepsy.github.io/dapr3/lectures/week1_pathintro.html#37">the cutoffs provided in the lecture?</a></p>
<p>hint: <code>summary(modelfit, fit.measures = TRUE)</code></p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-12" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-12', 'sol-start-12')"> Solution </span>
</div>
<div id="sol-body-12" class="solution-body" style="display: none;">
<p>The fit statistics for our model:</p>
<p>Comparative Fit Index (CFI) = 0.968 Tucker-Lewis Index (TLI) = 0.921 RMSEA = 0.060 SRMR = 0.063</p>
<p>Only CFI meets the criteria given in the lecture slides for “considered good”.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(burnoutfit, <span class="at">fit.measures =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 28 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        11

  Number of observations                           100

Model Test User Model:
                                                      
  Test statistic                                 5.458
  Degrees of freedom                                 4
  P-value (Chi-square)                           0.243

Model Test Baseline Model:

  Test statistic                                56.068
  Degrees of freedom                                10
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    0.968
  Tucker-Lewis Index (TLI)                       0.921

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)              -1836.113
  Loglikelihood unrestricted model (H1)      -1833.384
                                                      
  Akaike (AIC)                                3694.226
  Bayesian (BIC)                              3722.883
  Sample-size adjusted Bayesian (BIC)         3688.142

Root Mean Square Error of Approximation:

  RMSEA                                          0.060
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.172
  P-value RMSEA &lt;= 0.05                          0.361

Standardized Root Mean Square Residual:

  SRMR                                           0.063

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  worksat ~                                           
    hp                0.420    0.088    4.769    0.000
  burnout ~                                           
    worksat          -0.207    0.063   -3.304    0.001
    conflict         -0.147    0.191   -0.772    0.440
  conflict ~                                          
    op                0.095    0.038    2.476    0.013
    hp               -0.010    0.033   -0.308    0.758

Covariances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  hp ~~                                               
    op               61.628   18.529    3.326    0.001

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .worksat         155.762   22.028    7.071    0.000
   .burnout          75.347   10.656    7.071    0.000
   .conflict         19.465    2.753    7.071    0.000
    hp              200.614   28.371    7.071    0.000
    op              152.210   21.526    7.071    0.000</code></pre>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question Extra: modification indices
</div>
<div class="question-body">
<p>Examine the modification indices of the model (use the <code>modindices()</code> function).<br>
Pay close attention to the <code>mi</code> column (this is the “modification index”, which is the change in the <span class="math inline">\(\chi^2\)</span> statistic). The other interesting column is going to be the <code>sepc.all</code> column, which is the estimated parameter value of the proposed path, in a model where all the variables are standardised. This means we can evaluate whether the estimated parameter is relatively small/moderate/large, because these are all standardised correlations between -1 and 1!</p>
<p>Are there any paths which the modification indices suggest might improve the model? Do they make theoretical sense to include them?</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-13" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-13', 'sol-start-13')"> Solution </span>
</div>
<div id="sol-body-13" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">modindices</span>(burnoutfit)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        lhs op      rhs    mi     epc sepc.lv sepc.all sepc.nox
12  worksat ~~  burnout 0.268 -13.039 -13.039   -0.120   -0.120
13  worksat ~~ conflict 0.842  -5.053  -5.053   -0.092   -0.092
14  worksat ~~       hp 1.102  49.226  49.226    0.278    0.278
15  worksat ~~       op 1.102 -15.122 -15.122   -0.098   -0.098
16  burnout ~~ conflict 3.461 -28.991 -28.991   -0.757   -0.757
17  burnout ~~       hp 0.036  -2.403  -2.403   -0.020   -0.020
18  burnout ~~       op 3.185  18.424  18.424    0.172    0.172
21  worksat  ~  burnout 0.095  -0.101  -0.101   -0.067   -0.067
22  worksat  ~ conflict 1.306  -0.314  -0.314   -0.103   -0.103
23  worksat  ~       op 1.102  -0.113  -0.113   -0.101   -0.101
24  burnout  ~       hp 0.268   0.035   0.035    0.054    0.054
25  burnout  ~       op 3.471   0.137   0.137    0.184    0.184
26 conflict  ~  worksat 0.842  -0.032  -0.032   -0.099   -0.099
27 conflict  ~  burnout 0.225  -0.062  -0.062   -0.126   -0.126
28       hp  ~  worksat 1.102   0.316   0.316    0.309    0.309
29       hp  ~  burnout 0.096  -0.051  -0.051   -0.033   -0.033
32       op  ~  worksat 1.102  -0.097  -0.097   -0.109   -0.109
33       op  ~  burnout 4.058   0.264   0.264    0.196    0.196</code></pre>
</div>
</div>
<p>There seems to be a suggested reasonably large correlation between <code>burnout</code> and <code>conflict</code>. If we were to fit this model, our fit indices may well improve and meet our cut-offs. But this may well just be overfitting.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>burnoutmod2 <span class="ot">&lt;-</span> <span class="st">"</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="st">worksat ~ hp</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="st">burnout ~ worksat + conflict</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="st">conflict ~ op + hp</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a><span class="st">hp ~~ op</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="st">burnout ~~ conflict</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sem</span>(burnoutmod2, <span class="at">data=</span>burnout)</span></code></pre></div>
</div>
<p>We will not start adjusting models based on modification indices today (or indeed in this course at all). <strong>As a general rule for dapR3 course, we want you to specify and test a specific model, and not seek to use exploratory modifications.</strong></p>
</div>
<p class="solution-end">
</p>
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;">

</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>