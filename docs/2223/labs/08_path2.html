<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DAPR3 - Path Mediation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-hand-o-right')) {
    f.classList.add('fa-hand-o-left')
    f.classList.remove('fa-hand-o-right')
} else {
    f.classList.add('fa-hand-o-right')
    f.classList.remove('fa-hand-o-left')
}
}
</script>

<script src="https://kit.fontawesome.com/120b08a6f5.js" crossorigin="anonymous"></script>
<link href="site_libs/panelset-0.2.6/panelset.css" rel="stylesheet">
<script src="site_libs/panelset-0.2.6/panelset.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">DAPR3</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-multi-level-models" role="button" data-bs-toggle="dropdown" aria-expanded="false">Multi Level Models</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-multi-level-models">    
        <li>
    <a class="dropdown-item" href="./01_regressionrefresh.html">
 <span class="dropdown-text">1: Linear Regression | Clustered Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02_intromlm.html">
 <span class="dropdown-text">2: Multilevel Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./03_assumptranef.html">
 <span class="dropdown-text">3: Assumptions, Diagnostics &amp; Random Effect Structures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./04_centerglmer.html">
 <span class="dropdown-text">4: Centering in MLM | Logistic</span></a>
  </li>  
        <li class="dropdown-header">5: Recap</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-dimension-reduction--sem" role="button" data-bs-toggle="dropdown" aria-expanded="false">Dimension reduction &amp; SEM</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-dimension-reduction--sem">    
        <li>
    <a class="dropdown-item" href="./07_path_analysis.html">
 <span class="dropdown-text">7: Path Analysis</span></a>
  </li>  
        <li class="dropdown-header">8: Path Mediation</li>
        <li class="dropdown-header">9: Dimension Reduction</li>
        <li class="dropdown-header">10: EFA: Part 1</li>
        <li class="dropdown-header">11: EFA: Part 2</li>
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-example-analyses" role="button" data-bs-toggle="dropdown" aria-expanded="false">Example Analyses</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-example-analyses">    
        <li>
    <a class="dropdown-item" href="./example_01_repeated_measures.html">
 <span class="dropdown-text">Example: Repeated Measures MLM</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./example_02_intervention.html">
 <span class="dropdown-text">Example: Intervention Study</span></a>
  </li>  
        <li class="dropdown-header">Example: Many Trials</li>
        <li>
    <a class="dropdown-item" href="./example_00_anova.html">
 <span class="dropdown-text">Example: ANOVA (rpt measures &amp; mixed)</span></a>
  </li>  
        <li class="dropdown-header">Example: Exploratory Factor Analysis</li>
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-explainer-docs" role="button" data-bs-toggle="dropdown" aria-expanded="false">Explainer Docs</a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-explainer-docs">    
        <li class="dropdown-header">Likelihood vs Probability</li>
        <li class="dropdown-header">Writing 3-level MLM equations</li>
        <li class="dropdown-header">PCA and Unequal Variances</li>
    </ul>
  </li>
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#mediating-variables" id="toc-mediating-variables" class="nav-link active" data-scroll-target="#mediating-variables">Mediating variables</a></li>
  <li><a href="#path-mediation" id="toc-path-mediation" class="nav-link" data-scroll-target="#path-mediation">Path Mediation</a>
  <ul class="collapse">
  <li><a href="#estimating-the-model" id="toc-estimating-the-model" class="nav-link" data-scroll-target="#estimating-the-model">Estimating the model</a></li>
  </ul></li>
  <li><a href="#exercises" id="toc-exercises" class="nav-link" data-scroll-target="#exercises">Exercises</a>
  <ul class="collapse">
  <li><a href="#a-more-complex-model" id="toc-a-more-complex-model" class="nav-link" data-scroll-target="#a-more-complex-model">A more complex model</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Path Mediation</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<div class="lo">
<p><strong>Relevant packages</strong></p>
<ul>
<li>lavaan<br>
</li>
<li>semPlot or tidySEM</li>
<li>mediation</li>
</ul>
</div>
<section id="mediating-variables" class="level1">
<h1>Mediating variables</h1>
<p>Let’s imagine we are interested in peoples’ intention to get vaccinated, and we observe the following variables:</p>
<ul>
<li>Intention to vaccinate (scored on a range of 0-100)<br>
</li>
<li>Health Locus of Control (HLC) score (average score on a set of items relating to perceived control over ones own health)<br>
</li>
<li>Religiosity (average score on a set of items relating to an individual’s religiosity).</li>
</ul>
<!-- We are assuming here that we do not have the individual items, but only the scale scores (if we had the individual items we might be inclined to model religiosity and HLC as latent variables!).    -->
<p>If we draw out our variables, and think about this in the form of a standard regression model with “Intention to vaccinate” as our outcome variable, then all the lines are filled in for us (see <a href="#fig-mregpath">Figure&nbsp;1</a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-mregpath" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/path/path1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<p></p><figcaption class="figure-caption">Figure 1: Multiple regression as a path model</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>But what if our theory suggests that some other model might be of more relevance? For instance, what if we believe that participants’ religiosity has an effect on their Health Locus of Control score, <strong><em>which in turn</em></strong> affects the intention to vaccinate (see <a href="#fig-medpath1">Figure&nbsp;2</a>)?</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-medpath1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/path/path2.png" style="width:80.0%" height="300" class="figure-img"></p>
<p></p><figcaption class="figure-caption">Figure 2: Mediation as a path model (If you’re interested, you can find the inspiration for this data from the paper <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7596314/">here</a>. I haven’t properly read it though!)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In this case, the HLC variable is thought of as a <strong>mediator</strong>, because it mediates the effect of religiosity on intention to vaccinate. In this theoretical model, we distinguishing between two possible types of effect: <strong>direct</strong> and <strong>indirect</strong>.</p>
<div class="statbox">
<p><strong>Direct vs Indirect</strong></p>
<p>In path diagrams:</p>
<ul>
<li>Direct effect = one single-headed arrow between the two variables concerned<br>
</li>
<li>Indirect effect = An effect transmitted via some other variables</li>
</ul>
</div>
</section>
<section id="path-mediation" class="level1">
<h1>Path Mediation</h1>
<p>We’ve seen how path analysis works in last week’s lab, and we can use that same logic to investigate models which have quite different structures such as those including mediating variables.</p>
<p>Because we have multiple <strong>endogenous</strong> variables here, then we’re immediately drawn to path analysis, because we’re in essence thinking of conducting several regression models. As we can’t fit our theoretical model into a nice straightforward regression model (we would need several), then we can use path analysis instead, and just smush lots of regressions together, allowing us to estimate things all at once.</p>
<p>So let’s look at fitting our mediation model.</p>
<div class="frame">
<p><strong>Data: VaxDat.csv</strong></p>
<p>100 parents were recruited and completed a survey that included measures of Health Locus of Control, Religiosity, and a sliding scale of 0 to 100 on how definite they were that their child would receive the vaccination for measles, mumps &amp; rubella.</p>
<ul>
<li>Intention to vaccinate (scored on a range of 0-100)<br>
</li>
<li>Health Locus of Control (HLC) score (average on a set of 5 items - each scoring 0 to 6 - relating to perceived control over ones own health)<br>
</li>
<li>Religiosity (average on a set of 5 items - each scoring 0 to 6 - relating to an individual’s religiosity).</li>
</ul>
<p>The data is available at https://uoepsy.github.io/data/vaxdat.csv</p>
</div>
<p>First we read in our data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>vax <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/vaxdat.csv"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vax)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  religiosity        hlc         intention   
 Min.   :-1.0   Min.   :0.40   Min.   :39.0  
 1st Qu.: 1.8   1st Qu.:2.00   1st Qu.:59.0  
 Median : 2.4   Median :3.00   Median :64.0  
 Mean   : 2.4   Mean   :2.99   Mean   :65.1  
 3rd Qu.: 3.0   3rd Qu.:3.60   3rd Qu.:74.0  
 Max.   : 4.6   Max.   :5.80   Max.   :88.0  </code></pre>
</div>
</div>
<p>It looks like we have a value we shouldn’t have there. We have a value of religiosity of -1. But the average of 5 items which each score 0 to 6 will have to fall within those bounds.</p>
<p>Let’s replace any values &lt;0 with NA.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>vax <span class="ot">&lt;-</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    vax <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">religiosity =</span> <span class="fu">ifelse</span>(religiosity <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="cn">NA</span>, religiosity))</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vax)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  religiosity        hlc         intention   
 Min.   :0.20   Min.   :0.40   Min.   :39.0  
 1st Qu.:1.80   1st Qu.:2.00   1st Qu.:59.0  
 Median :2.40   Median :3.00   Median :64.0  
 Mean   :2.43   Mean   :2.99   Mean   :65.1  
 3rd Qu.:3.00   3rd Qu.:3.60   3rd Qu.:74.0  
 Max.   :4.60   Max.   :5.80   Max.   :88.0  
 NA's   :1                                   </code></pre>
</div>
</div>
<p>Now let’s just check the marginal distributions of each variable.<br>
There are lots of functions that we might use, but for a quick eyeball, I quite like the <code>pairs.panels()</code> and <code>multi.hist()</code> functions from the <strong>psych</strong> package.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(vax)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="08_path2_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>Okay, we’re ready to start thinking about our model.<br>
First we specify the relevant paths:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>med_model <span class="ot">&lt;-</span> <span class="st">" </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="st">    intention ~ religiosity</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="st">    intention ~ hlc</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="st">    hlc ~ religiosity</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code></pre></div>
</div>
<p>If we fit this model as it is, we won’t actually be testing the indirect effect, we will simply be fitting a couple of regressions.</p>
<p>To specifically test the indirect effect, we need to explicitly define the indirect effect in our model, by first creating a label for each of its sub-component paths, and then defining the indirect effect itself as the product of these two paths (why the product? <a href="https://uoepsy.github.io/msmr/indirect_effects.pdf">Click here for a lovely explanation from Aja Murray</a>).</p>
<p>To do this, we use a new operator, <code>:=</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>med_model <span class="ot">&lt;-</span> <span class="st">" </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="st">    intention ~ religiosity</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="st">    intention ~ a*hlc</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="st">    hlc ~ b*religiosity</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="st">    indirect:=a*b</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code></pre></div>
</div>
<div class="rtip">
<p><strong>:=</strong></p>
<p><em>This operator ‘defines’ new parameters which take on values that are an arbitrary function of the original model parameters. The function, however, must be specified in terms of the parameter labels that are explicitly mentioned in the model syntax.</em></p>
<p>(<a href="https://lavaan.ugent.be/">the lavaan project</a>)</p>
<p>Note. The labels we use are completely up to us. This would be equivalent:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>med_model <span class="ot">&lt;-</span> <span class="st">" </span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="st">    intention ~ religiosity</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="st">    intention ~ peppapig * hlc</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="st">    hlc ~ kermit * religiosity</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="st">    indirect:= kermit * peppapig</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="st">"</span></span></code></pre></div>
</div>
</div>
<section id="estimating-the-model" class="level2">
<h2 class="anchored" data-anchor-id="estimating-the-model">Estimating the model</h2>
<p>It is common to estimate the indirect effect using a bootstrapping approach (remember, bootstrapping involves resampling the data with replacement, thousands of times, in order to empirically generate a sampling distribution).</p>
<div class="statbox">
<p><strong>Why do we bootstrap mediation analysis?</strong></p>
<p>We compute our indirect effect as the <em>product</em> of the sub-component paths. However, this results in the estimated indirect effect rarely following a normal distribution, and makes our usual analytically derived standard errors &amp; p-values inappropriate.<br>
Instead, bootstrapping has become the norm for assessing sampling distributions of indirect effects in mediation models.</p>
</div>
<p>We can do this easily in lavaan:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mm1.est <span class="ot">&lt;-</span> <span class="fu">sem</span>(med_model, <span class="at">data=</span>vax, <span class="at">se =</span> <span class="st">"bootstrap"</span>) </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mm1.est, <span class="at">ci =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 1 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

                                                  Used       Total
  Number of observations                            99         100

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                            Bootstrap
  Number of requested bootstrap draws             1000
  Number of successful bootstrap draws            1000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
  intention ~                                                           
    religiosty        0.616    1.066    0.578    0.563   -1.558    2.658
    hlc        (a)    5.823    0.946    6.157    0.000    3.919    7.607
  hlc ~                                                                 
    religiosty (b)    0.557    0.084    6.614    0.000    0.384    0.718

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
   .intention        62.112    7.845    7.917    0.000   45.177   76.596
   .hlc               0.741    0.106    6.959    0.000    0.537    0.940

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
    indirect          3.243    0.715    4.536    0.000    1.893    4.815</code></pre>
</div>
</div>
<div class="int">
<p>We can see that the 95% bootstrapped confidence interval for the indirect effect of religiosity on intention to vaccinate does not include zero. We can conclude that the indirect effect is significant at <span class="math inline">\(p &lt;.05\)</span>. The direct effect is <strong>not</strong> significantly different from zero, suggesting that we have <strong>complete mediation</strong> (religiosity has <em>no</em> effect on intention to vaccinate after controlling for health locus of control).</p>
</div>
<div class="statbox">
<p><strong>Partial/Complete Mediation</strong></p>
<p>If we have a variable <span class="math inline">\(X\)</span> that we take to cause variable <span class="math inline">\(Y\)</span>, then our path diagram will look like so:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/path/MED1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>In this diagram, path <span class="math inline">\(c\)</span> is the <strong>total effect</strong>. This is the <em>unmediated</em> effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span>.<br>
However, while the effect of <span class="math inline">\(X\)</span> on <span class="math inline">\(Y\)</span> could in part be explained by the process of being mediated by some variable <span class="math inline">\(M\)</span>, the variable <span class="math inline">\(X\)</span> could still affect <span class="math inline">\(Y\)</span> directly.<br>
Our mediating model is shown below:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/path/MED2.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>In this case, path <span class="math inline">\(c'\)</span> is the <strong>direct effect</strong>.<br>
<strong>Complete mediation</strong> is when <span class="math inline">\(X\)</span> <em>no longer</em> affects <span class="math inline">\(Y\)</span> after <span class="math inline">\(M\)</span> has been controlled (so path <span class="math inline">\(c'\)</span> is not significantly different from zero). <strong>Partial mediation</strong> is when the path from <span class="math inline">\(X\)</span> to <span class="math inline">\(Y\)</span> is <em>reduced in magnitude</em> when the mediator <span class="math inline">\(M\)</span> is introduced, <em>but still different from zero.</em></p>
</div>
<p>Finally, we can visualise the estimates for our model using the <code>semPaths()</code> function from the <strong>semPlot</strong> package, and also with the <code>graph_sem()</code> function from the <strong>tidySEM</strong> package.<br>
<em>Often, if we want to include a path diagram in a report then the output of these functions would not usually meet publication standards, and instead we tend to draw them in programs like powerpoint!)</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidySEM)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">graph_sem</span>(mm1.est, <span class="at">layout =</span> <span class="fu">get_layout</span>(mm1.est))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="08_path2_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="exercises" class="level1">
<h1>Exercises</h1>
<p>This week’s lab focuses on the technique of path analysis using data on conduct problems in adolescence.</p>
<div class="frame">
<p><strong>Data: conduct problems</strong></p>
<p>A researcher has collected data on n=557 adolescents and would like to know whether there are associations between conduct problems (both aggressive and non-aggressive) and academic performance and whether the relations are mediated by the quality of relationships with teachers.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">

<table>
 <thead>
  <tr>
   <th style="text-align:left;"> variable </th>
   <th style="text-align:left;"> description </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> ID </td>
   <td style="text-align:left;"> Participant ID </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Acad </td>
   <td style="text-align:left;"> Academic performance (standardised) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Teach_r </td>
   <td style="text-align:left;"> Teacher Relationship Quality (standardised) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Non_agg </td>
   <td style="text-align:left;"> Non-aggressive conduct problems (standardised) </td>
  </tr>
  <tr>
   <td style="text-align:left;"> Agg </td>
   <td style="text-align:left;"> Aggressive conduct problems (standardised) </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>The data is available at https://uoepsy.github.io/data/cp_teachacad.csv</p>
</div>
<div class="question-begin">
Question A1
</div>
<div class="question-body">
<p>First, read in the dataset from https://uoepsy.github.io/data/cp_teachacad.csv</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-1" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-1', 'sol-start-1')"> Solution </span>
</div>
<div id="sol-body-1" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>cp_teach<span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/cp_teachacad.csv"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(cp_teach)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID           Acad           Teach_r         Non_agg           Agg       
 Min.   :  1   Min.   :-3.042   Min.   :-3.68   Min.   :-3.28   Min.   :-3.27  
 1st Qu.:140   1st Qu.:-0.736   1st Qu.:-0.89   1st Qu.:-0.69   1st Qu.:-0.73  
 Median :279   Median :-0.026   Median : 0.01   Median :-0.09   Median :-0.02  
 Mean   :279   Mean   :-0.061   Mean   :-0.09   Mean   :-0.06   Mean   :-0.02  
 3rd Qu.:418   3rd Qu.: 0.606   3rd Qu.: 0.62   3rd Qu.: 0.57   3rd Qu.: 0.68  
 Max.   :557   Max.   : 3.057   Max.   : 3.52   Max.   : 3.44   Max.   : 3.31  </code></pre>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question A2
</div>
<div class="question-body">
<p>Use the <code>sem()</code> function in lavaan to specify and estimate a straightforward linear regression model to test whether aggressive and non-aggressive conduct problems significantly predict academic performance.</p>
<p>How do your results compare to those you obtain using the <code>lm()</code> function?</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-2" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-2', 'sol-start-2')"> Solution </span>
</div>
<div id="sol-body-2" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># we can fit the model in lavaan as follows:</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co"># first we specify the model using lavaan syntax</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>sr_lavaan<span class="ot">&lt;-</span><span class="st">'Acad~Non_agg+Agg'</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># next we can estimate the model using the sem() function</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>sr_lavaan.est<span class="ot">&lt;-</span><span class="fu">sem</span>(sr_lavaan, <span class="at">data=</span>cp_teach)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># we can inspect the results using the summary() function</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sr_lavaan.est)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 1 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         3

  Number of observations                           557

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
  Acad ~                                              
    Non_agg           0.182    0.057    3.178    0.001
    Agg               0.318    0.057    5.599    0.000

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)
   .Acad              0.943    0.057   16.688    0.000</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the same model can be fit using lm():</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>sr_lm<span class="ot">&lt;-</span><span class="fu">lm</span>(Acad<span class="sc">~</span>Non_agg<span class="sc">+</span>Agg, <span class="at">data=</span>cp_teach)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(sr_lm)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Acad ~ Non_agg + Agg, data = cp_teach)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.8962 -0.5957  0.0073  0.6219  3.1325 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -0.0420     0.0414   -1.02   0.3097    
Non_agg       0.1824     0.0576    3.17   0.0016 ** 
Agg           0.3181     0.0570    5.58  3.7e-08 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.974 on 554 degrees of freedom
Multiple R-squared:  0.194, Adjusted R-squared:  0.191 
F-statistic: 66.5 on 2 and 554 DF,  p-value: &lt;2e-16</code></pre>
</div>
</div>
<p>We can see that both non-aggressive and aggressive conduct problems significantly predict academic perfofmance. We can also see that we get the same results when we use the <code>sem()</code> function as we do when we use the <code>lm()</code> function. Lavaan will give essentially the same results as <code>lm()</code> for simple and multiple regression problems. However, if we have multiple outcome variables in our model it is advantageous to do this using path mediation model with lavaan. This allows us to include all the regressions in a single model.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question A3
</div>
<div class="question-body">
<p>Now specify a model in which non-aggressive conduct problems have both a direct and indirect effect (via teacher relationships) on academic performance</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-3" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-3', 'sol-start-3')"> Solution </span>
</div>
<div id="sol-body-3" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>model1<span class="ot">&lt;-</span><span class="st">'</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="st">    #we regress academic performance on non-aggressive conduct problems (the direct effect)</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="st">    Acad~Non_agg</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="st">    #we regress academic peformance on teacher relationship quality</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a><span class="st">    Acad~Teach_r</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="st">    #we regress teacher relationship quality on non-aggressive conduct problems</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="st">    Teach_r~Non_agg </span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span></code></pre></div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question A4
</div>
<div class="question-body">
<p>Make sure in your model you <em>define</em> (using the <code>:=</code> operator) the indirect effect in order to test the hypothesis that non-aggressive conduct problems have both a direct and an indirect effect (via teacher relationships) on academic performance.</p>
<p>Fit the model and examine the 95% CI.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-4" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-4', 'sol-start-4')"> Solution </span>
</div>
<div id="sol-body-4" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co">#model specification</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>model1<span class="ot">&lt;-</span><span class="st">'</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="st">    Acad~Non_agg</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="st">    #we label the two parameters that comprise the indirect effect b and c</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="st">    Acad~b*Teach_r    </span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="st">    Teach_r~c*Non_agg  </span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="st">    # the indirect effect is the product of b and c. We create a new parameter (ind) to estimate the indirect effect</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="st">    ind:=b*c   </span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#model estimation</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>model1.est<span class="ot">&lt;-</span><span class="fu">sem</span>(model1, <span class="at">data=</span>cp_teach, <span class="at">se=</span><span class="st">'bootstrap'</span>) </span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co"># we request bootstrapped standard errors to assess the signifance of the indirect effect</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1.est, <span class="at">ci=</span>T)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 1 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                           557

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                            Bootstrap
  Number of requested bootstrap draws             1000
  Number of successful bootstrap draws            1000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
  Acad ~                                                                
    Non_agg           0.158    0.057    2.771    0.006    0.043    0.270
    Teach_r    (b)    0.328    0.049    6.747    0.000    0.235    0.425
  Teach_r ~                                                             
    Non_agg    (c)    0.769    0.032   24.113    0.000    0.706    0.830

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
   .Acad              0.919    0.057   16.168    0.000    0.811    1.030
   .Teach_r           0.713    0.044   16.373    0.000    0.631    0.801

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
    ind               0.252    0.039    6.545    0.000    0.180    0.326</code></pre>
</div>
</div>
<p>We can see that the 95% bootstrapped confidence interval for the indirect effect of non-aggressive conduct problems on academic performance (‘ind’) does not include zero. We can conclude that the indirect effect is significant at <span class="math inline">\(p &lt;.05\)</span>. The direct effect is also statistically significant at <span class="math inline">\(p &lt; .05\)</span>.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question A5
</div>
<div class="question-body">
<p>Specify a new parameter which is the total (direct+indirect) effect of non-aggressive conduct problems on academic performance.</p>
<p>Hint: we should have already got labels in our model for the constituent effects, so we can just use <code>:=</code> to create a sum of them.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-5" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-5', 'sol-start-5')"> Solution </span>
</div>
<div id="sol-body-5" class="solution-body" style="display: none;">
<p>We can create a new parameter that is the sum of the direct and indirect effect to evaluate the total effect of non-aggressive conduct problems on academic performance.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co">#model specification</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>model1<span class="ot">&lt;-</span><span class="st">'</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="st">    # we now also label the indirect effect of non-aggressive conduct problems on academic performance</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="st">    Acad~a*Non_agg    </span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a><span class="st">    Acad~b*Teach_r    </span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="st">    Teach_r~c*Non_agg  </span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="st">    ind:=b*c   </span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="st">    #the total effect is the indirect effect plus the direct effect</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="st">    total:=b*c+a</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">#model estimation</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>model1.est<span class="ot">&lt;-</span><span class="fu">sem</span>(model1, <span class="at">data=</span>cp_teach,<span class="at">se=</span><span class="st">'bootstrap'</span>) </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co"># we request bootstrapped standard errors to assess the signifance of the indirect effect</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model1.est, <span class="at">ci=</span>T)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 1 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         5

  Number of observations                           557

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                            Bootstrap
  Number of requested bootstrap draws             1000
  Number of successful bootstrap draws            1000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
  Acad ~                                                                
    Non_agg    (a)    0.158    0.058    2.725    0.006    0.046    0.277
    Teach_r    (b)    0.328    0.050    6.626    0.000    0.232    0.424
  Teach_r ~                                                             
    Non_agg    (c)    0.769    0.034   22.485    0.000    0.703    0.840

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
   .Acad              0.919    0.057   16.091    0.000    0.799    1.024
   .Teach_r           0.713    0.043   16.697    0.000    0.632    0.800

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
    ind               0.252    0.039    6.460    0.000    0.179    0.329
    total             0.410    0.043    9.470    0.000    0.324    0.496</code></pre>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question A6
</div>
<div class="question-body">
<p>Now visualise the estimated model and its parameters using either the <code>semPaths()</code> function from the <strong>semPlot</strong> package, or the <code>graph_sem()</code> function from the <strong>tidySEM</strong> package.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-6" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-6', 'sol-start-6')"> Solution </span>
</div>
<div id="sol-body-6" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#to include the parameter estimates we set what='est'</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">semPaths</span>(model1.est, <span class="at">what =</span> <span class="st">"est"</span>) </span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="08_path2_files/figure-html/visualise%20the%20model-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">graph_sem</span>(model1.est, <span class="at">layout =</span> <span class="fu">get_layout</span>(model1.est))</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="08_path2_files/figure-html/visualise%20the%20model2-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
<section id="a-more-complex-model" class="level2">
<h2 class="anchored" data-anchor-id="a-more-complex-model">A more complex model</h2>
<div class="question-begin">
Question B1
</div>
<div class="question-body">
<p>Now specify a model in which <strong>both</strong> aggressive and non-aggressive conduct problems have both direct and indirect effects (via teacher relationships) on academic performance. Include the parameters for the indirect effects.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-7" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-7', 'sol-start-7')"> Solution </span>
</div>
<div id="sol-body-7" class="solution-body" style="display: none;">
<p>We now have two predictors, one mediator and one outcome (and two indirect effects, one for each predictor). We can represent this in two lines: one where we specify academic performance as the outcome variable and one where we specify teacher relationships (the mediator) as the outcome variable.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>model2<span class="ot">&lt;-</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>   <span class="st">'Acad~Agg+Non_agg+b*Teach_r</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="st">    Teach_r~c1*Agg+c2*Non_agg</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="st">   </span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="st">    ind1:=b*c1 #indirect effect for aggressive conduct problems</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="st">    ind2:=b*c2 #indirect effect for non-aggressive conduct problems</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="st">'</span></span></code></pre></div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question B2
</div>
<div class="question-body">
<p>Now estimate the model and test the significance of the indirect effects</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-8" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-8', 'sol-start-8')"> Solution </span>
</div>
<div id="sol-body-8" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>model2.est<span class="ot">&lt;-</span><span class="fu">sem</span>(model2,  <span class="at">data=</span>cp_teach,<span class="at">se=</span><span class="st">'bootstrap'</span>) </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model2.est, <span class="at">ci=</span>T)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>lavaan 0.6-12 ended normally after 1 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                         7

  Number of observations                           557

Model Test User Model:
                                                      
  Test statistic                                 0.000
  Degrees of freedom                                 0

Parameter Estimates:

  Standard errors                            Bootstrap
  Number of requested bootstrap draws             1000
  Number of successful bootstrap draws            1000

Regressions:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
  Acad ~                                                                
    Agg               0.171    0.060    2.872    0.004    0.053    0.289
    Non_agg           0.091    0.060    1.511    0.131   -0.032    0.206
    Teach_r    (b)    0.256    0.053    4.823    0.000    0.155    0.362
  Teach_r ~                                                             
    Agg       (c1)    0.574    0.044   13.129    0.000    0.485    0.665
    Non_agg   (c2)    0.358    0.040    8.843    0.000    0.276    0.439

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
   .Acad              0.908    0.057   16.001    0.000    0.789    1.016
   .Teach_r           0.540    0.031   17.334    0.000    0.476    0.598

Defined Parameters:
                   Estimate  Std.Err  z-value  P(&gt;|z|) ci.lower ci.upper
    ind1              0.147    0.033    4.502    0.000    0.087    0.216
    ind2              0.092    0.021    4.303    0.000    0.052    0.135</code></pre>
</div>
</div>
<p>We can see that the 95% confidence intervals for both indirect effects do not include zero, therefore, we can conclude that they are significant at <span class="math inline">\(p &lt; .05\)</span>.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question B3
</div>
<div class="question-body">
<p>Write a brief paragraph reporting on the results of the model estimates in Question B2. Include a figure or table to display the parameter estimates.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<span id="sol-start-9" class="fa fa-hand-o-right solution-icon clickable" onclick="toggle_visibility('sol-body-9', 'sol-start-9')"> Solution </span>
</div>
<div id="sol-body-9" class="solution-body" style="display: none;">
<div class="int">
<p>A path mediation model was used to test the direct and indirect effects (via teacher relationship quality) of aggressive and non-aggressive conduct problems on academic performance. In the model, academic performance was regressed on teacher relationship quality, non-aggressive conduct problems and aggressive conduct problems while teacher relationship quality (the mediator) was regressed on aggressive and non-aggressive conduct problems. The indirect effects were tested using the product of the coefficient for the regression of outcome on mediator and the coefficient for the regression of mediator on predictor. The statistical significance of the indirect effects were evaluated using boostrapped 95% confidence intervals with 1000 draws.</p>
<p>Unstandardised parameter estimates are provided in <a href="#fig-pathcp">Figure&nbsp;3</a>. Solid lines indicate that a parameter is significant at <span class="math inline">\(p &lt;. 05\)</span>, while dashed lines represent non-significant paths.The indirect effects of both non-aggressive (<span class="math inline">\(b = 0.09\)</span>, 95% CI=0.05-0.14) and aggressive (<span class="math inline">\(b = 0.15\)</span>, 95% CI=0.08-0.22) conduct problems on academic performance were statistcally significant.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pathcp" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/path/pathanaly.png" class="img-fluid figure-img" width="1200"></p>
<p></p><figcaption class="figure-caption">Figure 3: Effect of conduct problems on academic performance mediated by quality of teacher relationship.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="optional-begin">
<span id="opt-start-10" class="fa fa-hand-o-right optional-icon clickable" onclick="toggle_visibility('opt-body-10', 'opt-start-10')"> <span class="olab">Optional: Mediation the more manual way: back to lm()</span></span>
</div>
<div id="opt-body-10" class="optional-body" style="display: none;">
<p>Following <a href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.917.2326&amp;rep=rep1&amp;type=pdf">Baron &amp; Kenny 1986</a>, we can conduct mediation analysis by using three separate regression models.</p>
<ol type="1">
<li><span class="math inline">\(y \sim x\)</span></li>
<li><span class="math inline">\(x \sim m\)</span></li>
<li><span class="math inline">\(y \sim x + m\)</span></li>
</ol>
<p>Step 1. Determine the presence of <code>y ~ x</code>:<br>
<em>if x predicts y, then there is possibility to detect mediation</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>vax <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/vaxdat.csv"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>mod1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(intention <span class="sc">~</span> religiosity, <span class="at">data =</span> vax)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod1)<span class="sc">$</span>coefficients</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)     57.2      2.422   23.61 3.17e-42
religiosity      3.3      0.929    3.55 5.84e-04</code></pre>
</div>
</div>
<p>Step 2. Determine the presence of <code>m ~ x</code>: <em>if x predicts m, then there is possibility to detect mediation</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>mod2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(hlc <span class="sc">~</span> religiosity, <span class="at">data =</span> vax)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod2)<span class="sc">$</span>coefficients</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    1.775     0.2229    7.96 3.04e-12
religiosity    0.508     0.0855    5.94 4.36e-08</code></pre>
</div>
</div>
<p>Step 3. Examine the effect of <code>y ~ x + m</code>:<br>
<em>If the x no longer predicts y after partialling out effects due to m, then there is <strong>full</strong> mediation. If the effect of x on y is smaller, then there is <strong>partial</strong> mediation.</em></p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mod3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(intention <span class="sc">~</span> religiosity <span class="sc">+</span> hlc, <span class="at">data =</span> vax)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod3)<span class="sc">$</span>coefficients</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Estimate Std. Error t value Pr(&gt;|t|)
(Intercept)    46.58      2.610  17.846 2.10e-32
religiosity     0.27      0.910   0.297 7.67e-01
hlc             5.97      0.922   6.478 3.85e-09</code></pre>
</div>
</div>
<p>Step 4. Test for the mediation.<br>
There are various ways to do this, but the simplest is probably:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mediation)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">mediate</span>(mod2, mod3, <span class="at">treat=</span><span class="st">'religiosity'</span>, <span class="at">mediator=</span><span class="st">'hlc'</span>, <span class="at">boot=</span><span class="cn">TRUE</span>, <span class="at">sims=</span><span class="dv">500</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Causal Mediation Analysis 

Nonparametric Bootstrap Confidence Intervals with the Percentile Method

               Estimate 95% CI Lower 95% CI Upper p-value    
ACME              3.033        1.790         4.41  &lt;2e-16 ***
ADE               0.270       -1.801         2.47   0.828    
Total Effect      3.303        1.450         5.41   0.004 ** 
Prop. Mediated    0.918        0.468         2.04   0.004 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Sample Size Used: 100 


Simulations: 500 </code></pre>
</div>
</div>
<p>ACME: Average Causal Mediation Effects ADE: Average Direct Effects Total Effect: sum of the mediation (indirect) effect and the direct effect.</p>
</div>
<p class="optional-end">
</p>
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;">

</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>