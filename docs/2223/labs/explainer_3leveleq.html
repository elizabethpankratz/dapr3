<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.38">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DAPR3 - 3-level multilevel model equations</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-hand-o-right')) {
    f.classList.add('fa-hand-o-left')
    f.classList.remove('fa-hand-o-right')
} else {
    f.classList.add('fa-hand-o-right')
    f.classList.remove('fa-hand-o-left')
}
}
</script>

<script src="https://kit.fontawesome.com/120b08a6f5.js" crossorigin="anonymous"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">DAPR3</span>
  </a>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-multi-level-models" role="button" data-bs-toggle="dropdown" aria-expanded="false">Multi Level Models</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-multi-level-models">    
        <li>
    <a class="dropdown-item" href="./01_regressionrefresh.html">
 <span class="dropdown-text">1: Linear Regression | Clustered Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02_intromlm.html">
 <span class="dropdown-text">2: Multilevel Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./03_assumptranef.html">
 <span class="dropdown-text">3: Assumptions, Diagnostics &amp; Random Effect Structures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./04_centerglmer.html">
 <span class="dropdown-text">4: Centering in MLM | Logistic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./05_recap.html">
 <span class="dropdown-text">5: Recap</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-dimension-reduction--sem" role="button" data-bs-toggle="dropdown" aria-expanded="false">Dimension reduction &amp; SEM</a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-dimension-reduction--sem">    
        <li class="dropdown-header">7: Path Analysis</li>
        <li class="dropdown-header">8: Path Mediation</li>
        <li class="dropdown-header">9: Dimension Reduction</li>
        <li class="dropdown-header">10: EFA: Part 1</li>
        <li class="dropdown-header">11: EFA: Part 2</li>
    </ul>
  </li>
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">3-level multilevel model equations</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p>10 schools, 20 children in each school, each child completed observed 5 times throughout the year.<br>
interested in how level of routine (child routine questionnaire CRQ), family income, and amount of school funding influence the level of aggressive behaviour (aggressive behaviour scale ABS)</p>
<p>It varies in textbooks whether the specification of levels is <span class="math inline">\(i\)</span>&gt;<span class="math inline">\(j\)</span>&gt;<span class="math inline">\(k\)</span> or <span class="math inline">\(i\)</span>&lt;<span class="math inline">\(j\)</span>&lt;<span class="math inline">\(k\)</span>.<br>
In complex multilevel equations, it becomes a little easier sometimes (for me) to use the latter.<br>
Either way, we need to be clear about what each index refers to.</p>
<p><span class="math display">\[
\begin{align}
k &amp;= \textrm{Schools}\\
j &amp;= \textrm{Children}\\
i &amp;= \textrm{observations}
\end{align}
\]</span></p>
<p>The outcome, aggressive behaviour score, occurs at the observation level <span class="math inline">\(ABS_{ijk}\)</span>.<br>
Level of routine occurs at the observation level <span class="math inline">\(CRQ_{ijk}\)</span>.<br>
Family income occurs at the child level <span class="math inline">\(Income_{jk}\)</span>.<br>
School funding occurs at the school level <span class="math inline">\(Funding_k\)</span>.</p>
<div class="frame">
<p>If we just ignore all of the clustering:</p>
<p><span class="math display">\[
ABS = \beta_0 + \beta_1(CRQ) + \beta_2(Income) + \beta_3(Funding) + \varepsilon
\]</span></p>
</div>
<p><br><br></p>
<div class="frame">
<p>If we put random intercepts for schools and children:</p>
<p><span class="math display">\[
\begin{align}
\textrm{Level 1:} &amp; \\
&amp; ABS_{ijk} = \beta_{0jk} + \beta_1(CRQ_{ijk}) + \beta_2(Income_{jk}) + \beta_3(Funding_k) + \varepsilon_{ijk}\\
\textrm{Level 2:} &amp; \\
&amp;\beta_{0jk} = \gamma_{00k} +\zeta_{0jk} \\
\textrm{Level 3:} &amp; \\
&amp;\gamma_{00k} = \pi_{000} + u_{00k}
\end{align}
\]</span></p>
</div>
<p><br><br></p>
<div class="frame">
<p>We can also move the relevant effects to the corresponding level at which they exist. While we’re at it, we can change the symbol to match the other effects at each level:</p>
<p><span class="math display">\[
\begin{align}
\textrm{Level 1:} &amp; \\
&amp; ABS_{ijk} = \beta_{0jk} + \beta_{1}(CRQ_{ijk}) + \varepsilon_{ijk}\\
\textrm{Level 2:} &amp; \\
&amp;\beta_{0jk} = \gamma_{00k} + \gamma_{010}(Income_{jk}) +\zeta_{0jk} \\
\textrm{Level 3:} &amp; \\
&amp;\gamma_{00k}= \pi_{000} + \pi_{001}(Funding_k) + u_{00k}
\end{align}
\]</span></p>
</div>
<p><br><br></p>
<div class="frame">
<p>Adding in a random slope of routine for each child:</p>
<p><span class="math display">\[
\begin{align}
\textrm{Level 1:} &amp; \\
&amp; ABS_{ijk} = \beta_{0jk} + \beta_{1jk}(CRQ_{ijk}) + \varepsilon_{ijk}\\
\textrm{Level 2:} &amp; \\
&amp;\beta_{0jk} = \gamma_{00k} + \gamma_{010}(Income_{jk}) +\zeta_{0jk} \\
&amp;\beta_{1jk} = \gamma_{100} +\zeta_{1jk} \\
\textrm{Level 3:} &amp; \\
&amp;\gamma_{00k}= \pi_{000} + \pi_{001}(Funding_k) + u_{00k}
\end{align}
\]</span></p>
<p>Adding in a random slope of routine for each school:</p>
<p><span class="math display">\[
\begin{align}
\textrm{Level 1:} &amp; \\
&amp; ABS_{ijk} = \beta_{0jk} + \beta_{1jk}(CRQ_{ijk}) + \varepsilon_{ijk}\\
\textrm{Level 2:} &amp; \\
&amp;\beta_{0jk} = \gamma_{00k} + \gamma_{010}(Income_{jk}) +\zeta_{0jk} \\
&amp;\beta_{1jk} = \gamma_{10k} +\zeta_{1jk} \\
\textrm{Level 3:} &amp; \\
&amp;\gamma_{00k}= \pi_{000} + \pi_{001}(Funding_k) + u_{00k}\\
&amp;\gamma_{10k} = \pi_{100} + u_{10k}
\end{align}
\]</span></p>
<p>Adding in a random slope of income for each school:</p>
<p><span class="math display">\[
\begin{align}
\textrm{Level 1:} &amp; \\
&amp; ABS_{ijk} = \beta_{0jk} + \beta_{1jk}(CRQ_{ijk}) + \varepsilon_{ijk}\\
\textrm{Level 2:} &amp; \\
&amp;\beta_{0jk} = \gamma_{00k} + \gamma_{01k}(Income_{jk}) +\zeta_{0jk} \\
&amp;\beta_{1jk} = \gamma_{10k} +\zeta_{1jk} \\
\textrm{Level 3:} &amp; \\
&amp;\gamma_{00k}= \pi_{000} + \pi_{001}(Funding_k) + u_{00k}\\
&amp;\gamma_{10k} = \pi_{100} + u_{10k} \\
&amp; \gamma_{01k} = \pi_{010} + u_{01k}
\end{align}
\]</span></p>
</div>
<p><br><br></p>
<div class="frame">
<p>collapsing it all back down in to a “mixed” equation:</p>
<p><span class="math display">\[
\begin{align}
ABS_{ijk}= &amp;(\pi_{000} + u_{00k} + \zeta_{0jk}) + &amp; \\
&amp; (\pi_{100} + u_{10k} + \zeta_{1jk})(CRQ_{ijk}) + &amp;\\
&amp;(\pi_{010} + u_{01k})(Income_{jk}) + &amp;\\
&amp;\pi_{001}(Funding_k) + &amp;\\
&amp; \varepsilon_{ijk}&amp; \\
\end{align}
\]</span></p>
</div>



</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>