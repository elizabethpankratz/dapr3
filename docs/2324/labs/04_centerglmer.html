<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DAPR3 - Centering in MLM | Logistic MLM</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('fa-circle-right')) {
    f.classList.add('fa-circle-down')
    f.classList.remove('fa-circle-right')
} else {
    f.classList.add('fa-circle-right')
    f.classList.remove('fa-circle-down')
}
}
</script>

<script src="https://kit.fontawesome.com/120b08a6f5.js" crossorigin="anonymous"></script>
<link href="site_libs/panelset-0.2.6/panelset.css" rel="stylesheet">
<script src="site_libs/panelset-0.2.6/panelset.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">DAPR3</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./csstests.html" rel="" target="">
 <span class="menu-text">CSS tests</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-multi-level-models" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Multi Level Models</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-multi-level-models">    
        <li>
    <a class="dropdown-item" href="./01_regressionrefresh.html" rel="" target="">
 <span class="dropdown-text">1: Linear Regression | Clustered Data</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./02_intromlm.html" rel="" target="">
 <span class="dropdown-text">2: Multilevel Models</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./03_assumptranef.html" rel="" target="">
 <span class="dropdown-text">3: Assumptions, Diagnostics &amp; Random Effect Structures</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./04_centerglmer.html" rel="" target="">
 <span class="dropdown-text">4: Centering in MLM | Logistic</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./05_recap.html" rel="" target="">
 <span class="dropdown-text">5: Recap</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-dimension-reduction--sem" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Dimension reduction &amp; SEM</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-dimension-reduction--sem">    
        <li class="dropdown-header">7: Path Analysis</li>
        <li class="dropdown-header">8: Path Mediation</li>
        <li class="dropdown-header">9: Dimension Reduction</li>
        <li class="dropdown-header">10: EFA: Part 1</li>
        <li class="dropdown-header">11: EFA: Part 2</li>
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-extra" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Extra</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-extra">    
        <li class="dropdown-header">Example: Repeated Measures MLM</li>
        <li class="dropdown-header">Example: Intervention Study</li>
        <li class="dropdown-header">Example: Many Trials</li>
        <li class="dropdown-header">Example: ANOVA (rpt measures &amp; mixed)</li>
        <li class="dropdown-header">Example: Exploratory Factor Analysis</li>
        <li class="dropdown-header">Likelihood vs Probability</li>
        <li class="dropdown-header">Writing 3-level MLM equations</li>
        <li class="dropdown-header">PCA and Unequal Variances</li>
    </ul>
  </li>
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#exercises-centering-in-the-mlm" id="toc-exercises-centering-in-the-mlm" class="nav-link active" data-scroll-target="#exercises-centering-in-the-mlm">Exercises: Centering in the MLM</a></li>
  <li><a href="#optional-exercises-logistic-mlm" id="toc-optional-exercises-logistic-mlm" class="nav-link" data-scroll-target="#optional-exercises-logistic-mlm">Optional Exercises: Logistic MLM</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Centering in MLM | Logistic MLM</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="lo">
<p><strong>This Week</strong></p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Centering &amp; Scaling in LM
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We have some data from a study investigating how perceived persuasiveness of a speaker is influenced by the rate at which they speak.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>dap2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/dapr2_2122_report1.csv"</span>)</span></code></pre></div>
</div>
<p>We can fit a simple linear regression (one predictor) to evaluate how speech rate (variable <code>sp_rate</code> in the dataset) influences perceived persuasiveness (variable <code>persuasive</code> in the dataset). There are various ways in which we can transform the predictor variable <code>sp_rate</code>, which in turn can alter the interpretation of some of our estimates:</p>
<div class="panelset">
<section id="raw-x" class="level4 panel">
<h4 class="anchored" data-anchor-id="raw-x">Raw X</h4>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(persuasive <span class="sc">~</span> sp_rate, <span class="at">data =</span> dap2)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m1)<span class="sc">$</span>coefficients</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept) 55.532060  6.4016670  8.674625 6.848945e-15
sp_rate     -0.190987  0.4497113 -0.424688 6.716809e-01</code></pre>
</div>
</div>
<p>The intercept and the coefficient for neuroticism are interpreted as:</p>
<ul>
<li><code>(Intercept)</code>: A audio clip of someone speaking at zero phones per second is estimated as having an average persuasive rating of 55.53.<br>
</li>
<li><code>sp_rate</code>: For every increase of one phone per second, perceived persuasiveness is estimated to decrease by -0.19.</li>
</ul>
</section>
<section id="mean-centered-x" class="level4 panel">
<h4 class="anchored" data-anchor-id="mean-centered-x">Mean-Centered X</h4>
<p>We can mean center our predictor and fit the model again:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dap2 <span class="ot">&lt;-</span> dap2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">sp_rate_mc =</span> sp_rate <span class="sc">-</span> <span class="fu">mean</span>(sp_rate))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(persuasive <span class="sc">~</span> sp_rate_mc, <span class="at">data =</span> dap2)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m2)<span class="sc">$</span>coefficients</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept) 52.874667  1.3519418 39.110165 6.429541e-80
sp_rate_mc  -0.190987  0.4497113 -0.424688 6.716809e-01</code></pre>
</div>
</div>
<ul>
<li><code>(Intercept)</code>: A audio clip of someone speaking at the <strong>mean</strong> phones per second is estimated as having an average persuasive rating of 52.87.<br>
</li>
<li><code>sp_rate_mc</code>: For every increase of one phone per second, perceived persuasiveness is estimated to decrease by -0.19.</li>
</ul>
</section>
<section id="standardised-x" class="level4 panel">
<h4 class="anchored" data-anchor-id="standardised-x">Standardised X</h4>
<p>We can <em>standardise</em> our predictor and fit the model yet again:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>dap2 <span class="ot">&lt;-</span> dap2 <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">sp_rate_z =</span> <span class="fu">scale</span>(sp_rate))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(persuasive <span class="sc">~</span> sp_rate_z, <span class="at">data =</span> dap2)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(m3)<span class="sc">$</span>coefficients</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>             Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept) 52.874667   1.351942 39.110165 6.429541e-80
sp_rate_z   -0.576077   1.356471 -0.424688 6.716809e-01</code></pre>
</div>
</div>
<ul>
<li><code>(Intercept)</code>: A audio clip of someone speaking at the <strong>mean</strong> phones per second is estimated as having an average persuasive rating of 52.87.<br>
</li>
<li><code>sp_rate_z</code>: For every increase of one <strong>standard deviation</strong> in phones per second, perceived persuasiveness is estimated to decrease by -0.58.</li>
</ul>
<p>Remember that the <code>scale(sp_rate)</code> is subtracting the mean from each value, then dividing those by the standard deviation. The standard deviation of <code>dap2$sp_rate</code> is:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(dap2<span class="sc">$</span>sp_rate)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.016315</code></pre>
</div>
</div>
<p>so in our variable <code>dap2$sp_rate_z</code>, a change of 3.02 gets scaled to be a change of 1 (because we are dividing by <code>sd(dap2$sp_rate)</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m1)[<span class="dv">2</span>] <span class="sc">*</span> <span class="fu">sd</span>(dap2<span class="sc">$</span>sp_rate)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  sp_rate 
-0.576077 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(m3)[<span class="dv">2</span>]</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>sp_rate_z 
-0.576077 </code></pre>
</div>
</div>
</section>
</div>
<p>Note that these models are identical. When we conduct a model comparison between the 3 models, the residual sums of squares is identical for all models:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1,m2,m3)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: persuasive ~ sp_rate
Model 2: persuasive ~ sp_rate_mc
Model 3: persuasive ~ sp_rate_z
  Res.Df   RSS Df Sum of Sq F Pr(&gt;F)
1    148 40576                      
2    148 40576  0         0         
3    148 40576  0         0         </code></pre>
</div>
</div>
<p>What changes when you center or scale a predictor in a standard regression model (one fitted with <code>lm()</code>)?</p>
<ul>
<li>The variance explained by the predictor remains exactly the same</li>
<li>The intercept will change to be the estimated mean outcome where that predictor is “0”. Scaling and centering changes what “0” represents, thereby changing this estimate (the significance test will therefore also change because the intercept now has a different meaning)</li>
<li>The slope of the predictor will change according to any scaling (e.g.&nbsp;if you divide your predictor by 10, the slope will multiply by 10).</li>
<li>The <strong>test</strong> of the slope of the predictor remains exactly the same.</li>
</ul>
</div>
</div>
</div>
<p><br></p>
<section id="exercises-centering-in-the-mlm" class="level1">
<h1>Exercises: Centering in the MLM</h1>
<div class="frame">
<p><strong>Data: Hangry</strong></p>
<p>The study is interested in evaluating whether hunger influences peoples’ levels of irritability (i.e., “the hangry hypothesis”), and whether this is different for people following a diet that includes fasting. 81 participants were recruited into the study. Once a week for 5 consecutive weeks, participants were asked to complete two questionnaires, one assessing their level of hunger, and one assessing their level of irritability. The time and day at which participants were assessed was at a randomly chosen hour between 7am and 7pm each week. 46 of the participants were following a five-two diet (five days of normal eating, 2 days of fasting), and the remaining 35 were following no specific diet.</p>
<p>The data are available at: <a href="https://uoepsy.github.io/data/hangry.csv">https://uoepsy.github.io/data/hangry.csv</a>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">variable</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">q_irritability</td>
<td style="text-align: left;">Score on irritability questionnaire (0:100)</td>
</tr>
<tr class="even">
<td style="text-align: left;">q_hunger</td>
<td style="text-align: left;">Score on hunger questionnaire (0:100)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ppt</td>
<td style="text-align: left;">Participant</td>
</tr>
<tr class="even">
<td style="text-align: left;">fivetwo</td>
<td style="text-align: left;">Whether the participant follows the five-two diet</td>
</tr>
</tbody>
</table>


</div>
</div>
</div>
<div class="question-begin">
Question 1
</div>
<div class="question-body">
<p>Read carefully the description of the study above, and try to write out (in <code>lmer</code> syntax) an appropriate model to test the research aims.<br>
e.g.:</p>
<pre><code>outcome ~ explanatory variables + (???? | grouping)</code></pre>
<p>Try to think about the maximal random effect structure (i.e.&nbsp;everything that can vary by-grouping is estimated as doing so).</p>
<p>To help you think through the steps to get from a description of a research study to a model specification, think about your answers to the following questions.</p>
<p>Q: What is our outcome variable?<br>
Q: What are our explanatory variables?<br>
Q: Is there any grouping (or “clustering”) of our data that we consider to be a random sample? If so, what are the groups?</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hints
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>The research is looking at how hunger influences irritability, and whether this is different for people on the fivetwo diet.</li>
<li>We can split our data in to groups of each participant. We can also split it into groups of each diet. Which of these groups have we randomly sampled? Do we have a random sample of participants? Do we have a random sample of diets? Another way to think of this is “if i repeated the experiment, what these groups be different?”</li>
</ul>
</div>
</div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-1" class="fa-solid fa-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-1', 'sol-start-1')">
Solution
</button>
</div>
<div id="sol-body-1" class="solution-body" style="display: none;">
<p>Our outcome is irritability here, because it is the thing that we are trying to explain through peoples’ hunger levels and diets.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(irritability <span class="sc">~</span>  explanatory variables <span class="sc">+</span> (???? <span class="sc">|</span> grouping))</span></code></pre></div>
</div>
<p>We are interested in the effect of hunger on irritability, and whether this effect is different for the five-two diet. So we are interested in the interaction:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(irritability <span class="sc">~</span>  hunger <span class="sc">+</span> diet <span class="sc">+</span> hunger<span class="sc">:</span>diet <span class="sc">+</span> (???? <span class="sc">|</span> grouping))</span></code></pre></div>
</div>
<p>(remember that <code>hunger + diet + hunger:diet</code> is just a more explicit way of writing <code>hunger*diet</code>).</p>
<p>If we did this experiment again, would we have different participants?<br>
Yes. If we did this experiment again, would we have different diets? No, because we’re interested in the specific differences between the five-two diet and no dieting. This means we will likely want to by-participant random deviations (e.g.&nbsp;the <code>( ... | participant)</code> bit in <code>lmer</code>). But we won’t have by-diet random effects <code>(1 | diet)</code> because the diet differences are the specific differences that we wish to test.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(irritability <span class="sc">~</span>  hunger <span class="sc">+</span> diet <span class="sc">+</span> hunger<span class="sc">:</span>diet <span class="sc">+</span> (???? <span class="sc">|</span> participant))</span></code></pre></div>
</div>
<p>Thinking about what <strong>can</strong> be modelled as randomly varying between participants, we have some options:</p>
<ol type="1">
<li>participants vary in how irritable they are on average<br>
(the intercept, <code>1 | participant</code>)</li>
<li>participants vary in how much hunger influences their irritability<br>
(the effect of hunger, <code>hunger | participant</code>)</li>
<li>participants vary in how much diet influences irritability<br>
(the effect of diet, <code>diet | participant</code>)</li>
<li>participants vary in how much diet effects hunger’s influence on irritability<br>
(the interaction between diet and hunger, <code>diet:hunger | participant</code>)</li>
</ol>
<p>We can vary 1 and 2, but not 3 and 4. This is because each participant is <em>either</em> following the five-two diet <em>or</em> they are not. So for a <em>single</em> participant, we can’t assess “the effect diet has” on anything, because we haven’t seen that participant under different diets. if we try to plot a single participants’ data, we can see that it is impossible for us to assess “the effect of diet”:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_centerglmer_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>By contrast, we <strong>can</strong> vary the intercept and the effect of hunger, because each participant has multiple values of irritability, and multiple different observations of hunger. We can think about a single participant’s “effect of hunger on irritability” and how we might fit a line to their data:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_centerglmer_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(irritability <span class="sc">~</span>  hunger <span class="sc">+</span> diet <span class="sc">+</span> hunger<span class="sc">:</span>diet <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> hunger <span class="sc">|</span> participant))</span></code></pre></div>
</div>
</div>
<p class="solution-end">
</p>
<div class="statbox">
<p><strong>Total, Within, Between</strong></p>
<p>Recall our research aim:</p>
<blockquote class="blockquote">
<p><strong>… whether hunger influences peoples’ levels of irritability (i.e., “the hangry hypothesis”)</strong>, and whether this is different for people following a diet that includes fasting.</p>
</blockquote>
<p>Forgetting about any differences due to diet, let’s just think about the relationship between irritability and hunger. How should we interpret this research aim?<br>
Was it:</p>
<ol type="a">
<li>“Are people more irritable if they are, <strong>on average</strong>, more hungry <strong>than other people</strong>?”<br>
</li>
<li>“Are people more irritable if they are, <strong>for them</strong>, more hungry <strong>than they usually are</strong>?”<br>
</li>
<li>Some combination of both a. and b.</li>
</ol>
<p>This is just one demonstration of how the statistical methods we use can constitute an integral part of our development of a research project, and part of the reason that data analysis for scientific cannot be so easily outsourced after designing the study and collecting the data.</p>
<p>As our data currently is currently stored, the relationship between <code>irritability</code> and the raw scores on the hunger questionnaire <code>q_hunger</code> represents some ‘total effect’ of hunger on irritability. This is a bit like interpretation <strong>c.</strong> above - it’s a composite of both the ‘within’ ( <strong>b.</strong> ) and ‘between’ ( <strong>a.</strong> ) effects. The problem with this is that the ‘total effect’ isn’t necessarily all that meaningful. It may tell us that ‘being higher on the hunger questionnaire is associated with being more irritable’, but how can we apply this information? It is not specifically about the comparison between hungry people and less hungry people, and nor is it about how person i changes when they are more hungry than usual. It is both these things smushed together.</p>
<p>To disaggregate the ‘within’ and ‘between’ effects of hunger on irritability, we can group-mean center. For ‘between’, we are interested in how irritability is related to the average hunger levels of a participant, and for ‘within’, we are asking how irritability is related to a participants’ <em>relative levels</em> of hunger (i.e., how far above/below their average hunger level they are.).</p>
</div>
<div class="question-begin">
Question 2
</div>
<div class="question-body">
<p>Add to the data these two columns:</p>
<ol type="1">
<li>a column which contains the average hungriness score for each participant.</li>
<li>a column which contains the deviation from each person’s hunger score to that person’s average hunger score.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hints
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>You’ll find <code>group_by() %&gt;% mutate()</code> very useful here.</p>
</div>
</div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-2" class="fa-solid fa-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-2', 'sol-start-2')">
Solution
</button>
</div>
<div id="sol-body-2" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>hangry <span class="ot">&lt;-</span> </span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    hangry <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ppt) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_hunger =</span> <span class="fu">mean</span>(q_hunger),</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">hunger_gc =</span> q_hunger <span class="sc">-</span> avg_hunger</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hangry)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
# Groups:   ppt [2]
  q_irritability q_hunger ppt   fivetwo avg_hunger hunger_gc
           &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;fct&gt;        &lt;dbl&gt;     &lt;dbl&gt;
1             17       30 N1p1  1             26.6     3.4  
2             19       27 N1p1  1             26.6     0.400
3             19       29 N1p1  1             26.6     2.4  
4             20       33 N1p1  1             26.6     6.4  
5             24       14 N1p1  1             26.6   -12.6  
6             30       28 N1p2  1             32.6    -4.6  </code></pre>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 3
</div>
<div class="question-body">
<p>For each of the new variables you just added, plot the irritability scores against those variables.</p>
<ul>
<li>Does it look like hungry people are more irritable than less hungry people?<br>
</li>
<li>Does it look like when people are more hungry than normal, they are more irritable?</li>
</ul>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-3" class="fa-solid fa-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-3', 'sol-start-3')">
Solution
</button>
</div>
<div id="sol-body-3" class="solution-body" style="display: none;">
<p>We might find it easier to look at a plot where each participant is represented as their mean plus an indication of their range of irritability scores:</p>
<div class="cell" data-layout-align="center" data-fig.asp="0.5">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hangry,<span class="fu">aes</span>(<span class="at">x=</span>avg_hunger,<span class="at">y=</span>q_irritability))<span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">geom=</span><span class="st">"pointrange"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_centerglmer_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>There appears to be a slight positive relationship between a persons’ average hunger and their irritability scores.</p>
<p>It is harder to tell what the relationship is between participant-centered hunger and irritability, because there are a lot of different lines (one for each participant). To make it easier to get an idea of what’s happening, we’ll make the plot fit a simple lm() (a straight line) for each participants’ data:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(hangry,<span class="fu">aes</span>(<span class="at">x=</span>hunger_gc,<span class="at">y=</span>q_irritability, <span class="at">group=</span>ppt))<span class="sc">+</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> .<span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm, <span class="at">se=</span><span class="cn">FALSE</span>, <span class="at">lwd=</span>.<span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_centerglmer_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>I think there might be a positive trend in here, in that participants tend to be higher irritability when they are higher (for them) on the hunger score.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 4
</div>
<div class="question-body">
<p>We have taken the raw hunger scores and separated them into two parts (raw hunger scores = participants’ average hunger score + observation level deviations from those averages), that represent two different aspects of the relationship between hunger and irritability.</p>
<p>Adjust your model specification to include these two separate variables as predictors, instead of the raw hunger scores.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hints
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li><code>hunger * diet</code> could be replaced by <code>(hunger1 + hunger2) * diet</code>, thereby allowing each aspect of hunger to interact with diet.</li>
<li>We can only put one of these variables in the random effects <code>(1 + hunger | participant)</code>. Recall that above we discussed how we cannot have <code>(diet | participant)</code>, because “an effect of diet” makes no sense for a single participant (they are either on the diet or they are not, so there is no ‘effect’). Similarly, each participant has only one value for their average hungriness.</li>
</ul>
</div>
</div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-4" class="fa-solid fa-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-4', 'sol-start-4')">
Solution
</button>
</div>
<div id="sol-body-4" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lme4)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>hangrywb <span class="ot">&lt;-</span> <span class="fu">lmer</span>(q_irritability <span class="sc">~</span> (avg_hunger <span class="sc">+</span> hunger_gc)<span class="sc">*</span> fivetwo <span class="sc">+</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>                (<span class="dv">1</span> <span class="sc">+</span> hunger_gc <span class="sc">|</span> ppt), </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> hangry,</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer=</span><span class="st">"bobyqa"</span>))</span></code></pre></div>
</div>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 5
</div>
<div class="question-body">
<p>Hopefully, you have fitted a model similar to the below:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>hangrywb <span class="ot">&lt;-</span> <span class="fu">lmer</span>(q_irritability <span class="sc">~</span> (avg_hunger <span class="sc">+</span> hunger_gc) <span class="sc">*</span> fivetwo <span class="sc">+</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                (<span class="dv">1</span> <span class="sc">+</span> hunger_gc <span class="sc">|</span> ppt), <span class="at">data =</span> hangry,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">control =</span> <span class="fu">lmerControl</span>(<span class="at">optimizer=</span><span class="st">"bobyqa"</span>))</span></code></pre></div>
</div>
<p>Below, we have obtained p-values using the Kenward Rogers Approximation of <span class="math inline">\(df\)</span> for the test of whether the fixed effects are zero, so we can see the significance of each estimate.</p>
<p>Provide an answer for each of these questions:</p>
<ol type="1">
<li>For those following no diet, is there evidence to suggest that people who are <em>on average</em> more hungry are more irritable?</li>
<li>Is there evidence to suggest that this is different for those following the five-two diet? In what way?</li>
<li>Do people following no diet tend to be more irritable when they are more hungry than they usually are?</li>
<li>Is there evidence to suggest that this is different for those following the five-two diet? In what way?</li>
<li><strong>(Trickier:)</strong> What does the <code>fivetwo</code> coefficient represent?</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">

<div id="owefgtkpnt" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#owefgtkpnt table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#owefgtkpnt thead, #owefgtkpnt tbody, #owefgtkpnt tfoot, #owefgtkpnt tr, #owefgtkpnt td, #owefgtkpnt th {
  border-style: none;
}

#owefgtkpnt p {
  margin: 0;
  padding: 0;
}

#owefgtkpnt .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 100%;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#owefgtkpnt .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#owefgtkpnt .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#owefgtkpnt .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#owefgtkpnt .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#owefgtkpnt .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#owefgtkpnt .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#owefgtkpnt .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#owefgtkpnt .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#owefgtkpnt .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#owefgtkpnt .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#owefgtkpnt .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#owefgtkpnt .gt_spanner_row {
  border-bottom-style: hidden;
}

#owefgtkpnt .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#owefgtkpnt .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#owefgtkpnt .gt_from_md > :first-child {
  margin-top: 0;
}

#owefgtkpnt .gt_from_md > :last-child {
  margin-bottom: 0;
}

#owefgtkpnt .gt_row {
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#owefgtkpnt .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#owefgtkpnt .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#owefgtkpnt .gt_row_group_first td {
  border-top-width: 2px;
}

#owefgtkpnt .gt_row_group_first th {
  border-top-width: 2px;
}

#owefgtkpnt .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#owefgtkpnt .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#owefgtkpnt .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#owefgtkpnt .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#owefgtkpnt .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#owefgtkpnt .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#owefgtkpnt .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#owefgtkpnt .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#owefgtkpnt .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#owefgtkpnt .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#owefgtkpnt .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#owefgtkpnt .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#owefgtkpnt .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#owefgtkpnt .gt_left {
  text-align: left;
}

#owefgtkpnt .gt_center {
  text-align: center;
}

#owefgtkpnt .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#owefgtkpnt .gt_font_normal {
  font-weight: normal;
}

#owefgtkpnt .gt_font_bold {
  font-weight: bold;
}

#owefgtkpnt .gt_font_italic {
  font-style: italic;
}

#owefgtkpnt .gt_super {
  font-size: 65%;
}

#owefgtkpnt .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#owefgtkpnt .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#owefgtkpnt .gt_indent_1 {
  text-indent: 5px;
}

#owefgtkpnt .gt_indent_2 {
  text-indent: 10px;
}

#owefgtkpnt .gt_indent_3 {
  text-indent: 15px;
}

#owefgtkpnt .gt_indent_4 {
  text-indent: 20px;
}

#owefgtkpnt .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_heading">
      <td colspan="7" class="gt_heading gt_title gt_font_normal gt_bottom_border" style="">Model Summary</td>
    </tr>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="Parameter">Parameter</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="Coefficient">Coefficient</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="SE">SE</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="95% CI">95% CI</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="t">t</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="df">df</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="p">p</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr class="gt_group_heading_row">
      <th colspan="7" class="gt_group_heading" scope="colgroup" id="Fixed Effects ">Fixed Effects </th>
    </tr>
    <tr class="gt_row_group_first"><td headers="Fixed Effects   Parameter" class="gt_row gt_left" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;">(Intercept)</td>
<td headers="Fixed Effects   Coefficient" class="gt_row gt_center">17.13</td>
<td headers="Fixed Effects   SE" class="gt_row gt_center">5.21</td>
<td headers="Fixed Effects   95% CI" class="gt_row gt_center">(6.75, 27.51)</td>
<td headers="Fixed Effects   t" class="gt_row gt_center">3.29</td>
<td headers="Fixed Effects   df" class="gt_row gt_center">77.00</td>
<td headers="Fixed Effects   p" class="gt_row gt_center">0.002 </td></tr>
    <tr><td headers="Fixed Effects   Parameter" class="gt_row gt_left" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;">avg hunger</td>
<td headers="Fixed Effects   Coefficient" class="gt_row gt_center">3.86e-03</td>
<td headers="Fixed Effects   SE" class="gt_row gt_center">0.11</td>
<td headers="Fixed Effects   95% CI" class="gt_row gt_center">(-0.21, 0.22)</td>
<td headers="Fixed Effects   t" class="gt_row gt_center">0.04</td>
<td headers="Fixed Effects   df" class="gt_row gt_center">77.00</td>
<td headers="Fixed Effects   p" class="gt_row gt_center">0.971 </td></tr>
    <tr><td headers="Fixed Effects   Parameter" class="gt_row gt_left" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;">hunger gc</td>
<td headers="Fixed Effects   Coefficient" class="gt_row gt_center">0.19</td>
<td headers="Fixed Effects   SE" class="gt_row gt_center">0.08</td>
<td headers="Fixed Effects   95% CI" class="gt_row gt_center">(0.03, 0.34)</td>
<td headers="Fixed Effects   t" class="gt_row gt_center">2.45</td>
<td headers="Fixed Effects   df" class="gt_row gt_center">70.40</td>
<td headers="Fixed Effects   p" class="gt_row gt_center">0.017 </td></tr>
    <tr><td headers="Fixed Effects   Parameter" class="gt_row gt_left" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;">fivetwo (1)</td>
<td headers="Fixed Effects   Coefficient" class="gt_row gt_center">-10.85</td>
<td headers="Fixed Effects   SE" class="gt_row gt_center">6.62</td>
<td headers="Fixed Effects   95% CI" class="gt_row gt_center">(-24.03, 2.32)</td>
<td headers="Fixed Effects   t" class="gt_row gt_center">-1.64</td>
<td headers="Fixed Effects   df" class="gt_row gt_center">77.00</td>
<td headers="Fixed Effects   p" class="gt_row gt_center">0.105 </td></tr>
    <tr><td headers="Fixed Effects   Parameter" class="gt_row gt_left" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;">avg hunger × fivetwo (1)</td>
<td headers="Fixed Effects   Coefficient" class="gt_row gt_center">0.47</td>
<td headers="Fixed Effects   SE" class="gt_row gt_center">0.14</td>
<td headers="Fixed Effects   95% CI" class="gt_row gt_center">(0.20, 0.74)</td>
<td headers="Fixed Effects   t" class="gt_row gt_center">3.44</td>
<td headers="Fixed Effects   df" class="gt_row gt_center">77.00</td>
<td headers="Fixed Effects   p" class="gt_row gt_center">&lt; .001</td></tr>
    <tr><td headers="Fixed Effects   Parameter" class="gt_row gt_left" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;">hunger gc × fivetwo (1)</td>
<td headers="Fixed Effects   Coefficient" class="gt_row gt_center">0.38</td>
<td headers="Fixed Effects   SE" class="gt_row gt_center">0.10</td>
<td headers="Fixed Effects   95% CI" class="gt_row gt_center">(0.18, 0.58)</td>
<td headers="Fixed Effects   t" class="gt_row gt_center">3.75</td>
<td headers="Fixed Effects   df" class="gt_row gt_center">73.64</td>
<td headers="Fixed Effects   p" class="gt_row gt_center">&lt; .001</td></tr>
    <tr class="gt_group_heading_row">
      <th colspan="7" class="gt_group_heading" scope="colgroup" id="Random Effects ">Random Effects </th>
    </tr>
    <tr class="gt_row_group_first"><td headers="Random Effects   Parameter" class="gt_row gt_left" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;">SD (Intercept: ppt)</td>
<td headers="Random Effects   Coefficient" class="gt_row gt_center">6.93</td>
<td headers="Random Effects   SE" class="gt_row gt_center"></td>
<td headers="Random Effects   95% CI" class="gt_row gt_center"></td>
<td headers="Random Effects   t" class="gt_row gt_center"></td>
<td headers="Random Effects   df" class="gt_row gt_center"></td>
<td headers="Random Effects   p" class="gt_row gt_center"></td></tr>
    <tr><td headers="Random Effects   Parameter" class="gt_row gt_left" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;">SD (hunger_gc: ppt)</td>
<td headers="Random Effects   Coefficient" class="gt_row gt_center">0.38</td>
<td headers="Random Effects   SE" class="gt_row gt_center"></td>
<td headers="Random Effects   95% CI" class="gt_row gt_center"></td>
<td headers="Random Effects   t" class="gt_row gt_center"></td>
<td headers="Random Effects   df" class="gt_row gt_center"></td>
<td headers="Random Effects   p" class="gt_row gt_center"></td></tr>
    <tr><td headers="Random Effects   Parameter" class="gt_row gt_left" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;">Cor (Intercept~hunger_gc: ppt)</td>
<td headers="Random Effects   Coefficient" class="gt_row gt_center">-0.01</td>
<td headers="Random Effects   SE" class="gt_row gt_center"></td>
<td headers="Random Effects   95% CI" class="gt_row gt_center"></td>
<td headers="Random Effects   t" class="gt_row gt_center"></td>
<td headers="Random Effects   df" class="gt_row gt_center"></td>
<td headers="Random Effects   p" class="gt_row gt_center"></td></tr>
    <tr><td headers="Random Effects   Parameter" class="gt_row gt_left" style="border-right-width: 1px; border-right-style: solid; border-right-color: #d3d3d3;">SD (Residual)</td>
<td headers="Random Effects   Coefficient" class="gt_row gt_center">4.83</td>
<td headers="Random Effects   SE" class="gt_row gt_center"></td>
<td headers="Random Effects   95% CI" class="gt_row gt_center"></td>
<td headers="Random Effects   t" class="gt_row gt_center"></td>
<td headers="Random Effects   df" class="gt_row gt_center"></td>
<td headers="Random Effects   p" class="gt_row gt_center"></td></tr>
  </tbody>
  <tfoot class="gt_sourcenotes">
    <tr>
      <td class="gt_sourcenote" colspan="7"></td>
    </tr>
  </tfoot>
  
</table>
</div>
</div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-5" class="fa-solid fa-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-5', 'sol-start-5')">
Solution
</button>
</div>
<div id="sol-body-5" class="solution-body" style="display: none;">
<p><strong>1: For those following no diet, is there evidence to suggest that people who are <em>on average</em> more hungry are more irritable?</strong><br>
A: ‘No diet’ is the reference level of the five-two variable, and because we have an interaction, that means the <code>avg_hunger</code> coefficient will provide the relevant estimate. There is no evidence (<span class="math inline">\(p&gt;.05\)</span>) to suggest that when not dieting, hungrier people are more irritable than less hungry people.</p>
<p><strong>2: Is there evidence to suggest that this is different for those following the five-two diet? In what way?</strong><br>
A: This is the interaction between <code>avg_hunger:fivetwo1</code>. We can see that, for every increase of 1 in average hunger, irritability is estimated to increase by 0.47 more for those in the five-two diet than it does for those following no diet.<br>
These units are still in terms of the original scale (i.e.&nbsp;0 to 100).</p>
<p><strong>3: Do people following no diet tend to be more irritable when they are more hungry than they usually are?</strong> A: This is the estimate for the coefficient of <code>hunger_gc</code>. For people following no diet, there is an estimated 0.19 increase in irritability for every 1 unit more hungry they become.</p>
<p><strong>4: Is there evidence to suggest that this is different for those following the five-two diet? In what way?</strong> A: This effect of a 1 unit change on within-person hunger increasing irritability is increased for those who are following the five-two diet by an additional 0.38</p>
<p><strong>5: What does the <code>fivetwo1</code> coefficient represent?</strong> A: This represents the group difference of irritability between those on the five-two diet vs those not dieting, for someone who has an average hunger score of 0.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 6
</div>
<div class="question-body">
<p>Construct two plots showing the two model estimated interactions. Think about your answers to the previous question, and check that they match with what you are seeing in the plots (do not underestimate the utility of this activity for helping understanding!).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hints
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This isn’t as difficult as it sounds. the sjPlot package can do it in one line of code!</p>
</div>
</div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-6" class="fa-solid fa-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-6', 'sol-start-6')">
Solution
</button>
</div>
<div id="sol-body-6" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sjPlot)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(hangrywb, <span class="at">type =</span> <span class="st">"int"</span>)[[<span class="dv">1</span>]]</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_centerglmer_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>We saw in the model coefficients that for the reference level of <code>fivetwo</code>, the “No Diet” group, there was no association between how hungry a person is <em>on average</em> and their irritability. This is the red line we see in the plot above. We also saw the interaction <code>avg_hunger:fivetwo1</code> indicates that irritability is estimated to increase by 0.47 more for those in the five-two diet than it does for those following no diet. So the blue line is should be going up more steeply than the red line (which is flat). And it is!</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_model</span>(hangrywb, <span class="at">type =</span> <span class="st">"int"</span>)[[<span class="dv">2</span>]]</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_centerglmer_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>From the coefficient of <code>hunger_gc</code> we get the estimated amount by which irritability increases for every 1 more hungry that a person becomes (when they’re on “No Diet”). This is the slope of the red line. The interaction <code>hunger_gc:fivetwo1</code> gave us the adjustment to get from the red line to the blue line. It is positive and significant, which matches with the fact that the blue line is clearly steeper in this plot.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 7
</div>
<div class="question-body">
<p>Provide tests or confidence intervals for the parameters of interest, and write-up the results.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Remember: some options for inference
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<table class="table">
<colgroup>
<col style="width: 10%">
<col style="width: 44%">
<col style="width: 45%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th>df approximations</th>
<th>likelihood-based</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>model parameters</td>
<td><code>library(parameters)</code><br><code>model_parameters(model, ci_method="kr")</code></td>
<td><code>confint(model, type="profile")</code></td>
</tr>
<tr class="even">
<td>model comparison</td>
<td><code>library(pbkrtest)</code><br><code>KRmodcomp(model1,model0)</code></td>
<td><code>anova(model0,model)</code></td>
</tr>
<tr class="odd">
<td></td>
<td>fit models with <code>REML=TRUE</code>.<br>good option for small samples</td>
<td>fit models with <code>REML=FALSE</code>.<br>needs large N at both levels (40+)</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-7" class="fa-solid fa-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-7', 'sol-start-7')">
Solution
</button>
</div>
<div id="sol-body-7" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(parameters)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">model_parameters</span>(hangrywb, <span class="at">ci_method =</span> <span class="st">"kr"</span>, <span class="at">ci_random =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Fixed Effects

Parameter                | Coefficient |   SE |          95% CI |     t |    df |      p
----------------------------------------------------------------------------------------
(Intercept)              |       17.13 | 5.21 | [  6.75, 27.51] |  3.29 | 77.00 | 0.002 
avg hunger               |    3.86e-03 | 0.11 | [ -0.21,  0.22] |  0.04 | 77.00 | 0.971 
hunger gc                |        0.19 | 0.08 | [  0.03,  0.34] |  2.45 | 70.40 | 0.017 
fivetwo [1]              |      -10.85 | 6.62 | [-24.03,  2.32] | -1.64 | 77.00 | 0.105 
avg hunger × fivetwo [1] |        0.47 | 0.14 | [  0.20,  0.74] |  3.44 | 77.00 | &lt; .001
hunger gc × fivetwo [1]  |        0.38 | 0.10 | [  0.18,  0.58] |  3.75 | 73.64 | &lt; .001

# Random Effects

Parameter                      | Coefficient
--------------------------------------------
SD (Intercept: ppt)            |        6.93
SD (hunger_gc: ppt)            |        0.38
Cor (Intercept~hunger_gc: ppt) |       -0.01
SD (Residual)                  |        4.83</code></pre>
</div>
</div>
<p>To investigate the association between irritability and hunger, and whether this relationship is different depending on whether or not participants are on a restricted diet such as the five-two, a multilevel linear model was fitted.<br>
To disaggregate between the differences in irritability due to people being in general more/less hungry, and those due to people being more/less hungry than usual for them, irritability was regressed onto both participants’ average hunger scores their relative hunger levels. Both of these were allowed to interact with whether or not participants were on the five-two diet. Random intercepts and slopes of relative-hunger level were included for participants. The model was fitting with restricted maximum likelihood estimation with the <strong>lme4</strong> package (Bates et al., 2015), using the <em>bobyqa</em> optimiser from the <strong>lme4</strong>. <span class="math inline">\(P\)</span>-values were obtained using Wald tests with Kenward-Roger approximation of denominator degrees of freedom.</p>
<p>Results indicate that for people on no diet, being more hungry than normal was associated with greater irritability (<span class="math inline">\(\beta = 0.19,\ SE = 0.08,\ t(2.45) = 70.4,\ p=0.017\)</span>), and that this was increased for those following the five-two diet (<span class="math inline">\(\beta = 0.38,\ SE = 0.1,\ t(3.75) = 73.64,\ p&lt;0.001\)</span>). Although for those not on a specific diet there was no evidence for an association between irritability and being generally a more hungry person (<span class="math inline">\(p=0.971\)</span>), there a significant interaction was found between average hunger and being on the five-two diet (<span class="math inline">\(\beta = 0.47,\ SE = 0.14,\ t(3.44) = 77,\ p&lt;0.001\)</span>), suggesting that when dieting, hungrier people tend to be more irritable than less hungry people.<br>
Results suggest that the ‘hangry hypothesis’ may occur <em>within</em> people (when a person is more hungry than they usually are, they tend to be more irritable), but not necessarily between hungry/less hungry people. Dieting was found to increase the association of both between-person hunger and within-person hunger with irritability.</p>
</div>
<p class="solution-end">
</p>
<div class="statbox">
<p><strong>Other within-group transformations</strong></p>
<p>As well as within-group mean centering a predictor (like we have done above), we can within-group <em>standardise</em> a predictor. This would disagregate within and between effects, but interpretation would of the within effect would be the estimated change in <span class="math inline">\(y\)</span> associated with being 1 standard deviation higher in <span class="math inline">\(x\)</span> <em>for that group</em>.</p>
</div>
<p><br></p>
</section>
<section id="optional-exercises-logistic-mlm" class="level1">
<h1>Optional Exercises: Logistic MLM</h1>
<div class="frame">
<p><strong>Don’t forget to look back at other materials!</strong></p>
<p>Back in DAPR2, we introduced logistic regression in semester 2, week 8. The lab contained some simulated data based on a hypothetical study <a href="https://uoepsy.github.io/dapr2/2122/labs/2_07_binary.html">about inattentional blindness</a>. That content will provide a lot of the groundwork for this week, so we recommend revisiting it if you feel like it might be useful.</p>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
From <code>lmer()</code> to <code>glmer()</code>
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Remember how we simply used <code>glm()</code> and could specify the <code>family = "binomial"</code> in order to fit a logistic regression? Well it’s much the same thing for multi-level models!</p>
<ul>
<li>Gaussian model: <code>lmer(y ~ x1 + x2 + (1 | g), data = data)</code><br>
</li>
<li>Binomial model: <code>glmer(y ~ x1 + x2 + (1 | g), data = data, family = binomial(link='logit'))</code>
<ul>
<li>or just <code>glmer(y ~ x1 + x2 + (1 | g), data = data, family = "binomial")</code></li>
<li>or <code>glmer(y ~ x1 + x2 + (1 | g), data = data, family = binomial)</code></li>
</ul></li>
</ul>
</div>
</div>
</div>
<!-- 

<div class="optional-begin"><button id='opt-start-8' class="fa-solid fa-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-8', 'opt-start-8')"> Binary? Binomial? </button></div><div class="optional-body" id = "opt-body-8" style="display: none;">

 -->
<!-- For binary regression, all the data in our outcome variable has to be a 0 or a 1.   -->
<!-- For example, the `correct` variable below:   -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- tibble(participant = c(1,1,1),question=c(1,2,3),correct=c(1,0,1)) %>% rbind(rep("...",3)) %>% -->
<!--   gt::gt() -->
<!-- ``` -->
<!-- But we can re-express this information in a different way, when we know the total number of questions asked. -->
<!-- ```{r} -->
<!-- #| echo: false -->
<!-- tibble(participant = c(1,2,3),questions_correct=c(2,1,3),questions_incorrect=c(1,2,0)) %>% rbind(rep("...",3)) %>% gt::gt() -->
<!-- ``` -->
<!-- To model data when it is in this form, we can express our outcome as `cbind(questions_correct, questions_incorrect)` -->
<!-- 

</div><p class="optional-end"></p>

 -->
<div class="frame">
<p><strong>Data: Memory Recall &amp; Finger Tapping</strong></p>
<blockquote class="blockquote">
<p><strong>Research Question:</strong> After accounting for effects of sentence length, does the rhythmic tapping of fingers aid memory recall?</p>
</blockquote>
<p>Researchers recruited 40 participants. Each participant was tasked with studying and then recalling 10 randomly generated sentences between 1 and 14 words long. For 5 of these sentences, participants were asked to tap their fingers along with speaking the sentence in both the study period and in the recall period. For the remaining 5 sentences, participants were asked to sit still.<br>
The data are available at <a href="https://uoepsy.github.io/data/memorytap.csv">https://uoepsy.github.io/data/memorytap.csv</a>, and contains information on the length (in words) of each sentence, the condition (static vs tapping) under which it was studied and recalled, and whether the participant was correct in recalling it.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">

<div id="hgzrdttihd" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#hgzrdttihd table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#hgzrdttihd thead, #hgzrdttihd tbody, #hgzrdttihd tfoot, #hgzrdttihd tr, #hgzrdttihd td, #hgzrdttihd th {
  border-style: none;
}

#hgzrdttihd p {
  margin: 0;
  padding: 0;
}

#hgzrdttihd .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#hgzrdttihd .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#hgzrdttihd .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#hgzrdttihd .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#hgzrdttihd .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hgzrdttihd .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hgzrdttihd .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#hgzrdttihd .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#hgzrdttihd .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#hgzrdttihd .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#hgzrdttihd .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#hgzrdttihd .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#hgzrdttihd .gt_spanner_row {
  border-bottom-style: hidden;
}

#hgzrdttihd .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#hgzrdttihd .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#hgzrdttihd .gt_from_md > :first-child {
  margin-top: 0;
}

#hgzrdttihd .gt_from_md > :last-child {
  margin-bottom: 0;
}

#hgzrdttihd .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#hgzrdttihd .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#hgzrdttihd .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#hgzrdttihd .gt_row_group_first td {
  border-top-width: 2px;
}

#hgzrdttihd .gt_row_group_first th {
  border-top-width: 2px;
}

#hgzrdttihd .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hgzrdttihd .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#hgzrdttihd .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#hgzrdttihd .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hgzrdttihd .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#hgzrdttihd .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#hgzrdttihd .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#hgzrdttihd .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#hgzrdttihd .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#hgzrdttihd .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hgzrdttihd .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hgzrdttihd .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#hgzrdttihd .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#hgzrdttihd .gt_left {
  text-align: left;
}

#hgzrdttihd .gt_center {
  text-align: center;
}

#hgzrdttihd .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#hgzrdttihd .gt_font_normal {
  font-weight: normal;
}

#hgzrdttihd .gt_font_bold {
  font-weight: bold;
}

#hgzrdttihd .gt_font_italic {
  font-style: italic;
}

#hgzrdttihd .gt_super {
  font-size: 65%;
}

#hgzrdttihd .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#hgzrdttihd .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#hgzrdttihd .gt_indent_1 {
  text-indent: 5px;
}

#hgzrdttihd .gt_indent_2 {
  text-indent: 10px;
}

#hgzrdttihd .gt_indent_3 {
  text-indent: 15px;
}

#hgzrdttihd .gt_indent_4 {
  text-indent: 20px;
}

#hgzrdttihd .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="variable">variable</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="1" colspan="1" scope="col" id="description">description</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="variable" class="gt_row gt_left">ppt</td>
<td headers="description" class="gt_row gt_left">Participant Identifier (n=40)</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">slength</td>
<td headers="description" class="gt_row gt_left">Number of words in sentence</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">condition</td>
<td headers="description" class="gt_row gt_left">Condition under which sentence is studied and recalled ('static' = sitting still, 'tap' = tapping fingers along to sentence)</td></tr>
    <tr><td headers="variable" class="gt_row gt_left">correct</td>
<td headers="description" class="gt_row gt_left">Whether or not the sentence was correctly recalled</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
</div>
<div class="question-begin">
Question Optional
</div>
<div class="question-body">
<blockquote class="blockquote">
<p><strong>Research Question:</strong> After accounting for effects of sentence length, does the rhythmic tapping of fingers aid memory recall?</p>
</blockquote>
<p>Fit an appropriate model to answer the research question.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Hints
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>our outcome is conceptually ‘memory recall’, and it’s been measured by “Whether or not a sentence was correctly recalled”. This is a binary variable.<br>
</li>
<li>we have multiple observations for each <em>????</em>?<br>
This will define our <code>(  | ??? )</code> bit</li>
</ul>
</div>
</div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-9" class="fa-solid fa-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-9', 'sol-start-9')">
Solution
</button>
</div>
<div id="sol-body-9" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>memtap <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/memorytap.csv"</span>)</span></code></pre></div>
</div>
<p>When we fit the maximal model, note that we obtain a singular fit. The variance of the slength effect between participants is quite small relative to the others, and there is a correlation between it and the random intercepts.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>tapmod <span class="ot">&lt;-</span> <span class="fu">glmer</span>(correct <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> slength <span class="sc">+</span> condition <span class="sc">+</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>                  (<span class="dv">1</span> <span class="sc">+</span> slength <span class="sc">+</span> condition <span class="sc">|</span> ppt),</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> memtap,</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">isSingular</span>(tapmod)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VarCorr</span>(tapmod)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Groups Name         Std.Dev. Corr         
 ppt    (Intercept)  1.032849              
        slength      0.070307 -1.000       
        conditiontap 0.665626  0.590 -0.590</code></pre>
</div>
</div>
<p>let’s remove the random effect of <code>slength | ppt</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>tapmod2 <span class="ot">&lt;-</span> <span class="fu">glmer</span>(correct <span class="sc">~</span> <span class="dv">1</span> <span class="sc">+</span> slength <span class="sc">+</span> condition <span class="sc">+</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                  (<span class="dv">1</span> <span class="sc">+</span> condition <span class="sc">|</span> ppt),</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> memtap,</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">family =</span> binomial)</span></code></pre></div>
</div>
<p>the model now looks a bit better (not a singular fit):</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tapmod2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Generalized linear mixed model fit by maximum likelihood (Laplace
  Approximation) [glmerMod]
 Family: binomial  ( logit )
Formula: correct ~ 1 + slength + condition + (1 + condition | ppt)
   Data: memtap

     AIC      BIC   logLik deviance df.resid 
   537.6    561.5   -262.8    525.6      394 

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-1.8949 -0.8955  0.4483  0.7962  1.6862 

Random effects:
 Groups Name         Variance Std.Dev. Corr
 ppt    (Intercept)  0.2755   0.5249       
        conditiontap 0.4207   0.6486   0.66
Number of obs: 400, groups:  ppt, 40

Fixed effects:
             Estimate Std. Error z value Pr(&gt;|z|)  
(Intercept)   0.76140    0.37077   2.054   0.0400 *
slength      -0.12086    0.04721  -2.560   0.0105 *
conditiontap  0.50945    0.24317   2.095   0.0362 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) slngth
slength     -0.890       
conditiontp -0.154 -0.029</code></pre>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
From Log odds to odds ratios
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Take some time to remind yourself from DAPR2 of the <a href="https://uoepsy.github.io/dapr2/2223/lectures/dapR2_16_binarylogistic.html#37">interpretation of logistic regression coefficients</a>.</p>
<p>In <code>family = binomial(link='logit')</code>, we are modelling the log-odds. We can obtain estimates on this scale using:</p>
<ul>
<li><code>fixef(model)</code></li>
<li><code>summary(model)$coefficients</code></li>
<li><code>tidy(model)</code> <strong>from broom.mixed</strong><br>
</li>
<li>(there are probably more ways, but I can’t think of them right now!)</li>
</ul>
<p>We can use <code>exp()</code>, to get these back into odds and odds ratios.</p>
</div>
</div>
</div>
<div class="question-begin">
Question Optional
</div>
<div class="question-body">
<p>Interpret each of the fixed effect estimates from your model.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-10" class="fa-solid fa-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-10', 'sol-start-10')">
Solution
</button>
</div>
<div id="sol-body-10" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(tapmod2)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)      slength conditiontap 
   0.7613976   -0.1208591    0.5094460 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="fu">fixef</span>(tapmod2))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> (Intercept)      slength conditiontap 
   2.1412669    0.8861589    1.6643689 </code></pre>
</div>
</div>
<ul>
<li><code>(Intercept)</code>: For an sentence with zero words, when sitting statically, the odds of correctly recalling the sentence are 2.14. This is equivalent to a <span class="math inline">\(\frac{2.14}{1 + 2.14} = 0.6815287\)</span> probability of getting it correct.<br>
</li>
<li><code>slength</code>: After accounting for differences due to tapping/not-tapping during study &amp; recall, for every 1 word longer a sentence is, the odds of correctly recalling the sentence is decreased by 0.89.</li>
<li><code>conditiontap</code>: After accounting for differences in recall due to sentence length, finger tapping during the study and recall of sentences was associated with 1.66 increased odds correct recall in comparison to sitting still.</li>
</ul>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question Optional
</div>
<div class="question-body">
<p>Checking the assumptions in non-gaussian models in general (i.e.&nbsp;those where we set the <code>family</code> to some other error distribution) can be a bit tricky, and this is especially true for multilevel models.</p>
<p>For the logistic MLM, the standard assumptions of normality etc for our Level 1 residuals <code>residuals(model)</code> do not hold. However, it is still useful to quickly plot the residuals and check that <span class="math inline">\(|residuals|\leq 2\)</span> (or <span class="math inline">\(|residuals|\leq 3\)</span> if you’re more relaxed). We don’t need to worry too much about the pattern though.</p>
<p>While we’re more relaxed about Level 1 residuals, we <em>do</em> still want our random effects <code>ranef(model)</code> to look fairly normally distributed.</p>
<ol type="1">
<li>Plot the level 1 residuals and check whether any are greater than 3 in magnitude</li>
<li>Plot the random effects (the level 2 residuals) and assess the normality.</li>
</ol>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-11" class="fa-solid fa-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-11', 'sol-start-11')">
Solution
</button>
</div>
<div id="sol-body-11" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(tapmod2)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_centerglmer_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">abs</span>(<span class="fu">resid</span>(tapmod2))<span class="sc">&gt;</span><span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<p>All residuals are between -3 and 3.</p>
<p>The random effects look <em>okay</em> here. Not perfect, but bear in mind we have only 40 participants.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">ranef</span>(tapmod2)<span class="sc">$</span>ppt[, <span class="dv">1</span>], <span class="at">main =</span> <span class="st">"Random intercept"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">ranef</span>(tapmod2)<span class="sc">$</span>ppt[, <span class="dv">1</span>])</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">ranef</span>(tapmod2)<span class="sc">$</span>ppt[, <span class="dv">2</span>], <span class="at">main =</span> <span class="st">"Random slope of condition"</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">ranef</span>(tapmod2)<span class="sc">$</span>ppt[, <span class="dv">2</span>])</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">ranef</span>(tapmod2)<span class="sc">$</span>ppt[, <span class="dv">1</span>])</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(<span class="fu">ranef</span>(tapmod2)<span class="sc">$</span>ppt[, <span class="dv">2</span>])</span></code></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="04_centerglmer_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
for beyond DAPR3
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<ul>
<li>The <strong>HLMdiag</strong> package doesn’t support diagnosing influential points/clusters for <code>glmer</code>, but there is a package called <strong>influence.me</strong> which might help: <a href="https://journal.r-project.org/archive/2012/RJ-2012-011/RJ-2012-011.pdf" target="_blank">https://journal.r-project.org/archive/2012/RJ-2012-011/RJ-2012-011.pdf</a></li>
<li>There are packages which aim to create more interpretable residual plots for these models via simulation, such as the <strong>DHARMa</strong> package: <a href="https://cran.r-project.org/web/packages/DHARMa/vignettes/DHARMa.html" target="_blank">https://cran.r-project.org/web/packages/DHARMa/vignettes/DHARMa.html</a></li>
</ul>
</div>
</div>
</div>
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;">

</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>