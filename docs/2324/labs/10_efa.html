<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DAPR3 - 10. Exploratory Factor Analysis (EFA): Part 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script>
function toggle_visibility(id1, id2) {
var e = document.getElementById(id1);
var f = document.getElementById(id2);
e.style.display = ((e.style.display!='none') ? 'none' : 'block');
if(f.classList.contains('jk-circle-right')) {
    f.classList.add('jk-circle-down')
    f.classList.remove('jk-circle-right')
} else {
    f.classList.add('jk-circle-right')
    f.classList.remove('jk-circle-down')
}
}
</script>
<link href="site_libs/panelset-0.2.6/panelset.css" rel="stylesheet">
<script src="site_libs/panelset-0.2.6/panelset.js"></script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07_path1.html">Path Analysis and Data Reduction</a></li><li class="breadcrumb-item"><a href="./10_efa.html">10. EFA I</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">DAPR3</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Multilevel Models</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01_regressionrefresh.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Regression Refresh | Clustered Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02_intromlm.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Intro to Multilevel Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03_assumptcent.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Assumptions and Diagnostics | Centering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04_ranefglmer.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Random Effect Structures | Logistic MLM</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05_recap.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Recap &amp; Practice Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05b_lmmdatasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">LMM Datasets</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Additional Docs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./example_00_anova.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Analysis Example: Rpt &amp; Mixed ANOVA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./lvp.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Likelihood vs Probability</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">- Break Week -</span></span>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Path Analysis and Data Reduction</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07_path1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">7. Path Analysis</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08_path2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">8. Mediation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09_pca.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">9. PCA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10_efa.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">10. EFA I</span></a>
  </div>
</li>
          <li class="sidebar-item">
 <span class="menu-text">11. EFA II</span>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <span class="sidebar-item-text sidebar-link text-start">
 <span class="menu-text">Additional Docs</span></span>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#pca-vs-fa" id="toc-pca-vs-fa" class="nav-link active" data-scroll-target="#pca-vs-fa">PCA vs FA</a></li>
  <li><a href="#suitability-of-items-for-efa" id="toc-suitability-of-items-for-efa" class="nav-link" data-scroll-target="#suitability-of-items-for-efa">Suitability of items for EFA</a></li>
  <li><a href="#exercises-conduct-problems" id="toc-exercises-conduct-problems" class="nav-link" data-scroll-target="#exercises-conduct-problems">Exercises: Conduct Problems</a>
  <ul class="collapse">
  <li><a href="#check-suitability" id="toc-check-suitability" class="nav-link" data-scroll-target="#check-suitability">1. Check Suitability</a></li>
  <li><a href="#how-many-factors" id="toc-how-many-factors" class="nav-link" data-scroll-target="#how-many-factors">2. How many factors?</a></li>
  <li><a href="#perform-efa" id="toc-perform-efa" class="nav-link" data-scroll-target="#perform-efa">3. Perform EFA</a></li>
  <li><a href="#inspect" id="toc-inspect" class="nav-link" data-scroll-target="#inspect">4. Inspect</a></li>
  <li><a href="#write-up" id="toc-write-up" class="nav-link" data-scroll-target="#write-up">5. Write-up</a></li>
  </ul></li>
  <li><a href="#pca-efa-comparison-exercise" id="toc-pca-efa-comparison-exercise" class="nav-link" data-scroll-target="#pca-efa-comparison-exercise">PCA &amp; EFA Comparison Exercise</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">10. Exploratory Factor Analysis (EFA): Part 1</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="lo">
<p><strong>Relevant packages</strong></p>
<ul>
<li>psych</li>
<li>GPArotation</li>
</ul>
</div>
<section id="pca-vs-fa" class="level1">
<h1>PCA vs FA</h1>
<p>Where <strong>PCA</strong> aims to summarise a set of measured variables into a set of orthogonal (uncorrelated) components as linear combinations (a weighted average) of the measured variables, <strong>Factor Analysis (FA)</strong> assumes that the relationships between a set of measured variables can be explained by a number of underlying <em>latent factors</em>.</p>
<p>Note how the directions of the arrows in <a href="#fig-pcafa">Figure&nbsp;1</a> are different between PCA and FA - in PCA, each component <span class="math inline">\(C_i\)</span> is the weighted combination of the observed variables <span class="math inline">\(y_1, ...,y_n\)</span>, whereas in FA, each measured variable <span class="math inline">\(y_i\)</span> is seen as <em>generated by</em> some latent factor(s) <span class="math inline">\(F_i\)</span> plus some unexplained variance <span class="math inline">\(u_i\)</span>.</p>
<p>It might help to read the <span class="math inline">\(\lambda\)</span>s as beta-weights (<span class="math inline">\(b\)</span>, or <span class="math inline">\(\beta\)</span>), because that’s all they really are. The equation <span class="math inline">\(y_i = \lambda_{1i} F_1 + \lambda_{2i} F_2 + u_i\)</span> is just our way of saying that the variable <span class="math inline">\(y_i\)</span> is the manifestation of some amount (<span class="math inline">\(\lambda_{1i}\)</span>) of an underlying factor <span class="math inline">\(F_1\)</span>, some amount (<span class="math inline">\(\lambda_{2i}\)</span>) of some other underlying factor <span class="math inline">\(F_2\)</span>, and some error (<span class="math inline">\(u_i\)</span>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-pcafa" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/pcaefa/pca_efa.png" class="img-fluid figure-img" width="1000"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Path diagrams for PCA and FA</figcaption>
</figure>
</div>
</div>
</div>
<p>In <strong><em>Exploratory</em> Factor Analysis (EFA)</strong>, we are starting with no hypothesis about either the number of latent factors or about the specific relationships between latent factors and measured variables (known as the <em>factor structure</em>). Typically, all variables will load on all factors, and a transformation method such as a rotation (we’ll cover this in more detail below) is used to help make the results more easily interpretable.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</section>
<section id="suitability-of-items-for-efa" class="level1">
<h1>Suitability of items for EFA</h1>
<p>There are various ways of assessing the suitability of our items for exploratory factor analysis, and most of them rely on examining the observed correlations between items.</p>
<div class="statbox">
<p><strong>Look at the correlation matrix</strong></p>
<p>Use a function such as <code>cor</code> or <code>corr.test(data)</code> (from the <strong>psych</strong> package) to create the correlation matrix.</p>
</div>
<div class="statbox">
<p><strong>Bartlett’s Test</strong></p>
<p>The function <code>cortest.bartlett(cor(data), n = nrow(data))</code> conducts “Bartlett’s test”. This tests against the null that the correlation matrix is proportional to the identity matrix (a matrix of all 0s except for 1s on the diagonal).</p>
<ul>
<li>Null hypothesis: observed correlation matrix is equivalent to the identity matrix<br>
</li>
<li>Alternative hypothesis: observed correlation matrix is not equivalent to the identity matrix.</li>
</ul>
<div class="optional-begin">
<button id="opt-start-1" class="jk-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-1', 'opt-start-1')">
What is the identity matrix?
</button>
</div>
<div id="opt-body-1" class="optional-body" style="display: none;">
<p>The “Identity matrix” is a matrix of all 0s except for 1s on the diagonal.<br>
e.g.&nbsp;for a 3x3 matrix:<br>
<span class="math display">\[
\begin{bmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
\end{bmatrix}
\]</span> If a correlation matrix looks like this, then it means there is <strong>no</strong> shared variance between the items, so it is not suitable for factor analysis</p>
</div>
<p class="optional-end">
</p>
</div>
<div class="statbox">
<p><strong>Kaiser, Meyer, Olkin Measure of Sampling Adequacy</strong></p>
<p>You can check the “factorability” of the correlation matrix using <code>KMO(data)</code> (also from <strong>psych</strong>!).</p>
<ul>
<li>Rules of thumb:
<ul>
<li><span class="math inline">\(0.8 &lt; MSA &lt; 1\)</span>: the sampling is adequate</li>
<li><span class="math inline">\(MSA &lt;0.6\)</span>: sampling is not adequate</li>
<li><span class="math inline">\(MSA \sim 0\)</span>: large partial correlations compared to the sum of correlations. Not good for FA</li>
</ul></li>
</ul>
<div class="optional-begin">
<button id="opt-start-2" class="jk-circle-right optional-icon clickable" onclick="toggle_visibility('opt-body-2', 'opt-start-2')">
Optional Kaiser’s suggested cuts
</button>
</div>
<div id="opt-body-2" class="optional-body" style="display: none;">
<p>These are Kaiser’s corresponding adjectives suggested for each level of the KMO:</p>
<ul>
<li>0.00 to 0.49 “unacceptable”<br>
</li>
<li>0.50 to 0.59 “miserable”<br>
</li>
<li>0.60 to 0.69 “mediocre”<br>
</li>
<li>0.70 to 0.79 “middling”<br>
</li>
<li>0.80 to 0.89 “meritorious”<br>
</li>
<li>0.90 to 1.00 “marvelous”</li>
</ul>
</div>
<p class="optional-end">
</p>
</div>
<div class="statbox">
<p><strong>Check for linearity</strong></p>
<p>It also makes sense to check for linearity of relationships prior to conducting EFA. EFA is all based on correlations, which assume the relations we are capturing are linear.</p>
<p>You can check linearity of relations using <code>pairs.panels(data)</code> (also from <strong>psych</strong>), and you can view the histograms on the diagonals, allowing you to check univariate normality (which is usually a good enough proxy for multivariate normality).</p>
</div>
</section>
<section id="exercises-conduct-problems" class="level1">
<h1>Exercises: Conduct Problems</h1>
<div class="frame">
<p><strong>Data: Conduct Problems</strong></p>
<p>A researcher is developing a new brief measure of Conduct Problems. She has collected data from n=450 adolescents on 10 items, which cover the following behaviours:</p>
<ol type="1">
<li>Stealing</li>
<li>Lying</li>
<li>Skipping school</li>
<li>Vandalism</li>
<li>Breaking curfew</li>
<li>Threatening others</li>
<li>Bullying</li>
<li>Spreading malicious rumours</li>
<li>Using a weapon</li>
<li>Fighting</li>
</ol>
<p>Your task is to use the dimension reduction techniques you learned about in the lecture to help inform how to organise the items she has developed into subscales.</p>
<p>The data can be found at https://uoepsy.github.io/data/conduct_probs.csv</p>
</div>
<section id="check-suitability" class="level2">
<h2 class="anchored" data-anchor-id="check-suitability">1. Check Suitability</h2>
<div class="question-begin">
Question 1
</div>
<div class="question-body">
<p>Read in the dataset from <a href="https://uoepsy.github.io/data/conduct_probs.csv">https://uoepsy.github.io/data/conduct_probs.csv</a>.<br>
The first column is clearly an ID column, and it is easiest just to discard this when we are doing factor analysis.</p>
<p>Create a correlation matrix for <em>the items</em>.<br>
Inspect the items to check their suitability for exploratory factor analysis.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-3" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-3', 'sol-start-3')">
Solution
</button>
</div>
<div id="sol-body-3" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"https://uoepsy.github.io/data/conduct_probs.csv"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># discard the first column</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> df[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">corr.test</span>(df)  </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:corr.test(x = df)
Correlation matrix 
       item1 item2 item3 item4 item5 item6 item7 item8 item9 item10
item1   1.00  0.59  0.49  0.48  0.60  0.17  0.30  0.32  0.26   0.20
item2   0.59  1.00  0.53  0.51  0.66  0.20  0.33  0.30  0.29   0.19
item3   0.49  0.53  1.00  0.49  0.55  0.15  0.25  0.24  0.25   0.15
item4   0.48  0.51  0.49  1.00  0.65  0.23  0.29  0.32  0.28   0.25
item5   0.60  0.66  0.55  0.65  1.00  0.21  0.30  0.29  0.27   0.21
item6   0.17  0.20  0.15  0.23  0.21  1.00  0.54  0.57  0.41   0.44
item7   0.30  0.33  0.25  0.29  0.30  0.54  1.00  0.83  0.61   0.58
item8   0.32  0.30  0.24  0.32  0.29  0.57  0.83  1.00  0.61   0.59
item9   0.26  0.29  0.25  0.28  0.27  0.41  0.61  0.61  1.00   0.44
item10  0.20  0.19  0.15  0.25  0.21  0.44  0.58  0.59  0.44   1.00
Sample Size 
[1] 450
Probability values (Entries above the diagonal are adjusted for multiple tests.) 
       item1 item2 item3 item4 item5 item6 item7 item8 item9 item10
item1      0     0     0     0     0     0     0     0     0      0
item2      0     0     0     0     0     0     0     0     0      0
item3      0     0     0     0     0     0     0     0     0      0
item4      0     0     0     0     0     0     0     0     0      0
item5      0     0     0     0     0     0     0     0     0      0
item6      0     0     0     0     0     0     0     0     0      0
item7      0     0     0     0     0     0     0     0     0      0
item8      0     0     0     0     0     0     0     0     0      0
item9      0     0     0     0     0     0     0     0     0      0
item10     0     0     0     0     0     0     0     0     0      0

 To see confidence intervals of the correlations, print with the short=FALSE option</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cortest.bartlett</span>(<span class="fu">cor</span>(df), <span class="at">n=</span><span class="dv">450</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$chisq
[1] 2238

$p.value
[1] 0

$df
[1] 45</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">KMO</span>(df)  </span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Kaiser-Meyer-Olkin factor adequacy
Call: KMO(r = df)
Overall MSA =  0.87
MSA for each item = 
 item1  item2  item3  item4  item5  item6  item7  item8  item9 item10 
  0.90   0.88   0.92   0.88   0.84   0.94   0.82   0.81   0.95   0.94 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs.panels</span>(df)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="10_efa_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
<p>or alternatively, if you want a ggplot based approach:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(<span class="at">data=</span>df, <span class="at">diag=</span><span class="fu">list</span>(<span class="at">continuous=</span><span class="st">"density"</span>), <span class="at">axisLabels=</span><span class="st">"show"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="10_efa_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
</section>
<section id="how-many-factors" class="level2">
<h2 class="anchored" data-anchor-id="how-many-factors">2. How many factors?</h2>
<div class="question-begin">
Question 2
</div>
<div class="question-body">
<p>How many dimensions should be retained? This question can be answered in the same way as we did above for PCA.</p>
<p>Use a scree plot, parallel analysis, and MAP test to guide you.<br>
You can use <code>fa.parallel(data, fm = "fa")</code> to conduct both parallel analysis and view the scree plot!</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-4" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-4', 'sol-start-4')">
Solution
</button>
</div>
<div id="sol-body-4" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fa.parallel</span>(df, <span class="at">fa =</span> <span class="st">"fa"</span>)</span></code></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="10_efa_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Parallel analysis suggests that the number of factors =  2  and the number of components =  NA </code></pre>
</div>
</div>
<p>In this case the scree plot has a kink at the third factor, so we probably want to retain 2 factors.</p>
<p>We can conduct the MAP test using <code>VSS(data)</code>.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">VSS</span>(df, <span class="at">plot =</span> <span class="cn">FALSE</span>, <span class="at">n =</span> <span class="fu">ncol</span>(df))<span class="sc">$</span>map</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.1058 0.0338 0.0576 0.1035 0.1494 0.2520 0.3974 0.4552 1.0000     NA</code></pre>
</div>
</div>
<p>The MAP test suggests retaining 2 factors.</p>
</div>
<p class="solution-end">
</p>
</section>
<section id="perform-efa" class="level2">
<h2 class="anchored" data-anchor-id="perform-efa">3. Perform EFA</h2>
<p>Now we need to perform the factor analysis. But there are two further things we need to consider, and they are:</p>
<ol type="a">
<li>whether we want to apply a <strong>rotation</strong> to our factor loadings, in order to make them easier to interpret, and<br>
</li>
<li>how do we want to extract our factors (it turns out there are loads of different approaches!).</li>
</ol>
<div class="statbox">
<p><strong>Rotations?</strong></p>
<p>Rotations are so called because they transform our loadings matrix in such a way that it can make it more easy to interpret. You can think of it as a transformation applied to our loadings in order to optimise interpretability, by maximising the loading of each item onto one factor, while minimising its loadings to others. We can do this by simple rotations, but maintaining our axes (the factors) as perpendicular (i.e., uncorrelated) as in <a href="#fig-rot2">Figure&nbsp;3</a>, or we can allow them to be transformed beyond a rotation to allow the factors to correlate (<a href="#fig-rot3">Figure&nbsp;4</a>).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-rot1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/pcaefa/rot1.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;2: No rotation</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-rot2" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/pcaefa/rot2.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;3: Orthogonal rotation</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-rot3" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/pcaefa/rot3.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption class="figure-caption">Figure&nbsp;4: Oblique rotation</figcaption>
</figure>
</div>
</div>
</div>
<p>In our path diagram of the model (<a href="#fig-efarot">Figure&nbsp;5</a>), all the factor loadings remain present, but some of them become negligible. We can also introduce the possible correlation between our factors, as indicated by the curved arrow between <span class="math inline">\(F_1\)</span> and <span class="math inline">\(F_2\)</span>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-efarot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="images/pcaefa/efa_rot.png" class="img-fluid figure-img" width="1000"></p>
<figcaption class="figure-caption">Figure&nbsp;5: Path diagrams for EFA with rotation</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div class="frame">
<p><strong>Factor Extraction</strong></p>
<p>PCA (using eigendecomposition) is itself a method of extracting the different dimensions from our data. However, there are lots more available for factor analysis.</p>
<p>You can find a lot of discussion about different methods both in the help documentation for the <code>fa()</code> function from the psych package:</p>
<blockquote class="blockquote">
<p>Factoring method fm=“minres” will do a minimum residual as will fm=“uls”. Both of these use a first derivative. fm=“ols” differs very slightly from “minres” in that it minimizes the entire residual matrix using an OLS procedure but uses the empirical first derivative. This will be slower. fm=“wls” will do a weighted least squares (WLS) solution, fm=“gls” does a generalized weighted least squares (GLS), fm=“pa” will do the principal factor solution, fm=“ml” will do a maximum likelihood factor analysis. fm=“minchi” will minimize the sample size weighted chi square when treating pairwise correlations with different number of subjects per pair. fm =“minrank” will do a minimum rank factor analysis. “old.min” will do minimal residual the way it was done prior to April, 2017 (see discussion below). fm=“alpha” will do alpha factor analysis as described in Kaiser and Coffey (1965)</p>
</blockquote>
<p>And there are lots of discussions both in papers and on <a href="https://stats.stackexchange.com/questions/50745/best-factor-extraction-methods-in-factor-analysis">forums</a>.</p>
<p>As you can see, this is a complicated issue, but when you have a large sample size, a large number of variables, for which you have similar communalities, then the extraction methods tend to agree. For now, don’t fret too much about the factor extraction method.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
</div>
<div class="question-begin">
Question 3
</div>
<div class="question-body">
<p>Use the function <code>fa()</code> from the <strong>psych</strong> package to conduct and EFA to extract 2 factors (this is what <em>we</em> suggest based on the various tests above, but <em>you</em> might feel differently - the ideal number of factors is subjective!). Use a suitable rotation (<code>rotate = ?</code>) and extraction method (<code>fm = ?</code>).</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>conduct_efa <span class="ot">&lt;-</span> <span class="fu">fa</span>(data, <span class="at">nfactors =</span> ?, <span class="at">rotate =</span> ?, <span class="at">fm =</span> ?)</span></code></pre></div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-5" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-5', 'sol-start-5')">
Solution
</button>
</div>
<div id="sol-body-5" class="solution-body" style="display: none;">
<p>For example, you could choose an oblimin rotation to allow factors to correlate and use minres as the extraction method.</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>conduct_efa <span class="ot">&lt;-</span> <span class="fu">fa</span>(df, <span class="at">nfactors=</span><span class="dv">2</span>, <span class="at">rotate=</span><span class="st">'oblimin'</span>, <span class="at">fm=</span><span class="st">"minres"</span>)</span></code></pre></div>
</div>
</div>
<p class="solution-end">
</p>
</section>
<section id="inspect" class="level2">
<h2 class="anchored" data-anchor-id="inspect">4. Inspect</h2>
<p>We can simply print the name of our model in order to see a lot of information. Let’s go through it in pieces.</p>
<div class="statbox">
<p><strong>Loadings</strong></p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Factor Analysis using method =  minres
Call: fa(r = df, nfactors = 2, rotate = "oblimin", fm = "minres")
Standardized loadings (pattern matrix) based upon correlation matrix
         MR1   MR2   h2   u2 com
item1   0.03  0.71 0.52 0.48   1
item2   0.01  0.77 0.60 0.40   1
item3  -0.02  0.68 0.45 0.55   1
item4   0.06  0.68 0.50 0.50   1
item5  -0.04  0.87 0.73 0.27   1
item6   0.63 -0.02 0.39 0.61   1
item7   0.89  0.00 0.80 0.20   1
item8   0.92 -0.01 0.84 0.16   1
item9   0.63  0.09 0.45 0.55   1
item10  0.67 -0.03 0.43 0.57   1</code></pre>
</div>
</div>
<p>Factor loading’s, like PCA loading’s, show the relationship of each measured variable to each factor. They range between -1.00 and 1.00 Larger absolute values represent stronger relationship between measured variable and factor.</p>
<ul>
<li>The columns that (depending upon estimation method) might be called <code>MR</code>/<code>ML</code>/<code>PC</code> are the factors. The number assigned to is arbitrary, and they might not always be in a numeric order (this has to do with a rotated solution). Typically, the numbering maps to how much variance each factor account for.</li>
<li><strong>h2:</strong> This is the “communality”, which is how much variance in the item is explained by the factors. It is calculated as the sum of the squared loadings.<br>
</li>
<li><strong>u2:</strong> This is <span class="math inline">\(1 - h2\)</span>. It is the residual variance, or the “uniqueness” for that item (i.e.&nbsp;the amount left unexplained).<br>
</li>
<li><strong>com:</strong> This is the “Item complexity”. It tells us how much a given item reflects a single factor (vs being “more complex” in that it represents multiple factors). It equals one if an item loads only on one factor, 2 if evenly loads on two factors, etc.</li>
</ul>
<p>You can get these on their own using</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>conduct_efa<span class="sc">$</span>loadings</span></code></pre></div>
</div>
</div>
<div class="statbox">
<p><strong>Variance Accounted For</strong></p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>                       MR1  MR2
SS loadings           2.92 2.80
Proportion Var        0.29 0.28
Cumulative Var        0.29 0.57
Proportion Explained  0.51 0.49
Cumulative Proportion 0.51 1.00</code></pre>
</div>
</div>
<p>Below the factor loadings, we have a familiar set of measures of the variance in the data accounted for by each factor. This is very similar to what we saw with PCA.</p>
<ul>
<li>SS loadings: The sum of the squared loadings. The eigenvalues.<br>
</li>
<li>Proportion Var: how much of the overall variance the factor accounts for out of all the variables.</li>
<li>Cumulative Var: cumulative sum of Proportion Var.</li>
<li>Proportion Explained: relative amount of variance explained (<span class="math inline">\(\frac{\text{Proportion Var}}{\text{sum(Proportion Var)}}\)</span>.</li>
<li>Cumulative Proportion: cumulative sum of Proportion Explained.</li>
</ul>
<p>You can get these on their own using</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>conduct_efa<span class="sc">$</span>Vaccounted</span></code></pre></div>
</div>
</div>
<div class="statbox">
<p><strong>Factor Correlations</strong></p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>
 With factor correlations of 
     MR1  MR2
MR1 1.00 0.43
MR2 0.43 1.00

Mean item complexity =  1</code></pre>
</div>
</div>
<p>Whether we see this section will depend if we have run a factor analysis with <span class="math inline">\(\geq 2\)</span> factors and a rotation.</p>
<ul>
<li><code>factor correlations</code>: shows the correlation matrix between the factors.</li>
<li><code>mean item complexity</code>: shows the mean of the <code>com</code> column from the loadings above.</li>
</ul>
<p>You can get these on their own using</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>conduct_efa<span class="sc">$</span>Phi</span></code></pre></div>
</div>
</div>
<div class="statbox">
<p><strong>Tests, Fit Indices etc</strong></p>
<p>We also get a whole load of other stuff that can sometimes be useful. These include: a test of an hypothesis that the 2 factors are sufficient; information on the number of observations; fit indices such as RMSEA, TLI RMSR etc; and measures of factor score adequacy (we’ll get to talking about factor scores next week).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output cell-output-stdout">
<pre><code>Test of the hypothesis that 2 factors are sufficient.

df null model =  45  with the objective function =  5.03 with Chi Square =  2238
df of  the model are 26  and the objective function was  0.09 

The root mean square of the residuals (RMSR) is  0.02 
The df corrected root mean square of the residuals is  0.02 

The harmonic n.obs is  450 with the empirical chi square  13.7  with prob &lt;  0.98 
The total n.obs was  450  with Likelihood Chi Square =  40  with prob &lt;  0.039 

Tucker Lewis Index of factoring reliability =  0.989
RMSEA index =  0.035  and the 90 % confidence intervals are  0.008 0.055
BIC =  -119
Fit based upon off diagonal values = 1
Measures of factor score adequacy             
                                                   MR1  MR2
Correlation of (regression) scores with factors   0.96 0.94
Multiple R square of scores with factors          0.92 0.88
Minimum correlation of possible factor scores     0.84 0.76</code></pre>
</div>
</div>
</div>
<div class="question-begin">
Question 4
</div>
<div class="question-body">
<p>Inspect the loadings (<code>conduct_efa$loadings</code>) and give the factors you extracted labels based on the patterns of loadings.</p>
<p>Look back to the description of the items, and suggest a name for your factors</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-6" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-6', 'sol-start-6')">
Solution
</button>
</div>
<div id="sol-body-6" class="solution-body" style="display: none;">
<p>You can inspect the loadings using:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(conduct_efa<span class="sc">$</span>loadings, <span class="at">sort=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Loadings:
       MR1    MR2   
item6   0.634       
item7   0.890       
item8   0.924       
item9   0.629       
item10  0.669       
item1          0.706
item2          0.772
item3          0.681
item4          0.676
item5          0.872

                MR1   MR2
SS loadings    2.90 2.784
Proportion Var 0.29 0.278
Cumulative Var 0.29 0.568</code></pre>
</div>
</div>
<p>We can see that the first five items have high loadings for one factor and the second five items have high loadings for the other.</p>
<p>The first five items all have in common that they are non-aggressive forms of conduct problems, while the last five items are all aggressive behaviours. We could, therefore, label our factors: ‘non-aggressive’ and ‘aggressive’ conduct problems.</p>
</div>
<p class="solution-end">
</p>
<div class="question-begin">
Question 5
</div>
<div class="question-body">
<p>How correlated are your factors?</p>
<p>We can inspect the factor correlations (if we used an oblique rotation) using:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>conduct_efa<span class="sc">$</span>Phi</span></code></pre></div>
</div>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-7" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-7', 'sol-start-7')">
Solution
</button>
</div>
<div id="sol-body-7" class="solution-body" style="display: none;">
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>conduct_efa<span class="sc">$</span>Phi</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     MR1  MR2
MR1 1.00 0.43
MR2 0.43 1.00</code></pre>
</div>
</div>
<p>We can see here that there is a moderate correlation between the two factors. An oblique rotation would be appropriate here.</p>
</div>
<p class="solution-end">
</p>
</section>
<section id="write-up" class="level2">
<h2 class="anchored" data-anchor-id="write-up">5. Write-up</h2>
<div class="question-begin">
Question 6
</div>
<div class="question-body">
<p>Drawing on your previous answers and conducting any additional analyses you believe would be necessary to identify an optimal factor structure for the 10 conduct problems, write a brief text that summarises your method and the results from your chosen optimal model.</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-8" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-8', 'sol-start-8')">
Solution
</button>
</div>
<div id="sol-body-8" class="solution-body" style="display: none;">
<p>The main principles governing the reporting of statistical results are transparency and reproducibility (i.e., someone should be able to reproduce your analysis based on your description).</p>
<p>An example summary would be:</p>
<div class="int">
<p>First, the data were checked for their suitability for factor analysis. Normality was checked using visual inspection of histograms, linearity was checked through the inspection of the linear and lowess lines for the pairwise relations of the variables, and factorability was confirmed using a KMO test, which yielded an overall KMO of <span class="math inline">\(.87\)</span> with no variable KMOs <span class="math inline">\(&lt;.50\)</span>. An exploratory factor analysis was conducted to inform the structure of a new conduct problems test. Inspection of a scree plot alongside parallel analysis (using principal components analysis; PA-PCA) and the MAP test were used to guide the number of factors to retain. All three methods suggested retaining two factors; however, a one-factor and three-factor solution were inspected to confirm that the two-factor solution was optimal from a substantive and practical perspective, e.g., that it neither blurred important factor distinctions nor included a minor factor that would be better combined with the other in a one-factor solution. These factor analyses were conducted using minres extraction and (for the two- and three-factor solutions) an oblimin rotation, because it was expected that the factors would correlate. Inspection of the factor loadings and correlations reinforced that the two-factor solution was optimal: both factors were well-determined, including 5 loadings <span class="math inline">\(&gt;|0.3|\)</span> and the one-factor model blurred the distinction between different forms of conduct problems. The factor loadings are provided in <a href="#tbl-loadingtab">Table&nbsp;1</a><a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>. Based on the pattern of factor loadings, the two factors were labelled ‘aggressive conduct problems’ and ‘non-aggressive conduct problems’. These factors had a correlation of <span class="math inline">\(r=.43\)</span>. Overall, they accounted for 57% of the variance in the items, suggesting that a two-factor solution effectively summarised the variation in the items.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="tbl-loadingtab" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table&nbsp;1: Factor Loadings</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MR1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">MR2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">item1</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.71</td>
</tr>
<tr class="even">
<td style="text-align: left;">item2</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.77</td>
</tr>
<tr class="odd">
<td style="text-align: left;">item3</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.68</td>
</tr>
<tr class="even">
<td style="text-align: left;">item4</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">item5</td>
<td style="text-align: right;"></td>
<td style="text-align: right;">0.87</td>
</tr>
<tr class="even">
<td style="text-align: left;">item6</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">item7</td>
<td style="text-align: right;">0.89</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">item8</td>
<td style="text-align: right;">0.92</td>
<td style="text-align: right;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">item9</td>
<td style="text-align: right;">0.63</td>
<td style="text-align: right;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">item10</td>
<td style="text-align: right;">0.67</td>
<td style="text-align: right;"></td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
</div>
</div>
<p class="solution-end">
</p>
</section>
</section>
<section id="pca-efa-comparison-exercise" class="level1">
<h1>PCA &amp; EFA Comparison Exercise</h1>
<div class="question-begin">
Question 7
</div>
<div class="question-body">
<p>Using the same data, conduct a PCA using the <code>principal()</code> function.</p>
<p>What differences do you notice compared to your EFA?</p>
<p>Do you think a PCA or an EFA is more appropriate in this particular case?</p>
</div>
<p class="question-end">
</p>
<div class="solution-begin">
<button id="sol-start-9" class="jk-circle-right solution-icon clickable" onclick="toggle_visibility('sol-body-9', 'sol-start-9')">
Solution
</button>
</div>
<div id="sol-body-9" class="solution-body" style="display: none;">
<p>We can use:</p>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">principal</span>(df, <span class="at">nfactors=</span><span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Principal Components Analysis
Call: principal(r = df, nfactors = 2)
Standardized loadings (pattern matrix) based upon correlation matrix
        RC1  RC2   h2   u2 com
item1  0.17 0.77 0.62 0.38 1.1
item2  0.17 0.81 0.68 0.32 1.1
item3  0.11 0.75 0.58 0.42 1.0
item4  0.21 0.74 0.60 0.40 1.2
item5  0.16 0.85 0.75 0.25 1.1
item6  0.73 0.08 0.53 0.47 1.0
item7  0.87 0.20 0.80 0.20 1.1
item8  0.88 0.19 0.82 0.18 1.1
item9  0.72 0.21 0.56 0.44 1.2
item10 0.75 0.09 0.57 0.43 1.0

                       RC1  RC2
SS loadings           3.29 3.22
Proportion Var        0.33 0.32
Cumulative Var        0.33 0.65
Proportion Explained  0.51 0.49
Cumulative Proportion 0.51 1.00

Mean item complexity =  1.1
Test of the hypothesis that 2 components are sufficient.

The root mean square of the residuals (RMSR) is  0.06 
 with the empirical chi square  166  with prob &lt;  1.9e-22 

Fit based upon off diagonal values = 0.98</code></pre>
</div>
</div>
<p>We can see that while the loadings differ somewhat between the EFA and the PCA, the overall pattern is quite similar. This is not always the case, especially when the item communalities are low.</p>
<p>In terms of which method is more appropriate, arguably EFA would be more appropriate in this case because our researcher wishes to measure a theoretical construct (conduct problems), rather than simply reduce the dimensions of her data.</p>
</div>
<p class="solution-end">
</p>
<div class="tocify-extend-page" data-unique="tocify-extend-page" style="height: 0;">

</div>


</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>When we have some clear hypothesis about relationships between measured variables and latent factors, we might want to impose a specific factor structure on the data (e.g., items 1 to 10 all measure social anxiety, items 11 to 15 measure health anxiety, and so on). When we impose a specific factor structure, we are doing <strong>Confirmatory Factor Analysis (CFA)</strong>. This is not covered in this course, but it’s important to note that in practice EFA is not wholly “exploratory” (your theory <em>will</em> influence the decisions you make) nor is CFA wholly “confirmatory” (in which you will inevitably get tempted to explore how changing your factor structure might improve fit).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>(It’s a <em>bit</em> like the optimiser issue in the multi-level model block)<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>You should provide the table of factor loadings. It is conventional to omit factor loadings <span class="math inline">\(&lt;|0.3|\)</span>; however, be sure to ensure that you mention this in a table note.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">© Copyright 2019-2023 <a href="https://www.ed.ac.uk/">The University of Edinburgh</a>. Site licensed under the <a href="https://www.gnu.org/licenses/agpl-3.0.en.html">GNU AGPLv3</a> license.</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>



</body></html>