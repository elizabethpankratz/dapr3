<!DOCTYPE html>
<html lang="en"><head>
<script src="04assumptions_files/libs/clipboard/clipboard.min.js"></script>
<script src="04assumptions_files/libs/quarto-html/tabby.min.js"></script>
<script src="04assumptions_files/libs/quarto-html/popper.min.js"></script>
<script src="04assumptions_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="04assumptions_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="04assumptions_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="04assumptions_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="04assumptions_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.340">

  <meta name="author" content="Josiah King">
  <title>Assumptions, Diagnostics, and Centering</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="04assumptions_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="04assumptions_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #1f1c1b;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #1f1c1b; } /* Normal */
    code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
    code span.an { color: #ca60ca; } /* Annotation */
    code span.at { color: #0057ae; } /* Attribute */
    code span.bn { color: #b08000; } /* BaseN */
    code span.bu { color: #644a9b; font-weight: bold; } /* BuiltIn */
    code span.cf { color: #1f1c1b; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #924c9d; } /* Char */
    code span.cn { color: #aa5500; } /* Constant */
    code span.co { color: #898887; } /* Comment */
    code span.cv { color: #0095ff; } /* CommentVar */
    code span.do { color: #607880; } /* Documentation */
    code span.dt { color: #0057ae; } /* DataType */
    code span.dv { color: #b08000; } /* DecVal */
    code span.er { color: #bf0303; text-decoration: underline; } /* Error */
    code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
    code span.fl { color: #b08000; } /* Float */
    code span.fu { color: #644a9b; } /* Function */
    code span.im { color: #ff5500; } /* Import */
    code span.in { color: #b08000; } /* Information */
    code span.kw { color: #1f1c1b; font-weight: bold; } /* Keyword */
    code span.op { color: #ca60ca; } /* Operator */
    code span.ot { color: #006e28; } /* Other */
    code span.pp { color: #006e28; } /* Preprocessor */
    code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
    code span.sc { color: #3daee9; } /* SpecialChar */
    code span.ss { color: #ff5500; } /* SpecialString */
    code span.st { color: #bf0303; } /* String */
    code span.va { color: #0057ae; } /* Variable */
    code span.vs { color: #bf0303; } /* VerbatimString */
    code span.wa { color: #bf0303; } /* Warning */
  </style>
  <link rel="stylesheet" href="04assumptions_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link rel="stylesheet" href="img/css/wizard.css">
  <link href="04assumptions_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="04assumptions_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="04assumptions_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="04assumptions_files/libs/revealjs/plugin/reveal-attribution/attribution.css" rel="stylesheet">
  <link href="04assumptions_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script>
  $(document).ready(function() {
      $('.cell').each(function() {
          let highlightLines = $(this).attr('data-output-line-numbers');
          if (highlightLines) {
              let lines = highlightLines.split(',').map(x => parseInt(x));
              $(this).find('.cell-output-stdout pre code').html(function(_, html) {
                  return html.split('\n').map((line, index) => {
                      if (lines.includes(index + 1)) {
                          return '<span style="background-color: #D0D8FC;">' + line + '</span>';
                      } else {
                          return line;
                      }
                  }).join('\n');
              });
          }
      });
  });
  </script>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-color="#88B04B" data-background-image="img/logo.svg" data-background-position="2% 2%" data-background-size="25%" class="quarto-title-block center">
  <h1 class="title">Assumptions, Diagnostics, and Centering</h1>
  <p class="subtitle">Data Analysis for Psychology in R 3</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Josiah King 
</div>
        <p class="quarto-title-affiliation">
            Psychology, PPLS
          </p>
        <p class="quarto-title-affiliation">
            University of Edinburgh
          </p>
    </div>
</div>

</section>
<section id="course-overview" class="title-slide slide level1 center" data-background-color="#88B04B">
<h1>Course Overview</h1>

<table 0="" style="border: 1px solid black;>
  <tr style=" padding:="" 1em="" 1em;"="">
    <tbody><tr><td rowspan="5" style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1;text-align:center;vertical-align: middle">
        <b>multilevel modelling<br>working with group structured data</b></td>
    <td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        regression refresher</td>
  </tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        introducing multilevel models</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        more complex grouping structures</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:1">
        <b>assumptions, diagnostics, and centering</b></td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        recap</td></tr>

  <tr style="padding: 0 1em 0 1em;">
    <td rowspan="5" style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4;text-align:center;vertical-align: middle">
        <b>factor analysis<br>working with multi-item measures</b></td>
    <td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        what is a psychometric test?</td>
  </tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        using composite scores to simplify data (PCA)</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        uncovering underlying constructs (EFA)</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        more EFA</td></tr>
  <tr><td style="border: 1px solid black;padding: 0 1em 0 1em;opacity:0.4">
        recap</td></tr>
</tbody></table>
</section>

<section id="this-week" class="title-slide slide level1 center" data-transition="slide" data-background-color="#88B04B">
<h1>This week</h1>
<ul>
<li>Assumptions of multilevel models
<ul>
<li>some suggestions when things look awry</li>
</ul></li>
<li>Case Diagnostics
<ul>
<li>what if results are dependent on a small set of influential observations/clusters?</li>
</ul></li>
<li>Centering predictors in multilevel models</li>
</ul>
</section>

<section>
<section id="assumptions" class="title-slide slide level1 center" data-background-color="#88B04B">
<h1>Assumptions</h1>

</section>
<section id="assumptions-in-lm" class="slide level2">
<h2>Assumptions in LM</h2>
<div class="columns">
<div class="column" style="width:50%;">
<h4 id="the-general-idea">The general idea</h4>
<ul>
<li><span class="math inline">\(\varepsilon_i \sim N(0,\sigma^2)\)</span> iid</li>
<li>“zero mean and constant variance”</li>
</ul>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-3-1.svg"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<h4 id="recipe-book">Recipe book</h4>
<ul>
<li><strong>L</strong>inearity</li>
<li><strong>I</strong>ndependence</li>
<li><strong>N</strong>ormality</li>
<li><strong>E</strong>qual Variances</li>
</ul>
</div>
</div>
</section>
<section id="question-whats-different-in-mlm" class="slide level2">
<h2>Question: What’s different in MLM?</h2>
<h3 id="answer-not-much">Answer: Not much!</h3>
<ul>
<li><p>General idea is unchanged: error is random</p></li>
<li><p>But we now have residuals at multiple levels! Random effects can be viewed as residuals at another level.</p></li>
</ul>
</section>
<section id="resids" class="slide level2">
<h2>Resids</h2>

<img data-src="img_sandbox/Slide1.PNG" width="1280" class="r-stretch quarto-figure-left"></section>
<section id="resids-2" class="slide level2">
<h2>Resids (2)</h2>

<img data-src="img_sandbox/Slide2.PNG" width="1280" class="r-stretch quarto-figure-left"></section>
<section id="resids-3" class="slide level2">
<h2>Resids (3)</h2>

<img data-src="img_sandbox/Slide3.PNG" width="1280" class="r-stretch quarto-figure-left"></section>
<section id="random-effects-as-level-2-residuals" class="slide level2">
<h2>Random effects as level 2 residuals</h2>

<img data-src="img_sandbox/lmmwodot.png" width="1151" class="r-stretch quarto-figure-left"></section>
<section id="random-effects-as-level-2-residuals-1" class="slide level2" data-visibility="uncounted">
<h2>Random effects as level 2 residuals</h2>

<img data-src="img_sandbox/lmmwdot.png" width="1151" class="r-stretch quarto-figure-left"></section>
<section id="random-effects-as-level-2-residuals-2" class="slide level2">
<h2>Random effects as level 2 residuals</h2>
<p><span class="math display">\[
\begin{align}
&amp; \text{for observation }j\text{ in group }i \\
\quad \\
&amp; \text{Level 1:} \\
&amp; \color{red}{y_{ij}} = \color{blue}{b_{0i} \cdot 1 + b_{1i} \cdot x_{ij}} + \varepsilon_{ij} \\
&amp; \text{Level 2:} \\
&amp; \color{blue}{b_{0i}} = \gamma_{00} + \color{orange}{\zeta_{0i}} \\
&amp; \color{blue}{b_{1i}} = \gamma_{10} + \color{orange}{\zeta_{1i}} \\
\quad \\
&amp; \varepsilon, \, \color{orange}{\zeta_0}, \, \text{ and } \, \color{orange}{\zeta_1}\text{ are all assumed to be normally distributed with mean 0.}
\end{align}
\]</span></p>
</section>
<section id="random-effects-as-level-2-residuals-3" class="slide level2" data-visibility="uncounted">
<h2>Random effects as level 2 residuals</h2>
<!-- > 200 pupils from 20 schools completed a survey containing the Emotion Dysregulation Scale (EDS) and the Child Routines Questionnaire (CRQ). Eight of the schools were taking part in an initiative to specifically teach emotion regulation as part of the curriculum. Data were also gathered regarding the average hours each child slept per night. -->
<div class="columns">
<div class="column" style="width:50%;">
<p><span class="math inline">\(\varepsilon\)</span><br>
<code>resid(model)</code><br>
mean zero, constant variance<br>
<br><br></p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-10-1.svg" width="400"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><span class="math inline">\(\color{orange}{\zeta}\)</span><br>
<code>ranef(model)</code><br>
mean zero, constant variance</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>$cluster</code></pre>
</div>
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-11-1.svg" width="400"></p>
</div>
</div>
</div>
</div>
</section>
<section id="assumption-plots-residuals-vs-fitted" class="slide level2">
<h2>Assumption Plots: Residuals vs Fitted</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">type=</span><span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"smooth"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-12-1.svg" class="r-stretch"></section>
<section id="assumption-plots-qqplots" class="slide level2">
<h2>Assumption Plots: qqplots</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(model))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(model))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-13-1.svg" class="r-stretch"></section>
<section id="assumption-plots-scale-location" class="slide level2">
<h2>Assumption Plots: Scale-Location</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model, </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">form =</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fu">resid</span>(.))) <span class="sc">~</span> <span class="fu">fitted</span>(.),</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>,<span class="st">"smooth"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-14-1.svg" class="r-stretch"></section>
<section id="assumption-plots-scale-location-1" class="slide level2" data-visibility="uncounted">
<h2>Assumption Plots: Scale-Location</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">form =</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(<span class="fu">resid</span>(.))) <span class="sc">~</span> <span class="fu">fitted</span>(.) <span class="sc">|</span> cluster,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="fu">c</span>(<span class="st">"p"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-15-1.svg" class="r-stretch"></section>
<section id="assumption-plots-ranefs" class="slide level2">
<h2>Assumption Plots: Ranefs</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">ranef</span>(model)<span class="sc">$</span>cluster[,<span class="dv">1</span>])</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">ranef</span>(model)<span class="sc">$</span>cluster[,<span class="dv">1</span>])</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">ranef</span>(model)<span class="sc">$</span>cluster[,<span class="dv">2</span>])</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">ranef</span>(model)<span class="sc">$</span>cluster[,<span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-16-1.svg"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>rans <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">ranef</span>(model)<span class="sc">$</span>cluster)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rans, <span class="fu">aes</span>(<span class="at">sample =</span> <span class="st">`</span><span class="at">(Intercept)</span><span class="st">`</span>)) <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>() <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"random intercept"</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(rans, <span class="fu">aes</span>(<span class="at">sample =</span> x1)) <span class="sc">+</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>() <span class="sc">+</span> <span class="fu">stat_qq_line</span>()</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"random slope"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-18-1.svg"></p>
</div>
</div>
</div>
</div>
</section>
<section id="for-a-quick-check" class="slide level2">
<h2>for a quick check</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-19-1.svg" class="r-stretch"></section></section>
<section>
<section id="troubleshooting" class="title-slide slide level1 center" data-background-color="#88B04B">
<h1>Troubleshooting</h1>

</section>
<section id="our-data" class="slide level2">
<h2>Our Data</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><em>In a study examining how cognition changes over time, a sample of 20 participants took the Addenbrooke’s Cognitive Examination (ACE) every 2 years from age 60 to age 78.</em></p>
<p><small>Each participant has 10 datapoints. Participants are clusters.</small></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>d3 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"https://uoepsy.github.io/data/lmm_mindfuldecline.csv"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(d3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  sitename ppt   condition visit   age   ACE imp  
  &lt;chr&gt;    &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
1 Sncbk    PPT_1 control       1    60  84.5 unimp
2 Sncbk    PPT_1 control       2    62  85.6 imp  
3 Sncbk    PPT_1 control       3    64  84.5 imp  
4 Sncbk    PPT_1 control       4    66  83.1 imp  
5 Sncbk    PPT_1 control       5    68  82.3 imp  
6 Sncbk    PPT_1 control       6    70  83.3 imp  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ICC)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ICCbare</span>(<span class="at">x =</span> ppt, <span class="at">y =</span> ACE, <span class="at">data =</span> d3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.48</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-23-1.svg"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="when-things-look-wrong" class="slide level2">
<h2>When things look wrong</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mymodel <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ACE <span class="sc">~</span> visit <span class="sc">*</span> condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> ppt), <span class="at">data =</span> d3)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(mymodel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-24-1.svg" class="r-stretch"></section>
<section id="when-things-look-wrong-1" class="slide level2">
<h2>When things look wrong</h2>
<p><strong>Model mis-specification?</strong></p>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>mymodel <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ACE <span class="sc">~</span> visit <span class="sc">*</span> condition <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                  (<span class="dv">1</span> <span class="sc">|</span> ppt), <span class="at">data =</span> d3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-26-1.svg"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mymodel <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ACE <span class="sc">~</span> visit <span class="sc">*</span> condition <span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                  (<span class="dv">1</span> <span class="sc">+</span> visit <span class="sc">|</span> ppt), <span class="at">data =</span> d3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-28-1.svg"></p>
</div>
</div>
</div>
</div>
</section>
<section id="when-things-look-wrong-2" class="slide level2">
<h2>When things look wrong</h2>
<p><strong>Transformations?</strong></p>
<ul>
<li><p>Transforming your outcome variable may help to satisfy model assumptions</p>
<ul>
<li>log(y)</li>
<li>1/y</li>
<li>sqrt(y)</li>
<li>forecast::BoxCox(y)</li>
</ul></li>
</ul>
</section>
<section id="when-things-look-wrong-3" class="slide level2">
<h2>When things look wrong</h2>
<p><strong>Transformations?</strong></p>
<ul>
<li>Transforming your outcome variable may help to satisfy model assumptions</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> g <span class="sc">+</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>       (<span class="dv">1</span> <span class="sc">|</span> cluster), df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-31-1.svg"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(forecast<span class="sc">::</span><span class="fu">BoxCox</span>(y,<span class="at">lambda=</span><span class="st">"auto"</span>) <span class="sc">~</span> x1 <span class="sc">+</span> g <span class="sc">+</span> </span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>       (<span class="dv">1</span> <span class="sc">|</span> cluster), df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-33-1.svg"></p>
</div>
</div>
</div>
</div>
</section>
<section id="when-things-look-wrong-4" class="slide level2" data-visibility="uncounted">
<h2>When things look wrong</h2>
<p><strong>Transformations?</strong></p>
<ul>
<li>Transforming your outcome variable may help to satisfy model assumptions <strong>but it comes at the expense of interpretability.</strong></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> g <span class="sc">+</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>       (<span class="dv">1</span> <span class="sc">|</span> cluster), df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1           g 
      36.14        1.62       10.02 </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">lmer</span>(forecast<span class="sc">::</span><span class="fu">BoxCox</span>(y,<span class="at">lambda=</span><span class="st">"auto"</span>) <span class="sc">~</span> x1 <span class="sc">+</span> g <span class="sc">+</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>       (<span class="dv">1</span> <span class="sc">|</span> cluster), df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          x1           g 
    1.73376     0.00686     0.04843 </code></pre>
</div>
</div>
</div>
</div>
<!-- # When things look wrong -->
<!-- ### __robustlmm__ -->
<!-- ```{r eval=FALSE} -->
<!-- mymodel <- lmer(ACE ~ visit * condition + (1 | ppt), data = d3) -->
<!-- summary(mymodel)$coefficients -->
<!-- ``` -->
<!-- ```{r eval=FALSE} -->
<!-- library(robustlmm) -->
<!-- mymodelr <- rlmer(ACE ~ visit * condition + (1 | ppt), data = d3) -->
<!-- summary(mymodelr)$coefficients -->
<!-- ``` -->
</section>
<section id="when-things-look-wrong-5" class="slide level2">
<h2>When things look wrong</h2>
<p><strong>Bootstrap?</strong></p>
<p>basic idea:</p>
<ol type="1">
<li>do many many times:<br>
 a. take a sample (e.g.&nbsp;sample with replacement from your data, or simulated from your model parameters)<br>
 b. fit the model to the sample<br>
</li>
<li>then:<br>
 a. based on all the models fitted in step 1, obtain a distribution of parameter estimate of interest.<br>
 b. based on the bootstrap distribution from 2a, compute a confidence interval for estimate.<br>
 c.&nbsp;celebrate</li>
</ol>
</section>
<section id="when-things-look-wrong-6" class="slide level2">
<h2>When things look wrong</h2>
<p><strong>Bootstrapping is not a panacea.</strong></p>
<ul>
<li>If we’re worrying because our errors are slightly non-normal or heteroskedastic, <em>and if we have a large sample size</em>, then bootstrapping might be a good choice.</li>
<li>If there are issues in mis-specification (e.g the effect is non-linear and we’re estimating it as linear), bootstrapping won’t help us.</li>
</ul>
</section>
<section id="bootstrap-what-do-we-resample" class="slide level2">
<h2>Bootstrap: What do we (re)sample?</h2>
<ul>
<li>resample based on the estimated distributions of parameters?
<ul>
<li>assumes explanatory variables are fixed, model specification and the distributions (e.g.&nbsp;<span class="math inline">\(\zeta \sim N(0,\sigma_{\zeta})\)</span> and <span class="math inline">\(\varepsilon \sim N(0,\sigma_{\varepsilon})\)</span>) are correct.<br>
</li>
</ul></li>
<li>resample residuals
<ul>
<li><span class="math inline">\(y* = \hat{y} + \hat{\varepsilon}_{\textrm{sampled with replacement}}\)</span></li>
<li>assumes explanatory variables are fixed, and model specification is correct.</li>
</ul></li>
<li>resample cases
<ul>
<li><strong>minimal</strong> assumptions - that we have correctly specified the hierarchical structure of data</li>
<li><strong>But</strong> do we resample:
<ul>
<li>observations?</li>
<li>clusters?</li>
<li>both?</li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="case-bootstrap" class="slide level2">
<h2>Case Bootstrap</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>mymodel <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ACE <span class="sc">~</span> visit <span class="sc">*</span> condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> visit <span class="sc">|</span> ppt), <span class="at">data =</span> d3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmeresampler)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co"># resample only the people, not their observations: </span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>mymodelBScase <span class="ot">&lt;-</span> <span class="fu">bootstrap</span>(mymodel, <span class="at">.f =</span> fixef, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type =</span> <span class="st">"case"</span>, <span class="at">B =</span> <span class="dv">1000</span>, </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">resample =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mymodelBScase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap type: case 

Number of resamples: 1000 

                        term observed rep.mean     se     bias
1                (Intercept)   85.735   85.732 0.1242 -0.00325
2                      visit   -0.532   -0.530 0.0686  0.00217
3       conditionmindfulness   -0.298   -0.296 0.1835  0.00193
4 visit:conditionmindfulness    0.346    0.347 0.0999  0.00130

There were 26 messages, 0 warnings, and 0 errors.

The most commonly occurring message was: boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mymodelBScase, <span class="at">type =</span> <span class="st">"perc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  term                       estimate  lower   upper type  level
  &lt;chr&gt;                         &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt;
1 (Intercept)                  85.7   85.5   86.0    perc   0.95
2 visit                        -0.532 -0.666 -0.390  perc   0.95
3 conditionmindfulness         -0.298 -0.650  0.0736 perc   0.95
4 visit:conditionmindfulness    0.346  0.151  0.555  perc   0.95</code></pre>
</div>
</div>
</div>
</div>

<aside><div>
<p><br><br> <br><br>For a nice how-to guide on the <strong>lmeresampler</strong> package, see http://aloy.github.io/lmeresampler/articles/lmeresampler-vignette.html.<br>
For a discussion of different bootstrap methods for multilevel models, see Leeden R.., Meijer E., Busing F.M. (2008) Resampling Multilevel Models. In: Leeuw J.., Meijer E. (eds) Handbook of Multilevel Analysis. Springer, New York, NY. DOI: 10.1007/978-0-387-73186-5_11 ]</p>
</div></aside></section>
<section id="case-bootstrap-1" class="slide level2">
<h2>Case Bootstrap</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mymodel <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ACE <span class="sc">~</span> visit <span class="sc">*</span> condition <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> visit <span class="sc">|</span> ppt), <span class="at">data =</span> d3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmeresampler)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="co"># resample only the people, not their observations: </span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>mymodelBScase <span class="ot">&lt;-</span> <span class="fu">bootstrap</span>(mymodel, <span class="at">.f =</span> fixef, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type =</span> <span class="st">"case"</span>, <span class="at">B =</span> <span class="dv">1000</span>, </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>                           <span class="at">resample =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mymodelBScase)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>Bootstrap type: case 

Number of resamples: 1000 

                        term observed rep.mean     se     bias
1                (Intercept)   85.735   85.732 0.1242 -0.00325
2                      visit   -0.532   -0.530 0.0686  0.00217
3       conditionmindfulness   -0.298   -0.296 0.1835  0.00193
4 visit:conditionmindfulness    0.346    0.347 0.0999  0.00130

There were 26 messages, 0 warnings, and 0 errors.

The most commonly occurring message was: boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mymodelBScase, <span class="st">"visit*conditionmindfulness"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-45-1.svg"></p>
</div>
</div>
</div>
</div>
</section></section>
<section id="interim-summary" class="title-slide slide level1 center" data-background-color="#88B04B">
<h1>Interim Summary</h1>
<ul>
<li>Our assumptions for multi-level models are similar to that of a standard linear model in that we are concerned with the our residuals
<ul>
<li>in the multi-level case, we have residuals are multiple levels.</li>
</ul></li>
<li>When assumptions appear violated, there are various courses of action to consider.
<ul>
<li>primarily, we should think about whether our model makes theoretical sense</li>
</ul></li>
<li>Resampling methods (e.g.&nbsp;Bootstrapping) can <strong>sometimes</strong> be used to obtain confidence intervals and bias-corrected estimates of model parameters.
<ul>
<li>There are various forms of the bootstrap, with varying assumptions.</li>
</ul></li>
</ul>
</section>

<section>
<section id="case-diagnostics" class="title-slide slide level1 center" data-background-color="#88B04B">
<h1>Case Diagnostics</h1>

</section>
<section id="influence" class="slide level2">
<h2>Influence</h2>
<p>Just like standard <code>lm()</code>, observations can have unduly high influence on our model through a combination of high leverage and outlyingness.</p>

<img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-46-1.svg" class="r-stretch quarto-figure-center"></section>
<section id="but-we-have-multiple-levels" class="slide level2">
<h2>but we have multiple levels…</h2>
<ul>
<li><p>Both observations (level 1 units) <strong>and</strong> clusters (level 2+ units) can be influential.</p></li>
<li><p>several packages, but current recommendations are <strong>HLMdiag:</strong> http://aloy.github.io/HLMdiag/index.html and <strong>influence.ME</strong>.</p></li>
</ul>
</section>
<section id="level-1-influential-points" class="slide level2">
<h2>Level 1 influential points</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mymodel <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ACE <span class="sc">~</span> visit <span class="sc">*</span> condition <span class="sc">+</span> </span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>                  (<span class="dv">1</span> <span class="sc">+</span> visit <span class="sc">|</span> ppt), <span class="at">data =</span> d3)</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(mymodel))</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(mymodel))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-47-1.svg"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HLMdiag)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>infl1 <span class="ot">&lt;-</span> <span class="fu">hlm_influence</span>(mymodel, <span class="at">level =</span> <span class="dv">1</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(infl1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "id"               "ACE"              "visit"            "condition"       
 [5] "ppt"              "cooksd"           "mdffits"          "covtrace"        
 [9] "covratio"         "leverage.overall"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>infl1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 177 × 10
      id   ACE visit condition ppt      cooksd   mdffits covtrace covratio
   &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;
 1     1  84.5     1 control   PPT_1 0.0119    0.0116    0.0221       1.02
 2     2  85.6     2 control   PPT_1 0.0164    0.0162    0.0145       1.01
 3     3  84.5     3 control   PPT_1 0.00158   0.00156   0.00901      1.01
 4     4  83.1     4 control   PPT_1 0.00138   0.00137   0.00508      1.01
 5     5  82.3     5 control   PPT_1 0.00160   0.00159   0.00239      1.00
 6     6  83.3     6 control   PPT_1 0.000482  0.000482  0.000765     1.00
 7     7  80.9     7 control   PPT_1 0.000227  0.000227  0.000150     1.00
 8     8  81.9     8 control   PPT_1 0.000112  0.000112  0.000619     1.00
 9     9  81.5     9 control   PPT_1 0.000804  0.000802  0.00239      1.00
10    10  80.4    10 control   PPT_1 0.0000561 0.0000558 0.00595      1.01
# ℹ 167 more rows
# ℹ 1 more variable: leverage.overall &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="level-1-influential-points-1" class="slide level2">
<h2>Level 1 influential points</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>mymodel <span class="ot">&lt;-</span> <span class="fu">lmer</span>(ACE <span class="sc">~</span> visit <span class="sc">*</span> condition <span class="sc">+</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>                  (<span class="dv">1</span> <span class="sc">+</span> visit <span class="sc">|</span> ppt), <span class="at">data =</span> d3)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(mymodel))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(mymodel))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-49-1.svg"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(HLMdiag)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>infl1 <span class="ot">&lt;-</span> <span class="fu">hlm_influence</span>(mymodel, <span class="at">level =</span> <span class="dv">1</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dotplot_diag</span>(infl1<span class="sc">$</span>cooksd, <span class="at">cutoff =</span> <span class="st">"internal"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-50-1.svg"></p>
</div>
</div>
</div>
</div>
</section>
<section id="level-2-influential-clusters" class="slide level2">
<h2>Level 2 influential clusters</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>infl2 <span class="ot">&lt;-</span> <span class="fu">hlm_influence</span>(mymodel, <span class="at">level =</span> <span class="st">"ppt"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dotplot_diag</span>(infl2<span class="sc">$</span>cooksd, <span class="at">cutoff =</span> <span class="st">"internal"</span>, <span class="at">index=</span>infl2<span class="sc">$</span>ppt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-52-1.svg" class="r-stretch"></section>
<section id="what-to-do" class="slide level2">
<h2>What to do?</h2>
<ul>
<li><p>In this context (observations within participants), I would be inclined to focus on level-2 (participant) influence <em>first</em>, and only then look at the influence of individual observations.</p></li>
<li><p>It’s worth looking into PPT_2 a bit further.</p></li>
<li><p><code>mdffits</code> is a measure of multivariate “difference in fixed effects”</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>infl2 <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(mdffits))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 6
   ppt     cooksd mdffits covtrace covratio leverage.overall
   &lt;fct&gt;    &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;            &lt;dbl&gt;
 1 PPT_2  0.213   0.190      0.235     1.25            0.158
 2 PPT_18 0.150   0.134      0.229     1.24            0.158
 3 PPT_19 0.102   0.0918     0.229     1.24            0.158
 4 PPT_5  0.0858  0.0771     0.235     1.25            0.158
 5 PPT_13 0.0811  0.0727     0.229     1.24            0.158
 6 PPT_3  0.0747  0.0670     0.235     1.25            0.158
 7 PPT_7  0.0678  0.0609     0.235     1.25            0.158
 8 PPT_12 0.0656  0.0595     0.214     1.23            0.216
 9 PPT_15 0.0606  0.0544     0.229     1.24            0.158
10 PPT_10 0.0459  0.0413     0.235     1.25            0.158
11 PPT_20 0.0407  0.0365     0.229     1.24            0.158
12 PPT_14 0.0309  0.0281     0.184     1.19            0.456
13 PPT_4  0.0235  0.0209     0.235     1.25            0.158
14 PPT_16 0.0213  0.0191     0.229     1.24            0.158
15 PPT_17 0.0192  0.0173     0.229     1.24            0.158
16 PPT_8  0.0149  0.0135     0.152     1.16            0.242
17 PPT_9  0.00748 0.00666    0.235     1.25            0.158
18 PPT_6  0.00658 0.00600    0.198     1.21            0.356
19 PPT_1  0.00228 0.00203    0.235     1.25            0.158
20 PPT_11 0.00225 0.00202    0.224     1.24            0.194</code></pre>
</div>
</div>
</section>
<section id="what-to-do-1" class="slide level2">
<h2>What to do?</h2>
<ul>
<li><p>In this context (observations within participants), I would be inclined to focus on level-2 (participant) influence <em>first</em>, and only then look at the influence of individual observations.</p></li>
<li><p>It’s worth looking into PPT_2 a bit further.</p></li>
<li><p>examine fixed effects upon deletion of this participant</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>deleted_ppt <span class="ot">&lt;-</span> <span class="fu">case_delete</span>(mymodel, <span class="at">level =</span> <span class="st">"ppt"</span>, <span class="at">type =</span> <span class="st">"fixef"</span>, <span class="at">delete =</span> <span class="fu">c</span>(<span class="st">"PPT_2"</span>))</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cbind</span>(deleted_ppt<span class="sc">$</span>fixef.original, deleted_ppt<span class="sc">$</span>fixef.delete)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             [,1]   [,2]
(Intercept)                85.735 85.873
visit                      -0.532 -0.525
conditionmindfulness       -0.298 -0.439
visit:conditionmindfulness  0.346  0.339</code></pre>
</div>
</div>
</section>
<section id="sensitivity-analysis" class="slide level2">
<h2>Sensitivity Analysis?</h2>
<p>Would our conclusions change if we excluded these schools?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>mymodel_rm2 <span class="ot">&lt;-</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lmer</span>(ACE <span class="sc">~</span> visit <span class="sc">*</span> condition <span class="sc">+</span> </span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>         (<span class="dv">1</span> <span class="sc">+</span> visit <span class="sc">|</span> ppt), </span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">data =</span> d3 <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>ppt <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"PPT_2"</span>)))</span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>mymodel_rm2BS <span class="ot">&lt;-</span> <span class="fu">bootstrap</span>(mymodel_rm2, <span class="at">.f =</span> fixef, </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">type =</span> <span class="st">"case"</span>, <span class="at">B =</span> <span class="dv">1000</span>, </span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>                           <span class="at">resample =</span> <span class="fu">c</span>(<span class="cn">TRUE</span>, <span class="cn">FALSE</span>))</span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="fu">confint</span>(mymodel_rm2BS, <span class="at">type =</span> <span class="st">"perc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section></section>
<section id="interim-summary-1" class="title-slide slide level1 center" data-background-color="#88B04B">
<h1>Interim Summary</h1>
<ul>
<li><p>Influence can be exerted by individual observations and higher lever groups of observations</p>
<ul>
<li>e.g.&nbsp;by children and by schools, or by individual trials and by participants.</li>
</ul></li>
<li><p>We can get measures of influence at different levels, and consider how estimates and conclusions might change when certain observations (or groups) are excluded</p></li>
<li><p>If in doubt, conduct a sensitivity analysis: how do your conclusions change depending upon whether you include/exclude?</p></li>
</ul>
</section>

<section>
<section id="centering" class="title-slide slide level1 center" data-background-color="#88B04B">
<h1>Centering</h1>

</section>
<section id="centering-1" class="slide level2">
<h2>Centering</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Suppose we have a variable for which the mean is 100.</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-56-1.svg"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>We can re-center this so that the mean becomes zero:</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-57-1.svg"></p>
</div>
</div>
</div>
</div>
</section>
<section id="centering-2" class="slide level2" data-visibility="uncounted">
<h2>Centering</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Suppose we have a variable for which the mean is 100.</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-58-1.svg"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>We can re-center this so that <em>any</em> value becomes zero:</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-59-1.svg"></p>
</div>
</div>
</div>
</div>
</section>
<section id="scaling" class="slide level2">
<h2>Scaling</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Suppose we have a variable for which the mean is 100.<br>
The standard deviation is 15</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-60-1.svg"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p>We can scale this so that a change in 1 is equivalent to a change in 1 standard deviation:</p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-61-1.svg"></p>
</div>
</div>
</div>
</div>
</section>
<section id="centering-predictors-in-lm" class="slide level2">
<h2>Centering predictors in LM</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span>x,<span class="at">data=</span>df)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span><span class="fu">scale</span>(x, <span class="at">center=</span>T,<span class="at">scale=</span>F),<span class="at">data=</span>df)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>m3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span><span class="fu">scale</span>(x, <span class="at">center=</span>T,<span class="at">scale=</span>T),<span class="at">data=</span>df)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y<span class="sc">~</span><span class="fu">I</span>(x<span class="dv">-5</span>), <span class="at">data=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment" data-fragment-index="1">
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(m1,m2,m3,m4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: y ~ x
Model 2: y ~ scale(x, center = T, scale = F)
Model 3: y ~ scale(x, center = T, scale = T)
Model 4: y ~ I(x - 5)
  Res.Df RSS Df Sum of Sq F Pr(&gt;F)
1    198 177                      
2    198 177  0 -2.84e-14         
3    198 177  0  0.00e+00         
4    198 177  0  0.00e+00         </code></pre>
</div>
</div>
</div>
</div><div class="column fragment" data-fragment-index="1" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-65-1.svg"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="big-fish-little-fish" class="slide level2">
<h2>Big Fish Little Fish</h2>

<img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-67-1.svg" class="r-stretch quarto-figure-center"><p>data available at https://uoepsy.github.io/data/bflp.csv</p>
</section>
<section id="things-are-different-with-multi-level-data" class="slide level2">
<h2>Things are different with multi-level data</h2>

<img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-68-1.svg" class="r-stretch quarto-figure-center"></section>
<section id="multiple-means" class="slide level2">
<h2>Multiple means</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Grand mean</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-69-1.svg"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Group means</strong></p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-70-1.svg"></p>
</div>
</div>
</div>
</div>
</section>
<section id="group-mean-centering" class="slide level2">
<h2>Group-mean centering</h2>
<p><br></p>

<img data-src="img_sandbox/center.gif" class="r-stretch quarto-figure-center"></section>
<section id="group-mean-centering-1" class="slide level2">
<h2>Group-mean centering</h2>
<div class="columns">
<div class="column" style="width:50%;">
<center>
<strong><span class="math inline">\(x_{ij} - \bar{x}_i\)</span></strong>
</center>
<p><br></p>
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-74-1.svg"></p>
</div>
</div>
</div>:::{.column width=“50%” incremental}<center><strong><span class="math inline">\(\bar{x}_i\)</span></strong></center><p><br></p><div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-75-1.svg"></p>
</div>
</div>
</div>
<p>::::</p>
</section>
<section id="disaggregating-within-between" class="slide level2">
<h2>Disaggregating within &amp; between</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>RE model</strong><br>
<span class="math display">\[
\begin{align}
y_{ij} &amp;= b_{0i} + b_{1}(x_j) + \varepsilon_{ij} \\
b_{0i} &amp;= \gamma_{00} + \zeta_{0i} \\
... \\
\end{align}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>mod_re <span class="ot">&lt;-</span> <span class="fu">lmer</span>(self_esteem <span class="sc">~</span> fish_weight <span class="sc">+</span> </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>              (<span class="dv">1</span> <span class="sc">|</span> pond), <span class="at">data=</span>bflp)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(mod_re)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) fish_weight 
     1.7616      0.0405 </code></pre>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Within-between model</strong><br>
<span class="math display">\[
\begin{align}
y_{ij} &amp;= b_{0i} + b_{1}(\bar{x}_i) + b_2(x_{ij} - \bar{x}_i)+ \varepsilon_{ij} \\
b_{0i} &amp;= \gamma_{00} + \zeta_{0i} \\
... \\
\end{align}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>bflp <span class="ot">&lt;-</span> </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  bflp <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pond) <span class="sc">%&gt;%</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">fw_pondm =</span> <span class="fu">mean</span>(fish_weight),</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">fw_pondc =</span> fish_weight <span class="sc">-</span> <span class="fu">mean</span>(fish_weight)</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> ungroup</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>mod_wb <span class="ot">&lt;-</span> <span class="fu">lmer</span>(self_esteem <span class="sc">~</span> fw_pondm <span class="sc">+</span> fw_pondc <span class="sc">+</span> </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>              (<span class="dv">1</span> <span class="sc">|</span> pond), <span class="at">data=</span>bflp)</span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(mod_wb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)    fw_pondm    fw_pondc 
     4.7680     -0.0559      0.0407 </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="disaggregating-within-between-1" class="slide level2">
<h2>Disaggregating within &amp; between</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-78-1.svg"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Within-between model</strong><br>
<span class="math display">\[
\begin{align}
y_{ij} &amp;= \beta_{0i} + \beta_{1}(\bar{x}_i) + \beta_2(x_{ij} - \bar{x}_i)+ \varepsilon_{ij} \\
\beta_{0i} &amp;= \gamma_{00} + \zeta_{0i} \\
... \\
\end{align}
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>bflp <span class="ot">&lt;-</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  bflp <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(pond) <span class="sc">%&gt;%</span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">fw_pondm =</span> <span class="fu">mean</span>(fish_weight),</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">fw_pondc =</span> fish_weight <span class="sc">-</span> <span class="fu">mean</span>(fish_weight)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> ungroup</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>mod_wb <span class="ot">&lt;-</span> <span class="fu">lmer</span>(self_esteem <span class="sc">~</span> fw_pondm <span class="sc">+</span> fw_pondc <span class="sc">+</span> </span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>              (<span class="dv">1</span> <span class="sc">|</span> pond), <span class="at">data=</span>bflp)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="fu">fixef</span>(mod_wb)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)    fw_pondm    fw_pondc 
     4.7680     -0.0559      0.0407 </code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="a-more-realistic-example" class="slide level2">
<h2>A more realistic example</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>A research study investigates how anxiety is associated with drinking habits. Data was collected from 50 participants. Researchers administered the generalised anxiety disorder (GAD-7) questionnaire to measure levels of anxiety over the past week, and collected information on the units of alcohol participants had consumed within the week. Each participant was observed on 10 different occasions.</p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-81-1.svg"></p>
</div>
</div>
<p>data available at https://uoepsy.github.io/data/lmm_alcgad.csv</p>
</div>
</div>
</section>
<section id="a-more-realistic-example-1" class="slide level2">
<h2>A more realistic example</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Is being more anxious (than you usually are) associated with higher consumption of alcohol?</p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-82-1.svg"></p>
</div>
</div>
</div>
</div>
</section>
<section id="a-more-realistic-example-2" class="slide level2">
<h2>A more realistic example</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p>Is being generally more anxious (relative to others) associated with higher consumption of alcohol?</p>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-83-1.svg"></p>
</div>
</div>
</div>
</div>
</section>
<section id="modelling-within-between-effects" class="slide level2">
<h2>Modelling within &amp; between effects</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>alcgad <span class="ot">&lt;-</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  alcgad <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ppt) <span class="sc">%&gt;%</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">gadm=</span><span class="fu">mean</span>(gad),</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">gadmc=</span>gad<span class="sc">-</span>gadm</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>alcmod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(alcunits <span class="sc">~</span> gadm <span class="sc">+</span> gadmc <span class="sc">+</span> </span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>                 (<span class="dv">1</span> <span class="sc">+</span> gadmc <span class="sc">|</span> ppt), </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>alcgad,</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(alcmod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: alcunits ~ gadm + gadmc + (1 + gadmc | ppt)
   Data: alcgad
Control: lmerControl(optimizer = "bobyqa")

REML criterion at convergence: 1424

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.8466 -0.6264  0.0642  0.6292  3.0281 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 ppt      (Intercept) 3.7803   1.944         
          gadmc       0.0935   0.306    -0.30
 Residual             1.7234   1.313         
Number of obs: 375, groups:  ppt, 50

Fixed effects:
            Estimate Std. Error t value
(Intercept)  14.5802     0.8641   16.87
gadm         -0.7584     0.1031   -7.35
gadmc         0.6378     0.0955    6.68

Correlation of Fixed Effects:
      (Intr) gadm  
gadm  -0.945       
gadmc -0.055  0.012</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="within-between-a-bit-of-both" class="slide level2">
<h2>within? between? a bit of both?</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>alcmod2 <span class="ot">&lt;-</span> <span class="fu">lmer</span>(alcunits <span class="sc">~</span> gad <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> gad <span class="sc">|</span> ppt), </span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">data=</span>alcgad,</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(alcmod2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: alcunits ~ gad + (1 + gad | ppt)
   Data: alcgad
Control: lmerControl(optimizer = "bobyqa")

REML criterion at convergence: 1492

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.9619 -0.6412  0.0227  0.5956  3.0251 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 ppt      (Intercept) 15.1206  3.889         
          gad          0.0751  0.274    -0.37
 Residual              1.7750  1.332         
Number of obs: 375, groups:  ppt, 50

Fixed effects:
            Estimate Std. Error t value
(Intercept)   5.3937     0.8361    6.45
gad           0.4176     0.0877    4.76

Correlation of Fixed Effects:
    (Intr)
gad -0.772</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="within-between-effects" class="slide level2">
<h2>Within &amp; Between effects</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-89-1.svg"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-90-1.svg"></p>
</div>
</div>
</div>
</div>
</section>
<section id="within-between-effects-1" class="slide level2">
<h2>Within &amp; Between effects</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-91-1.svg"></p>
</div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="04assumptions_files/figure-revealjs/unnamed-chunk-92-1.svg"></p>
</div>
</div>
</div>
</div>
</section>
<section id="modelling-within-between-interactions" class="slide level2">
<h2>Modelling within &amp; between interactions</h2>
<div class="columns">
<div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>alcmod <span class="ot">&lt;-</span> <span class="fu">lmer</span>(alcunits <span class="sc">~</span> (gadm <span class="sc">+</span> gadmc)<span class="sc">*</span>intervention <span class="sc">+</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>                 (<span class="dv">1</span> <span class="sc">|</span> ppt), </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>               <span class="at">data=</span>alcgad,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>               <span class="at">control=</span><span class="fu">lmerControl</span>(<span class="at">optimizer =</span> <span class="st">"bobyqa"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div><div class="column" style="width:50%;">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(alcmod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: alcunits ~ (gadm + gadmc) * intervention + (1 | ppt)
   Data: alcgad
Control: lmerControl(optimizer = "bobyqa")

REML criterion at convergence: 1404

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.8183 -0.6354  0.0142  0.5928  3.0874 

Random effects:
 Groups   Name        Variance Std.Dev.
 ppt      (Intercept) 3.59     1.9     
 Residual             1.69     1.3     
Number of obs: 375, groups:  ppt, 50

Fixed effects:
                   Estimate Std. Error t value
(Intercept)          14.858      1.275   11.65
gadm                 -0.876      0.154   -5.70
gadmc                 1.092      0.128    8.56
intervention         -0.549      1.711   -0.32
gadm:intervention     0.205      0.205    1.00
gadmc:intervention   -0.757      0.166   -4.57

Correlation of Fixed Effects:
            (Intr) gadm   gadmc  intrvn gdm:nt
gadm        -0.939                            
gadmc        0.000  0.000                     
interventin -0.746  0.700  0.000              
gdm:ntrvntn  0.705 -0.750  0.000 -0.944       
gdmc:ntrvnt  0.000  0.000 -0.770  0.000  0.000</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="when-do-we-need-to-think-about-it" class="slide level2">
<h2>When do we need to think about it?</h2>
<p>When we have a predictor <span class="math inline">\(x\)</span> that varies <em>within</em> a cluster</p>
<p>and</p>
<p>When clusters have different average levels of <span class="math inline">\(x\)</span>. This typically only happens when <span class="math inline">\(x\)</span> is <em>observed</em> (vs manipulated as part of study)</p>
<p>and</p>
<p>When our question concerns <span class="math inline">\(x\)</span>. (if <span class="math inline">\(x\)</span> is just a covariate, no need).</p>
</section>
<section id="summary" class="slide level2">
<h2>Summary</h2>
<ul>
<li><p>Applying the same linear transformation to a predictor (e.g.&nbsp;grand-mean centering, or standardising) makes <strong>no difference</strong> to our model or significance tests</p>
<ul>
<li>but it may change the meaning and/or interpretation of our parameters</li>
</ul></li>
<li><p>When data are clustered, we can apply group-level transformations, e.g.&nbsp;<strong>group-mean centering.</strong></p></li>
<li><p>Group-mean centering our predictors allows us to disaggregate <strong>within</strong> from <strong>between</strong> effects.</p>
<ul>
<li>allowing us to ask the theoretical questions that we are actually interested in</li>
</ul></li>
</ul>
<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="04assumptions_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="04assumptions_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="04assumptions_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="04assumptions_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="04assumptions_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="04assumptions_files/libs/revealjs/plugin/reveal-attribution/attribution.js"></script>
  <script src="04assumptions_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="04assumptions_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="04assumptions_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="04assumptions_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="04assumptions_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': true,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1200,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealAttribution, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <style>
      .hide {
        display: none !important;
      }
    </style>


    <script>
      function remove() {
        let footer = document.querySelector('div.footer');
        let slideNo = document.querySelector('div.slide-number');
        slideNo.classList.add('hide');
        footer.classList.add('hide');
      
        Reveal.on('slidechanged', event => {  
          if(Reveal.isFirstSlide()) {
            slideNo.classList.add('hide');
            footer.classList.add('hide');
          } else {
            slideNo.classList.remove('hide');
            footer.classList.remove('hide');
          }
        });
      }
      
      window.onload = remove();
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
          let selectedAnnoteEl;
          const selectorForAnnotation = ( cell, annotation) => {
            let cellAttr = 'data-code-cell="' + cell + '"';
            let lineAttr = 'data-code-annotation="' +  annotation + '"';
            const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
            return selector;
          }
          const selectCodeLines = (annoteEl) => {
            const doc = window.document;
            const targetCell = annoteEl.getAttribute("data-target-cell");
            const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
            const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
            const lines = annoteSpan.getAttribute("data-code-lines").split(",");
            const lineIds = lines.map((line) => {
              return targetCell + "-" + line;
            })
            let top = null;
            let height = null;
            let parent = null;
            if (lineIds.length > 0) {
                //compute the position of the single el (top and bottom and make a div)
                const el = window.document.getElementById(lineIds[0]);
                top = el.offsetTop;
                height = el.offsetHeight;
                parent = el.parentElement.parentElement;
              if (lineIds.length > 1) {
                const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
                const bottom = lastEl.offsetTop + lastEl.offsetHeight;
                height = bottom - top;
              }
              if (top !== null && height !== null && parent !== null) {
                // cook up a div (if necessary) and position it 
                let div = window.document.getElementById("code-annotation-line-highlight");
                if (div === null) {
                  div = window.document.createElement("div");
                  div.setAttribute("id", "code-annotation-line-highlight");
                  div.style.position = 'absolute';
                  parent.appendChild(div);
                }
                div.style.top = top - 2 + "px";
                div.style.height = height + 4 + "px";
                let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
                if (gutterDiv === null) {
                  gutterDiv = window.document.createElement("div");
                  gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                  gutterDiv.style.position = 'absolute';
                  const codeCell = window.document.getElementById(targetCell);
                  const gutter = codeCell.querySelector('.code-annotation-gutter');
                  gutter.appendChild(gutterDiv);
                }
                gutterDiv.style.top = top - 2 + "px";
                gutterDiv.style.height = height + 4 + "px";
              }
              selectedAnnoteEl = annoteEl;
            }
          };
          const unselectCodeLines = () => {
            const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
            elementsIds.forEach((elId) => {
              const div = window.document.getElementById(elId);
              if (div) {
                div.remove();
              }
            });
            selectedAnnoteEl = undefined;
          };
          // Handle positioning of the toggle
          window.addEventListener(
          "resize",
          throttle(() => {
            elRect = undefined;
            if (selectedAnnoteEl) {
              selectCodeLines(selectedAnnoteEl);
            }
          }, 10)
          );
          function throttle(fn, ms) {
          let throttle = false;
          let timer;
            return (...args) => {
              if(!throttle) { // first call gets through
                  fn.apply(this, args);
                  throttle = true;
              } else { // all the others get throttled
                  if(timer) clearTimeout(timer); // cancel #2
                  timer = setTimeout(() => {
                    fn.apply(this, args);
                    timer = throttle = false;
                  }, ms);
              }
            };
          }
          const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
          for (let i=0; i<annoteTargets.length; i++) {
            const annoteTarget = annoteTargets[i];
            const targetCell = annoteTarget.getAttribute("data-target-cell");
            const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
            const contentFn = () => {
              const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
              if (content) {
                const tipContent = content.cloneNode(true);
                tipContent.classList.add("code-annotation-tip-content");
                return tipContent.outerHTML;
              }
            }
            const config = {
              allowHTML: true,
              content: contentFn,
              onShow: (instance) => {
                selectCodeLines(instance.reference);
                instance.reference.classList.add('code-annotation-active');
                window.tippy.hideAll();
              },
              onHide: (instance) => {
                unselectCodeLines();
                instance.reference.classList.remove('code-annotation-active');
              },
              maxWidth: 300,
              delay: [50, 0],
              duration: [200, 0],
              offset: [5, 10],
              arrow: true,
              appendTo: function(el) {
                return el.parentElement.parentElement.parentElement;
              },
              interactive: true,
              interactiveBorder: 10,
              theme: 'light-border',
              placement: 'right',
              popperOptions: {
                modifiers: [
                {
                  name: 'flip',
                  options: {
                    flipVariations: false, // true by default
                    allowedAutoPlacements: ['right'],
                    fallbackPlacements: ['right', 'top', 'top-start', 'top-end'],
                  },
                },
                {
                  name: 'preventOverflow',
                  options: {
                    mainAxis: false,
                    altAxis: false
                  }
                }
                ]        
              }      
            };
            window.tippy(annoteTarget, config); 
          }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>